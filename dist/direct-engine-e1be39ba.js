(function(e,t){if(!e||e.getElementById("livereloadscript"))return;t=e.createElement("script");t.async=1;t.src="//"+(self.location.host||"localhost").split(":")[0]+":35729/livereload.js?snipver=1";t.id="livereloadscript";e.getElementsByTagName("head")[0].appendChild(t)})(self.document);import{a as e,P as t,p as n,i as r,b as o,u as a,c as i,d as s,e as u,f as F,g as m,h as l,j as d,k as c,w as _,l as P,m as g,q as h,r as f,n as D,o as b,t as p,v as A,x as y,R as M,A as E,y as G,z as S,B as v,C,D as T,M as O,N as x,E as w,T as R}from"./embedpdf-274e1dbb.js";var I=(()=>{var e=import.meta.url;return async function(t={}){var n;var r=t;var o,a;var i=new Promise(((e,t)=>{o=e;a=t}));["_EPDF_HasMetaText","_EPDF_PNG_EncodeRGBA","_EPDF_RenderAnnotBitmap","_EPDF_SetMetaText","_EPDFAnnot_ClearColor","_EPDFAnnot_GenerateAppearance","_EPDFAnnot_GenerateAppearanceWithBlend","_EPDFAnnot_GetBlendMode","_EPDFAnnot_GetBorderDashPattern","_EPDFAnnot_GetBorderDashPatternCount","_EPDFAnnot_GetBorderEffect","_EPDFAnnot_GetBorderStyle","_EPDFAnnot_GetColor","_EPDFAnnot_GetDefaultAppearance","_EPDFAnnot_GetIcon","_EPDFAnnot_GetIntent","_EPDFAnnot_GetLineEndings","_EPDFAnnot_GetOpacity","_EPDFAnnot_GetRectangleDifferences","_EPDFAnnot_GetRichContent","_EPDFAnnot_GetTextAlignment","_EPDFAnnot_GetVerticalAlignment","_EPDFAnnot_SetBorderDashPattern","_EPDFAnnot_SetBorderStyle","_EPDFAnnot_SetColor","_EPDFAnnot_SetDefaultAppearance","_EPDFAnnot_SetIcon","_EPDFAnnot_SetIntent","_EPDFAnnot_SetLine","_EPDFAnnot_SetLineEndings","_EPDFAnnot_SetLinkedAnnot","_EPDFAnnot_SetOpacity","_EPDFAnnot_SetTextAlignment","_EPDFAnnot_SetVerticalAlignment","_EPDFAnnot_SetVertices","_EPDFPage_CreateAnnot","_EPDFPage_GetAnnotByName","_EPDFPage_GetAnnotCountRaw","_EPDFPage_GetAnnotRaw","_EPDFPage_RemoveAnnotByName","_EPDFPage_RemoveAnnotRaw","_EPDFText_RedactInQuads","_EPDFText_RedactInRect","_FORM_CanRedo","_FORM_CanUndo","_FORM_DoDocumentAAction","_FORM_DoDocumentJSAction","_FORM_DoDocumentOpenAction","_FORM_DoPageAAction","_FORM_ForceToKillFocus","_FORM_GetFocusedAnnot","_FORM_GetFocusedText","_FORM_GetSelectedText","_FORM_IsIndexSelected","_FORM_OnAfterLoadPage","_FORM_OnBeforeClosePage","_FORM_OnChar","_FORM_OnFocus","_FORM_OnKeyDown","_FORM_OnKeyUp","_FORM_OnLButtonDoubleClick","_FORM_OnLButtonDown","_FORM_OnLButtonUp","_FORM_OnMouseMove","_FORM_OnMouseWheel","_FORM_OnRButtonDown","_FORM_OnRButtonUp","_FORM_Redo","_FORM_ReplaceAndKeepSelection","_FORM_ReplaceSelection","_FORM_SelectAllText","_FORM_SetFocusedAnnot","_FORM_SetIndexSelected","_FORM_Undo","_FPDF_AddInstalledFont","_FPDF_CloseDocument","_FPDF_ClosePage","_FPDF_CloseXObject","_FPDF_CopyViewerPreferences","_FPDF_CountNamedDests","_FPDF_CreateClipPath","_FPDF_CreateNewDocument","_FPDF_DestroyClipPath","_FPDF_DestroyLibrary","_FPDF_DeviceToPage","_FPDF_DocumentHasValidCrossReferenceTable","_FPDF_FFLDraw","_FPDF_FreeDefaultSystemFontInfo","_FPDF_GetDefaultSystemFontInfo","_FPDF_GetDefaultTTFMap","_FPDF_GetDefaultTTFMapCount","_FPDF_GetDefaultTTFMapEntry","_FPDF_GetDocPermissions","_FPDF_GetDocUserPermissions","_FPDF_GetFileIdentifier","_FPDF_GetFileVersion","_FPDF_GetFormType","_FPDF_GetLastError","_FPDF_GetMetaText","_FPDF_GetNamedDest","_FPDF_GetNamedDestByName","_FPDF_GetPageAAction","_FPDF_GetPageBoundingBox","_FPDF_GetPageCount","_FPDF_GetPageHeight","_FPDF_GetPageHeightF","_FPDF_GetPageLabel","_FPDF_GetPageSizeByIndex","_FPDF_GetPageSizeByIndexF","_FPDF_GetPageWidth","_FPDF_GetPageWidthF","_FPDF_GetSecurityHandlerRevision","_FPDF_GetSignatureCount","_FPDF_GetSignatureObject","_FPDF_GetTrailerEnds","_FPDF_GetXFAPacketContent","_FPDF_GetXFAPacketCount","_FPDF_GetXFAPacketName","_FPDF_ImportNPagesToOne","_FPDF_ImportPages","_FPDF_ImportPagesByIndex","_FPDF_InitLibrary","_FPDF_InitLibraryWithConfig","_FPDF_LoadCustomDocument","_FPDF_LoadDocument","_FPDF_LoadMemDocument","_FPDF_LoadMemDocument64","_FPDF_LoadPage","_FPDF_LoadXFA","_FPDF_MovePages","_FPDF_NewFormObjectFromXObject","_FPDF_NewXObjectFromPage","_FPDF_PageToDevice","_FPDF_RemoveFormFieldHighlight","_FPDF_RenderPage_Close","_FPDF_RenderPage_Continue","_FPDF_RenderPageBitmap","_FPDF_RenderPageBitmap_Start","_FPDF_RenderPageBitmapWithColorScheme_Start","_FPDF_RenderPageBitmapWithMatrix","_FPDF_SaveAsCopy","_FPDF_SaveWithVersion","_FPDF_SetFormFieldHighlightAlpha","_FPDF_SetFormFieldHighlightColor","_FPDF_SetSandBoxPolicy","_FPDF_SetSystemFontInfo","_FPDF_StructElement_Attr_CountChildren","_FPDF_StructElement_Attr_GetBlobValue","_FPDF_StructElement_Attr_GetBooleanValue","_FPDF_StructElement_Attr_GetChildAtIndex","_FPDF_StructElement_Attr_GetCount","_FPDF_StructElement_Attr_GetName","_FPDF_StructElement_Attr_GetNumberValue","_FPDF_StructElement_Attr_GetStringValue","_FPDF_StructElement_Attr_GetType","_FPDF_StructElement_Attr_GetValue","_FPDF_StructElement_CountChildren","_FPDF_StructElement_GetActualText","_FPDF_StructElement_GetAltText","_FPDF_StructElement_GetAttributeAtIndex","_FPDF_StructElement_GetAttributeCount","_FPDF_StructElement_GetChildAtIndex","_FPDF_StructElement_GetChildMarkedContentID","_FPDF_StructElement_GetID","_FPDF_StructElement_GetLang","_FPDF_StructElement_GetMarkedContentID","_FPDF_StructElement_GetMarkedContentIdAtIndex","_FPDF_StructElement_GetMarkedContentIdCount","_FPDF_StructElement_GetObjType","_FPDF_StructElement_GetParent","_FPDF_StructElement_GetStringAttribute","_FPDF_StructElement_GetTitle","_FPDF_StructElement_GetType","_FPDF_StructTree_Close","_FPDF_StructTree_CountChildren","_FPDF_StructTree_GetChildAtIndex","_FPDF_StructTree_GetForPage","_FPDF_VIEWERREF_GetDuplex","_FPDF_VIEWERREF_GetName","_FPDF_VIEWERREF_GetNumCopies","_FPDF_VIEWERREF_GetPrintPageRange","_FPDF_VIEWERREF_GetPrintPageRangeCount","_FPDF_VIEWERREF_GetPrintPageRangeElement","_FPDF_VIEWERREF_GetPrintScaling","_FPDFAction_GetDest","_FPDFAction_GetFilePath","_FPDFAction_GetType","_FPDFAction_GetURIPath","_FPDFAnnot_AddFileAttachment","_FPDFAnnot_AddInkStroke","_FPDFAnnot_AppendAttachmentPoints","_FPDFAnnot_AppendObject","_FPDFAnnot_CountAttachmentPoints","_FPDFAnnot_GetAP","_FPDFAnnot_GetAttachmentPoints","_FPDFAnnot_GetBorder","_FPDFAnnot_GetColor","_FPDFAnnot_GetFileAttachment","_FPDFAnnot_GetFlags","_FPDFAnnot_GetFocusableSubtypes","_FPDFAnnot_GetFocusableSubtypesCount","_FPDFAnnot_GetFontColor","_FPDFAnnot_GetFontSize","_FPDFAnnot_GetFormAdditionalActionJavaScript","_FPDFAnnot_GetFormControlCount","_FPDFAnnot_GetFormControlIndex","_FPDFAnnot_GetFormFieldAlternateName","_FPDFAnnot_GetFormFieldAtPoint","_FPDFAnnot_GetFormFieldExportValue","_FPDFAnnot_GetFormFieldFlags","_FPDFAnnot_GetFormFieldName","_FPDFAnnot_GetFormFieldType","_FPDFAnnot_GetFormFieldValue","_FPDFAnnot_GetInkListCount","_FPDFAnnot_GetInkListPath","_FPDFAnnot_GetLine","_FPDFAnnot_GetLink","_FPDFAnnot_GetLinkedAnnot","_FPDFAnnot_GetNumberValue","_FPDFAnnot_GetObject","_FPDFAnnot_GetObjectCount","_FPDFAnnot_GetOptionCount","_FPDFAnnot_GetOptionLabel","_FPDFAnnot_GetRect","_FPDFAnnot_GetStringValue","_FPDFAnnot_GetSubtype","_FPDFAnnot_GetValueType","_FPDFAnnot_GetVertices","_FPDFAnnot_HasAttachmentPoints","_FPDFAnnot_HasKey","_FPDFAnnot_IsChecked","_FPDFAnnot_IsObjectSupportedSubtype","_FPDFAnnot_IsOptionSelected","_FPDFAnnot_IsSupportedSubtype","_FPDFAnnot_RemoveInkList","_FPDFAnnot_RemoveObject","_FPDFAnnot_SetAP","_FPDFAnnot_SetAttachmentPoints","_FPDFAnnot_SetBorder","_FPDFAnnot_SetColor","_FPDFAnnot_SetFlags","_FPDFAnnot_SetFocusableSubtypes","_FPDFAnnot_SetFontColor","_FPDFAnnot_SetFormFieldFlags","_FPDFAnnot_SetRect","_FPDFAnnot_SetStringValue","_FPDFAnnot_SetURI","_FPDFAnnot_UpdateObject","_FPDFAttachment_GetFile","_FPDFAttachment_GetName","_FPDFAttachment_GetStringValue","_FPDFAttachment_GetSubtype","_FPDFAttachment_GetValueType","_FPDFAttachment_HasKey","_FPDFAttachment_SetFile","_FPDFAttachment_SetStringValue","_FPDFAvail_Create","_FPDFAvail_Destroy","_FPDFAvail_GetDocument","_FPDFAvail_GetFirstPageNum","_FPDFAvail_IsDocAvail","_FPDFAvail_IsFormAvail","_FPDFAvail_IsLinearized","_FPDFAvail_IsPageAvail","_FPDFBitmap_Create","_FPDFBitmap_CreateEx","_FPDFBitmap_Destroy","_FPDFBitmap_FillRect","_FPDFBitmap_GetBuffer","_FPDFBitmap_GetFormat","_FPDFBitmap_GetHeight","_FPDFBitmap_GetStride","_FPDFBitmap_GetWidth","_FPDFBookmark_Find","_FPDFBookmark_GetAction","_FPDFBookmark_GetCount","_FPDFBookmark_GetDest","_FPDFBookmark_GetFirstChild","_FPDFBookmark_GetNextSibling","_FPDFBookmark_GetTitle","_FPDFCatalog_IsTagged","_FPDFCatalog_SetLanguage","_FPDFClipPath_CountPaths","_FPDFClipPath_CountPathSegments","_FPDFClipPath_GetPathSegment","_FPDFDest_GetDestPageIndex","_FPDFDest_GetLocationInPage","_FPDFDest_GetView","_FPDFDoc_AddAttachment","_FPDFDoc_CloseJavaScriptAction","_FPDFDoc_DeleteAttachment","_FPDFDOC_ExitFormFillEnvironment","_FPDFDoc_GetAttachment","_FPDFDoc_GetAttachmentCount","_FPDFDoc_GetJavaScriptAction","_FPDFDoc_GetJavaScriptActionCount","_FPDFDoc_GetPageMode","_FPDFDOC_InitFormFillEnvironment","_FPDFFont_Close","_FPDFFont_GetAscent","_FPDFFont_GetBaseFontName","_FPDFFont_GetDescent","_FPDFFont_GetFamilyName","_FPDFFont_GetFlags","_FPDFFont_GetFontData","_FPDFFont_GetGlyphPath","_FPDFFont_GetGlyphWidth","_FPDFFont_GetIsEmbedded","_FPDFFont_GetItalicAngle","_FPDFFont_GetWeight","_FPDFFormObj_CountObjects","_FPDFFormObj_GetObject","_FPDFFormObj_RemoveObject","_FPDFGlyphPath_CountGlyphSegments","_FPDFGlyphPath_GetGlyphPathSegment","_FPDFImageObj_GetBitmap","_FPDFImageObj_GetIccProfileDataDecoded","_FPDFImageObj_GetImageDataDecoded","_FPDFImageObj_GetImageDataRaw","_FPDFImageObj_GetImageFilter","_FPDFImageObj_GetImageFilterCount","_FPDFImageObj_GetImageMetadata","_FPDFImageObj_GetImagePixelSize","_FPDFImageObj_GetRenderedBitmap","_FPDFImageObj_LoadJpegFile","_FPDFImageObj_LoadJpegFileInline","_FPDFImageObj_SetBitmap","_FPDFImageObj_SetMatrix","_FPDFJavaScriptAction_GetName","_FPDFJavaScriptAction_GetScript","_FPDFLink_CloseWebLinks","_FPDFLink_CountQuadPoints","_FPDFLink_CountRects","_FPDFLink_CountWebLinks","_FPDFLink_Enumerate","_FPDFLink_GetAction","_FPDFLink_GetAnnot","_FPDFLink_GetAnnotRect","_FPDFLink_GetDest","_FPDFLink_GetLinkAtPoint","_FPDFLink_GetLinkZOrderAtPoint","_FPDFLink_GetQuadPoints","_FPDFLink_GetRect","_FPDFLink_GetTextRange","_FPDFLink_GetURL","_FPDFLink_LoadWebLinks","_FPDFPage_CloseAnnot","_FPDFPage_CountObjects","_FPDFPage_CreateAnnot","_FPDFPage_Delete","_FPDFPage_Flatten","_FPDFPage_FormFieldZOrderAtPoint","_FPDFPage_GenerateContent","_FPDFPage_GetAnnot","_FPDFPage_GetAnnotCount","_FPDFPage_GetAnnotIndex","_FPDFPage_GetArtBox","_FPDFPage_GetBleedBox","_FPDFPage_GetCropBox","_FPDFPage_GetDecodedThumbnailData","_FPDFPage_GetMediaBox","_FPDFPage_GetObject","_FPDFPage_GetRawThumbnailData","_FPDFPage_GetRotation","_FPDFPage_GetThumbnailAsBitmap","_FPDFPage_GetTrimBox","_FPDFPage_HasFormFieldAtPoint","_FPDFPage_HasTransparency","_FPDFPage_InsertClipPath","_FPDFPage_InsertObject","_FPDFPage_InsertObjectAtIndex","_FPDFPage_New","_FPDFPage_RemoveAnnot","_FPDFPage_RemoveObject","_FPDFPage_SetArtBox","_FPDFPage_SetBleedBox","_FPDFPage_SetCropBox","_FPDFPage_SetMediaBox","_FPDFPage_SetRotation","_FPDFPage_SetTrimBox","_FPDFPage_TransformAnnots","_FPDFPage_TransFormWithClip","_FPDFPageObj_AddMark","_FPDFPageObj_CountMarks","_FPDFPageObj_CreateNewPath","_FPDFPageObj_CreateNewRect","_FPDFPageObj_CreateTextObj","_FPDFPageObj_Destroy","_FPDFPageObj_GetBounds","_FPDFPageObj_GetClipPath","_FPDFPageObj_GetDashArray","_FPDFPageObj_GetDashCount","_FPDFPageObj_GetDashPhase","_FPDFPageObj_GetFillColor","_FPDFPageObj_GetIsActive","_FPDFPageObj_GetLineCap","_FPDFPageObj_GetLineJoin","_FPDFPageObj_GetMark","_FPDFPageObj_GetMarkedContentID","_FPDFPageObj_GetMatrix","_FPDFPageObj_GetRotatedBounds","_FPDFPageObj_GetStrokeColor","_FPDFPageObj_GetStrokeWidth","_FPDFPageObj_GetType","_FPDFPageObj_HasTransparency","_FPDFPageObj_NewImageObj","_FPDFPageObj_NewTextObj","_FPDFPageObj_RemoveMark","_FPDFPageObj_SetBlendMode","_FPDFPageObj_SetDashArray","_FPDFPageObj_SetDashPhase","_FPDFPageObj_SetFillColor","_FPDFPageObj_SetIsActive","_FPDFPageObj_SetLineCap","_FPDFPageObj_SetLineJoin","_FPDFPageObj_SetMatrix","_FPDFPageObj_SetStrokeColor","_FPDFPageObj_SetStrokeWidth","_FPDFPageObj_Transform","_FPDFPageObj_TransformClipPath","_FPDFPageObj_TransformF","_FPDFPageObjMark_CountParams","_FPDFPageObjMark_GetName","_FPDFPageObjMark_GetParamBlobValue","_FPDFPageObjMark_GetParamIntValue","_FPDFPageObjMark_GetParamKey","_FPDFPageObjMark_GetParamStringValue","_FPDFPageObjMark_GetParamValueType","_FPDFPageObjMark_RemoveParam","_FPDFPageObjMark_SetBlobParam","_FPDFPageObjMark_SetIntParam","_FPDFPageObjMark_SetStringParam","_FPDFPath_BezierTo","_FPDFPath_Close","_FPDFPath_CountSegments","_FPDFPath_GetDrawMode","_FPDFPath_GetPathSegment","_FPDFPath_LineTo","_FPDFPath_MoveTo","_FPDFPath_SetDrawMode","_FPDFPathSegment_GetClose","_FPDFPathSegment_GetPoint","_FPDFPathSegment_GetType","_FPDFSignatureObj_GetByteRange","_FPDFSignatureObj_GetContents","_FPDFSignatureObj_GetDocMDPPermission","_FPDFSignatureObj_GetReason","_FPDFSignatureObj_GetSubFilter","_FPDFSignatureObj_GetTime","_FPDFText_ClosePage","_FPDFText_CountChars","_FPDFText_CountRects","_FPDFText_FindClose","_FPDFText_FindNext","_FPDFText_FindPrev","_FPDFText_FindStart","_FPDFText_GetBoundedText","_FPDFText_GetCharAngle","_FPDFText_GetCharBox","_FPDFText_GetCharIndexAtPos","_FPDFText_GetCharIndexFromTextIndex","_FPDFText_GetCharOrigin","_FPDFText_GetFillColor","_FPDFText_GetFontInfo","_FPDFText_GetFontSize","_FPDFText_GetFontWeight","_FPDFText_GetLooseCharBox","_FPDFText_GetMatrix","_FPDFText_GetRect","_FPDFText_GetSchCount","_FPDFText_GetSchResultIndex","_FPDFText_GetStrokeColor","_FPDFText_GetText","_FPDFText_GetTextIndexFromCharIndex","_FPDFText_GetTextObject","_FPDFText_GetUnicode","_FPDFText_HasUnicodeMapError","_FPDFText_IsGenerated","_FPDFText_IsHyphen","_FPDFText_LoadCidType2Font","_FPDFText_LoadFont","_FPDFText_LoadPage","_FPDFText_LoadStandardFont","_FPDFText_SetCharcodes","_FPDFText_SetText","_FPDFTextObj_GetFont","_FPDFTextObj_GetFontSize","_FPDFTextObj_GetRenderedBitmap","_FPDFTextObj_GetText","_FPDFTextObj_GetTextRenderMode","_FPDFTextObj_SetTextRenderMode","_PDFiumExt_CloseFileWriter","_PDFiumExt_CloseFormFillInfo","_PDFiumExt_ExitFormFillEnvironment","_PDFiumExt_GetFileWriterData","_PDFiumExt_GetFileWriterSize","_PDFiumExt_Init","_PDFiumExt_InitFormFillEnvironment","_PDFiumExt_OpenFileWriter","_PDFiumExt_OpenFormFillInfo","_PDFiumExt_SaveAsCopy","_malloc","_free","_memory","___indirect_function_table","onRuntimeInitialized"].forEach((e=>{if(!Object.getOwnPropertyDescriptor(i,e)){Object.defineProperty(i,e,{get:()=>q("You are getting "+e+" on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js"),set:()=>q("You are setting "+e+" on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")})}}));var s=typeof window=="object";var u=typeof importScripts=="function";typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&process.type!="renderer";var F=!s&&!false&&!u;var m;var l=Object.assign({},r);var d="./this.program";var c="";function _(e){if(r["locateFile"]){return r["locateFile"](e,c)}return c+e}var P,g;if(F){if(typeof process=="object"&&typeof m==="function"||typeof window=="object"||typeof importScripts=="function")throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");g=e=>{if(typeof readbuffer=="function"){return new Uint8Array(readbuffer(e))}let t=read(e,"binary");A(typeof t=="object");return t};P=e=>new Promise(((t,n)=>{setTimeout((()=>t(g(e))))}));globalThis.clearTimeout??=e=>{};globalThis.setTimeout??=e=>typeof e=="function"?e():q();if(typeof print!="undefined"){globalThis.console??={};console.log=print;console.warn=console.error=globalThis.printErr??print}}else if(s||u){if(u){c=self.location.href}else if(typeof document!="undefined"&&document.currentScript){c=document.currentScript.src}if(e){c=e}if(c.startsWith("blob:")){c=""}else{c=c.substr(0,c.replace(/[?#].*/,"").lastIndexOf("/")+1)}if(!(typeof window=="object"||typeof importScripts=="function"))throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");{if(u){g=e=>{var t=new XMLHttpRequest;t.open("GET",e,false);t.responseType="arraybuffer";t.send(null);return new Uint8Array(t.response)}}P=e=>{A(!ee(e),"readAsync does not work with file:// URLs");return fetch(e,{credentials:"same-origin"}).then((e=>{if(e.ok){return e.arrayBuffer()}return Promise.reject(new Error(e.status+" : "+e.url))}))}}}else{throw new Error("environment detection error")}var h=r["print"]||console.log.bind(console);var f=r["printErr"]||console.error.bind(console);Object.assign(r,l);l=null;_n();if(r["arguments"])r["arguments"];de("arguments","arguments_");if(r["thisProgram"])d=r["thisProgram"];de("thisProgram","thisProgram");A(typeof r["memoryInitializerPrefixURL"]=="undefined","Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead");A(typeof r["pthreadMainPrefixURL"]=="undefined","Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead");A(typeof r["cdInitializerPrefixURL"]=="undefined","Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead");A(typeof r["filePackagePrefixURL"]=="undefined","Module.filePackagePrefixURL option was removed, use Module.locateFile instead");A(typeof r["read"]=="undefined","Module.read option was removed");A(typeof r["readAsync"]=="undefined","Module.readAsync option was removed (modify readAsync in JS)");A(typeof r["readBinary"]=="undefined","Module.readBinary option was removed (modify readBinary in JS)");A(typeof r["setWindowTitle"]=="undefined","Module.setWindowTitle option was removed (modify emscripten_set_window_title in JS)");A(typeof r["TOTAL_MEMORY"]=="undefined","Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY");de("asm","wasmExports");de("readAsync","readAsync");de("readBinary","readBinary");de("setWindowTitle","setWindowTitle");var D=r["wasmBinary"];de("wasmBinary","wasmBinary");if(typeof WebAssembly!="object"){f("no native wasm support detected")}var b;var p=false;function A(e,t){if(!e){q("Assertion failed"+(t?": "+t:""))}}var y,M,E,G,S,v,C,T;function O(){var e=b.buffer;r["HEAP8"]=y=new Int8Array(e);r["HEAP16"]=E=new Int16Array(e);r["HEAPU8"]=M=new Uint8Array(e);r["HEAPU16"]=G=new Uint16Array(e);r["HEAP32"]=S=new Int32Array(e);r["HEAPU32"]=v=new Uint32Array(e);r["HEAPF32"]=C=new Float32Array(e);r["HEAPF64"]=T=new Float64Array(e)}A(!r["STACK_SIZE"],"STACK_SIZE can no longer be set at runtime.  Use -sSTACK_SIZE at link time");A(typeof Int32Array!="undefined"&&typeof Float64Array!=="undefined"&&Int32Array.prototype.subarray!=undefined&&Int32Array.prototype.set!=undefined,"JS engine does not provide full typed array support");A(!r["wasmMemory"],"Use of `wasmMemory` detected.  Use -sIMPORTED_MEMORY to define wasmMemory externally");A(!r["INITIAL_MEMORY"],"Detected runtime INITIAL_MEMORY setting.  Use -sIMPORTED_MEMORY to define wasmMemory dynamically");function x(){var e=An();A((e&3)==0);if(e==0){e+=4}v[e>>2]=34821223;v[e+4>>2]=2310721022;v[0>>2]=1668509029}function w(){if(p)return;var e=An();if(e==0){e+=4}var t=v[e>>2];var n=v[e+4>>2];if(t!=34821223||n!=2310721022){q(`Stack overflow! Stack cookie has been overwritten at ${pe(e)}, expected hex dwords 0x89BACDFE and 0x2135467, but received ${pe(n)} ${pe(t)}`)}if(v[0>>2]!=1668509029){q("Runtime error: The application has corrupted its heap memory area (address zero)!")}}var R=[];var I=[];var k=[];var j=false;function B(){var e=r["preRun"];if(e){if(typeof e=="function")e=[e];e.forEach(V)}De(R)}function L(){A(!j);j=true;w();if(!r["noFSInit"]&&!tt.initialized)tt.init();tt.ignorePermissions=false;De(I)}function N(){w();var e=r["postRun"];if(e){if(typeof e=="function")e=[e];e.forEach(W)}De(k)}function V(e){R.unshift(e)}function U(e){I.unshift(e)}function W(e){k.unshift(e)}A(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");A(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");A(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");A(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");var z=0;var $=null;var H=null;var X={};function Y(e){var t=e;while(1){if(!X[e])return e;e=t+Math.random()}}function K(e){z++;r["monitorRunDependencies"]?.(z);if(e){A(!X[e]);X[e]=1;if($===null&&typeof setInterval!="undefined"){$=setInterval((()=>{if(p){clearInterval($);$=null;return}var e=false;for(var t in X){if(!e){e=true;f("still waiting on run dependencies:")}f(`dependency: ${t}`)}if(e){f("(end of list)")}}),1e4)}}else{f("warning: run dependency added without ID")}}function J(e){z--;r["monitorRunDependencies"]?.(z);if(e){A(X[e]);delete X[e]}else{f("warning: run dependency removed without ID")}if(z==0){if($!==null){clearInterval($);$=null}if(H){var t=H;H=null;t()}}}function q(e){r["onAbort"]?.(e);e="Aborted("+e+")";f(e);p=true;var t=new WebAssembly.RuntimeError(e);a(t);throw t}var Q="data:application/octet-stream;base64,";var Z=e=>e.startsWith(Q);var ee=e=>e.startsWith("file://");function te(e,t){return(...n)=>{A(j,`native function \`${e}\` called before runtime initialization`);var r=gn[e];A(r,`exported native function \`${e}\` not found`);A(n.length<=t,`native function \`${e}\` called with ${n.length} args but expects ${t}`);return r(...n)}}function ne(){if(r["locateFile"]){var e="pdfium.wasm";if(!Z(e)){return _(e)}return e}if(F)return"pdfium.wasm";return new URL("pdfium.wasm",import.meta.url).href}var re;function oe(e){if(e==re&&D){return new Uint8Array(D)}if(g){return g(e)}throw"both async and sync fetching of the wasm failed"}function ae(e){if(!D){return P(e).then((e=>new Uint8Array(e)),(()=>oe(e)))}return Promise.resolve().then((()=>oe(e)))}function ie(e,t,n){return ae(e).then((e=>WebAssembly.instantiate(e,t))).then(n,(e=>{f(`failed to asynchronously prepare wasm: ${e}`);if(ee(re)){f(`warning: Loading from a file URI (${re}) is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing`)}q(e)}))}function se(e,t,n,r){if(!e&&typeof WebAssembly.instantiateStreaming=="function"&&!Z(t)&&!false&&typeof fetch=="function"){return fetch(t,{credentials:"same-origin"}).then((e=>{var o=WebAssembly.instantiateStreaming(e,n);return o.then(r,(function(e){f(`wasm streaming compile failed: ${e}`);f("falling back to ArrayBuffer instantiation");return ie(t,n,r)}))}))}return ie(t,n,r)}function ue(){return{env:Pn,wasi_snapshot_preview1:Pn}}function Fe(){var e=ue();function t(e,t){gn=e.exports;r["wasmExports"]=gn;b=gn["memory"];A(b,"memory not found in wasm exports");O();zt=gn["__indirect_function_table"];A(zt,"table not found in wasm exports");U(gn["__wasm_call_ctors"]);J("wasm-instantiate");return gn}K("wasm-instantiate");var n=r;function o(e){A(r===n,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?");n=null;t(e["instance"])}if(r["instantiateWasm"]){try{return r["instantiateWasm"](e,t)}catch(e){f(`Module.instantiateWasm callback failed with error: ${e}`);a(e)}}re??=ne();se(D,re,e,o).catch(a);return{}}var me;var le;(()=>{var e=new Int16Array(1);var t=new Int8Array(e.buffer);e[0]=25459;if(t[0]!==115||t[1]!==99)throw"Runtime error: expected the system to be little-endian! (Run with -sSUPPORT_BIG_ENDIAN to bypass)"})();if(r["ENVIRONMENT"]){throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -sENVIRONMENT=web or -sENVIRONMENT=node)")}function de(e,t,n=true){if(!Object.getOwnPropertyDescriptor(r,e)){Object.defineProperty(r,e,{configurable:true,get(){let r=n?" (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)":"";q(`\`Module.${e}\` has been replaced by \`${t}\``+r)}})}}function ce(e){if(Object.getOwnPropertyDescriptor(r,e)){q(`\`Module.${e}\` was supplied but \`${e}\` not included in INCOMING_MODULE_JS_API`)}}function _e(e){return e==="FS_createPath"||e==="FS_createDataFile"||e==="FS_createPreloadedFile"||e==="FS_unlink"||e==="addRunDependency"||e==="FS_createLazyFile"||e==="FS_createDevice"||e==="removeRunDependency"}function Pe(e,t){if(typeof globalThis!="undefined"&&!Object.getOwnPropertyDescriptor(globalThis,e)){Object.defineProperty(globalThis,e,{configurable:true,get(){t();return undefined}})}}function ge(e,t){Pe(e,(()=>{Ee(`\`${e}\` is not longer defined by emscripten. ${t}`)}))}ge("buffer","Please use HEAP8.buffer or wasmMemory.buffer");ge("asm","Please use wasmExports instead");function he(e){Pe(e,(()=>{var t=`\`${e}\` is a library symbol and not included by default; add it to your library.js __deps or to DEFAULT_LIBRARY_FUNCS_TO_INCLUDE on the command line`;var n=e;if(!n.startsWith("_")){n="$"+e}t+=` (e.g. -sDEFAULT_LIBRARY_FUNCS_TO_INCLUDE='${n}')`;if(_e(e)){t+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you"}Ee(t)}));fe(e)}function fe(e){if(!Object.getOwnPropertyDescriptor(r,e)){Object.defineProperty(r,e,{configurable:true,get(){var t=`'${e}' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the Emscripten FAQ)`;if(_e(e)){t+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you"}q(t)}})}}var De=e=>{e.forEach((e=>e(r)))};function be(e,t="i8"){if(t.endsWith("*"))t="*";switch(t){case"i1":return y[e];case"i8":return y[e];case"i16":return E[e>>1];case"i32":return S[e>>2];case"i64":q("to do getValue(i64) use WASM_BIGINT");case"float":return C[e>>2];case"double":return T[e>>3];case"*":return v[e>>2];default:q(`invalid type for getValue: ${t}`)}}r["noExitRuntime"]||true;var pe=e=>{A(typeof e==="number");e>>>=0;return"0x"+e.toString(16).padStart(8,"0")};function Ae(e,t,n="i8"){if(n.endsWith("*"))n="*";switch(n){case"i1":y[e]=t;break;case"i8":y[e]=t;break;case"i16":E[e>>1]=t;break;case"i32":S[e>>2]=t;break;case"i64":q("to do setValue(i64) use WASM_BIGINT");case"float":C[e>>2]=t;break;case"double":T[e>>3]=t;break;case"*":v[e>>2]=t;break;default:q(`invalid type for setValue: ${n}`)}}var ye=e=>yn(e);var Me=()=>En();var Ee=e=>{Ee.shown||={};if(!Ee.shown[e]){Ee.shown[e]=1;f(e)}};var Ge=typeof TextDecoder!="undefined"?new TextDecoder:undefined;var Se=(e,t=0,n=NaN)=>{var r=t+n;var o=t;while(e[o]&&!(o>=r))++o;if(o-t>16&&e.buffer&&Ge){return Ge.decode(e.subarray(t,o))}var a="";while(t<o){var i=e[t++];if(!(i&128)){a+=String.fromCharCode(i);continue}var s=e[t++]&63;if((i&224)==192){a+=String.fromCharCode((i&31)<<6|s);continue}var u=e[t++]&63;if((i&240)==224){i=(i&15)<<12|s<<6|u}else{if((i&248)!=240)Ee("Invalid UTF-8 leading byte "+pe(i)+" encountered when deserializing a UTF-8 string in wasm memory to a JS string!");i=(i&7)<<18|s<<12|u<<6|e[t++]&63}if(i<65536){a+=String.fromCharCode(i)}else{var F=i-65536;a+=String.fromCharCode(55296|F>>10,56320|F&1023)}}return a};var ve=(e,t)=>{A(typeof e=="number",`UTF8ToString expects a number (got ${typeof e})`);return e?Se(M,e,t):""};var Ce=(e,t,n,r)=>{q(`Assertion failed: ${ve(e)}, at: `+[t?ve(t):"unknown filename",n,r?ve(r):"unknown function"])};function Te(){A(nt.varargs!=undefined);var e=S[+nt.varargs>>2];nt.varargs+=4;return e}var Oe=Te;var xe={isAbs:e=>e.charAt(0)==="/",splitPath:e=>{var t=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return t.exec(e).slice(1)},normalizeArray:(e,t)=>{var n=0;for(var r=e.length-1;r>=0;r--){var o=e[r];if(o==="."){e.splice(r,1)}else if(o===".."){e.splice(r,1);n++}else if(n){e.splice(r,1);n--}}if(t){for(;n;n--){e.unshift("..")}}return e},normalize:e=>{var t=xe.isAbs(e),n=e.substr(-1)==="/";e=xe.normalizeArray(e.split("/").filter((e=>!!e)),!t).join("/");if(!e&&!t){e="."}if(e&&n){e+="/"}return(t?"/":"")+e},dirname:e=>{var t=xe.splitPath(e),n=t[0],r=t[1];if(!n&&!r){return"."}if(r){r=r.substr(0,r.length-1)}return n+r},basename:e=>{if(e==="/")return"/";e=xe.normalize(e);e=e.replace(/\/$/,"");var t=e.lastIndexOf("/");if(t===-1)return e;return e.substr(t+1)},join:(...e)=>xe.normalize(e.join("/")),join2:(e,t)=>xe.normalize(e+"/"+t)};var we=()=>{if(typeof crypto=="object"&&typeof crypto["getRandomValues"]=="function"){return e=>crypto.getRandomValues(e)}q("no cryptographic support found for randomDevice. consider polyfilling it if you want to use something insecure like Math.random(), e.g. put this in a --pre-js: var crypto = { getRandomValues: (array) => { for (var i = 0; i < array.length; i++) array[i] = (Math.random()*256)|0 } };")};var Re=e=>(Re=we())(e);var Ie={resolve:(...e)=>{var t="",n=false;for(var r=e.length-1;r>=-1&&!n;r--){var o=r>=0?e[r]:tt.cwd();if(typeof o!="string"){throw new TypeError("Arguments to path.resolve must be strings")}else if(!o){return""}t=o+"/"+t;n=xe.isAbs(o)}t=xe.normalizeArray(t.split("/").filter((e=>!!e)),!n).join("/");return(n?"/":"")+t||"."},relative:(e,t)=>{e=Ie.resolve(e).substr(1);t=Ie.resolve(t).substr(1);function n(e){var t=0;for(;t<e.length;t++){if(e[t]!=="")break}var n=e.length-1;for(;n>=0;n--){if(e[n]!=="")break}if(t>n)return[];return e.slice(t,n-t+1)}var r=n(e.split("/"));var o=n(t.split("/"));var a=Math.min(r.length,o.length);var i=a;for(var s=0;s<a;s++){if(r[s]!==o[s]){i=s;break}}var u=[];for(var s=i;s<r.length;s++){u.push("..")}u=u.concat(o.slice(i));return u.join("/")}};var ke=[];var je=e=>{var t=0;for(var n=0;n<e.length;++n){var r=e.charCodeAt(n);if(r<=127){t++}else if(r<=2047){t+=2}else if(r>=55296&&r<=57343){t+=4;++n}else{t+=3}}return t};var Be=(e,t,n,r)=>{A(typeof e==="string",`stringToUTF8Array expects a string (got ${typeof e})`);if(!(r>0))return 0;var o=n;var a=n+r-1;for(var i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s>=55296&&s<=57343){var u=e.charCodeAt(++i);s=65536+((s&1023)<<10)|u&1023}if(s<=127){if(n>=a)break;t[n++]=s}else if(s<=2047){if(n+1>=a)break;t[n++]=192|s>>6;t[n++]=128|s&63}else if(s<=65535){if(n+2>=a)break;t[n++]=224|s>>12;t[n++]=128|s>>6&63;t[n++]=128|s&63}else{if(n+3>=a)break;if(s>1114111)Ee("Invalid Unicode code point "+pe(s)+" encountered when serializing a JS string to a UTF-8 string in wasm memory! (Valid unicode code points should be in range 0-0x10FFFF).");t[n++]=240|s>>18;t[n++]=128|s>>12&63;t[n++]=128|s>>6&63;t[n++]=128|s&63}}t[n]=0;return n-o};function Le(e,t,n){var r=n>0?n:je(e)+1;var o=new Array(r);var a=Be(e,o,0,o.length);if(t)o.length=a;return o}var Ne=()=>{if(!ke.length){var e=null;if(typeof window!="undefined"&&typeof window.prompt=="function"){e=window.prompt("Input: ");if(e!==null){e+="\n"}}else if(typeof readline=="function"){e=readline();if(e){e+="\n"}}else;if(!e){return null}ke=Le(e,true)}return ke.shift()};var Ve={ttys:[],init(){},shutdown(){},register(e,t){Ve.ttys[e]={input:[],output:[],ops:t};tt.registerDevice(e,Ve.stream_ops)},stream_ops:{open(e){var t=Ve.ttys[e.node.rdev];if(!t){throw new tt.ErrnoError(43)}e.tty=t;e.seekable=false},close(e){e.tty.ops.fsync(e.tty)},fsync(e){e.tty.ops.fsync(e.tty)},read(e,t,n,r,o){if(!e.tty||!e.tty.ops.get_char){throw new tt.ErrnoError(60)}var a=0;for(var i=0;i<r;i++){var s;try{s=e.tty.ops.get_char(e.tty)}catch(e){throw new tt.ErrnoError(29)}if(s===undefined&&a===0){throw new tt.ErrnoError(6)}if(s===null||s===undefined)break;a++;t[n+i]=s}if(a){e.node.timestamp=Date.now()}return a},write(e,t,n,r,o){if(!e.tty||!e.tty.ops.put_char){throw new tt.ErrnoError(60)}try{for(var a=0;a<r;a++){e.tty.ops.put_char(e.tty,t[n+a])}}catch(e){throw new tt.ErrnoError(29)}if(r){e.node.timestamp=Date.now()}return a}},default_tty_ops:{get_char(e){return Ne()},put_char(e,t){if(t===null||t===10){h(Se(e.output));e.output=[]}else{if(t!=0)e.output.push(t)}},fsync(e){if(e.output&&e.output.length>0){h(Se(e.output));e.output=[]}},ioctl_tcgets(e){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets(e,t,n){return 0},ioctl_tiocgwinsz(e){return[24,80]}},default_tty1_ops:{put_char(e,t){if(t===null||t===10){f(Se(e.output));e.output=[]}else{if(t!=0)e.output.push(t)}},fsync(e){if(e.output&&e.output.length>0){f(Se(e.output));e.output=[]}}}};var Ue=(e,t)=>{M.fill(0,e,e+t)};var We=(e,t)=>{A(t,"alignment argument is required");return Math.ceil(e/t)*t};var ze=e=>{e=We(e,65536);var t=fn(65536,e);if(t)Ue(t,e);return t};var $e={ops_table:null,mount(e){return $e.createNode(null,"/",16384|511,0)},createNode(e,t,n,r){if(tt.isBlkdev(n)||tt.isFIFO(n)){throw new tt.ErrnoError(63)}$e.ops_table||={dir:{node:{getattr:$e.node_ops.getattr,setattr:$e.node_ops.setattr,lookup:$e.node_ops.lookup,mknod:$e.node_ops.mknod,rename:$e.node_ops.rename,unlink:$e.node_ops.unlink,rmdir:$e.node_ops.rmdir,readdir:$e.node_ops.readdir,symlink:$e.node_ops.symlink},stream:{llseek:$e.stream_ops.llseek}},file:{node:{getattr:$e.node_ops.getattr,setattr:$e.node_ops.setattr},stream:{llseek:$e.stream_ops.llseek,read:$e.stream_ops.read,write:$e.stream_ops.write,allocate:$e.stream_ops.allocate,mmap:$e.stream_ops.mmap,msync:$e.stream_ops.msync}},link:{node:{getattr:$e.node_ops.getattr,setattr:$e.node_ops.setattr,readlink:$e.node_ops.readlink},stream:{}},chrdev:{node:{getattr:$e.node_ops.getattr,setattr:$e.node_ops.setattr},stream:tt.chrdev_stream_ops}};var o=tt.createNode(e,t,n,r);if(tt.isDir(o.mode)){o.node_ops=$e.ops_table.dir.node;o.stream_ops=$e.ops_table.dir.stream;o.contents={}}else if(tt.isFile(o.mode)){o.node_ops=$e.ops_table.file.node;o.stream_ops=$e.ops_table.file.stream;o.usedBytes=0;o.contents=null}else if(tt.isLink(o.mode)){o.node_ops=$e.ops_table.link.node;o.stream_ops=$e.ops_table.link.stream}else if(tt.isChrdev(o.mode)){o.node_ops=$e.ops_table.chrdev.node;o.stream_ops=$e.ops_table.chrdev.stream}o.timestamp=Date.now();if(e){e.contents[t]=o;e.timestamp=o.timestamp}return o},getFileDataAsTypedArray(e){if(!e.contents)return new Uint8Array(0);if(e.contents.subarray)return e.contents.subarray(0,e.usedBytes);return new Uint8Array(e.contents)},expandFileStorage(e,t){var n=e.contents?e.contents.length:0;if(n>=t)return;var r=1024*1024;t=Math.max(t,n*(n<r?2:1.125)>>>0);if(n!=0)t=Math.max(t,256);var o=e.contents;e.contents=new Uint8Array(t);if(e.usedBytes>0)e.contents.set(o.subarray(0,e.usedBytes),0)},resizeFileStorage(e,t){if(e.usedBytes==t)return;if(t==0){e.contents=null;e.usedBytes=0}else{var n=e.contents;e.contents=new Uint8Array(t);if(n){e.contents.set(n.subarray(0,Math.min(t,e.usedBytes)))}e.usedBytes=t}},node_ops:{getattr(e){var t={};t.dev=tt.isChrdev(e.mode)?e.id:1;t.ino=e.id;t.mode=e.mode;t.nlink=1;t.uid=0;t.gid=0;t.rdev=e.rdev;if(tt.isDir(e.mode)){t.size=4096}else if(tt.isFile(e.mode)){t.size=e.usedBytes}else if(tt.isLink(e.mode)){t.size=e.link.length}else{t.size=0}t.atime=new Date(e.timestamp);t.mtime=new Date(e.timestamp);t.ctime=new Date(e.timestamp);t.blksize=4096;t.blocks=Math.ceil(t.size/t.blksize);return t},setattr(e,t){if(t.mode!==undefined){e.mode=t.mode}if(t.timestamp!==undefined){e.timestamp=t.timestamp}if(t.size!==undefined){$e.resizeFileStorage(e,t.size)}},lookup(e,t){throw tt.genericErrors[44]},mknod(e,t,n,r){return $e.createNode(e,t,n,r)},rename(e,t,n){if(tt.isDir(e.mode)){var r;try{r=tt.lookupNode(t,n)}catch(e){}if(r){for(var o in r.contents){throw new tt.ErrnoError(55)}}}delete e.parent.contents[e.name];e.parent.timestamp=Date.now();e.name=n;t.contents[n]=e;t.timestamp=e.parent.timestamp},unlink(e,t){delete e.contents[t];e.timestamp=Date.now()},rmdir(e,t){var n=tt.lookupNode(e,t);for(var r in n.contents){throw new tt.ErrnoError(55)}delete e.contents[t];e.timestamp=Date.now()},readdir(e){var t=[".",".."];for(var n of Object.keys(e.contents)){t.push(n)}return t},symlink(e,t,n){var r=$e.createNode(e,t,511|40960,0);r.link=n;return r},readlink(e){if(!tt.isLink(e.mode)){throw new tt.ErrnoError(28)}return e.link}},stream_ops:{read(e,t,n,r,o){var a=e.node.contents;if(o>=e.node.usedBytes)return 0;var i=Math.min(e.node.usedBytes-o,r);A(i>=0);if(i>8&&a.subarray){t.set(a.subarray(o,o+i),n)}else{for(var s=0;s<i;s++)t[n+s]=a[o+s]}return i},write(e,t,n,r,o,a){A(!(t instanceof ArrayBuffer));if(t.buffer===y.buffer){a=false}if(!r)return 0;var i=e.node;i.timestamp=Date.now();if(t.subarray&&(!i.contents||i.contents.subarray)){if(a){A(o===0,"canOwn must imply no weird position inside the file");i.contents=t.subarray(n,n+r);i.usedBytes=r;return r}else if(i.usedBytes===0&&o===0){i.contents=t.slice(n,n+r);i.usedBytes=r;return r}else if(o+r<=i.usedBytes){i.contents.set(t.subarray(n,n+r),o);return r}}$e.expandFileStorage(i,o+r);if(i.contents.subarray&&t.subarray){i.contents.set(t.subarray(n,n+r),o)}else{for(var s=0;s<r;s++){i.contents[o+s]=t[n+s]}}i.usedBytes=Math.max(i.usedBytes,o+r);return r},llseek(e,t,n){var r=t;if(n===1){r+=e.position}else if(n===2){if(tt.isFile(e.node.mode)){r+=e.node.usedBytes}}if(r<0){throw new tt.ErrnoError(28)}return r},allocate(e,t,n){$e.expandFileStorage(e.node,t+n);e.node.usedBytes=Math.max(e.node.usedBytes,t+n)},mmap(e,t,n,r,o){if(!tt.isFile(e.node.mode)){throw new tt.ErrnoError(43)}var a;var i;var s=e.node.contents;if(!(o&2)&&s&&s.buffer===y.buffer){i=false;a=s.byteOffset}else{i=true;a=ze(t);if(!a){throw new tt.ErrnoError(48)}if(s){if(n>0||n+t<s.length){if(s.subarray){s=s.subarray(n,n+t)}else{s=Array.prototype.slice.call(s,n,n+t)}}y.set(s,a)}}return{ptr:a,allocated:i}},msync(e,t,n,r,o){$e.stream_ops.write(e,t,0,r,n,false);return 0}}};var He=(e,t,n,r)=>{var o=!r?Y(`al ${e}`):"";P(e).then((n=>{A(n,`Loading data file "${e}" failed (no arrayBuffer).`);t(new Uint8Array(n));if(o)J(o)}),(t=>{if(n){n()}else{throw`Loading data file "${e}" failed.`}}));if(o)K(o)};var Xe=(e,t,n,r,o,a)=>{tt.createDataFile(e,t,n,r,o,a)};var Ye=r["preloadPlugins"]||[];var Ke=(e,t,n,r)=>{if(typeof Browser!="undefined")Browser.init();var o=false;Ye.forEach((a=>{if(o)return;if(a["canHandle"](t)){a["handle"](e,t,n,r);o=true}}));return o};var Je=(e,t,n,r,o,a,i,s,u,F)=>{var m=t?Ie.resolve(xe.join2(e,t)):e;var l=Y(`cp ${m}`);function d(n){function d(n){F?.();if(!s){Xe(e,t,n,r,o,u)}a?.();J(l)}if(Ke(n,m,d,(()=>{i?.();J(l)}))){return}d(n)}K(l);if(typeof n=="string"){He(n,d,i)}else{d(n)}};var qe=e=>{var t={r:0,"r+":2,w:512|64|1,"w+":512|64|2,a:1024|64|1,"a+":1024|64|2};var n=t[e];if(typeof n=="undefined"){throw new Error(`Unknown file open mode: ${e}`)}return n};var Qe=(e,t)=>{var n=0;if(e)n|=292|73;if(t)n|=146;return n};var Ze=e=>ve(Dn(e));var et={EPERM:63,ENOENT:44,ESRCH:71,EINTR:27,EIO:29,ENXIO:60,E2BIG:1,ENOEXEC:45,EBADF:8,ECHILD:12,EAGAIN:6,EWOULDBLOCK:6,ENOMEM:48,EACCES:2,EFAULT:21,ENOTBLK:105,EBUSY:10,EEXIST:20,EXDEV:75,ENODEV:43,ENOTDIR:54,EISDIR:31,EINVAL:28,ENFILE:41,EMFILE:33,ENOTTY:59,ETXTBSY:74,EFBIG:22,ENOSPC:51,ESPIPE:70,EROFS:69,EMLINK:34,EPIPE:64,EDOM:18,ERANGE:68,ENOMSG:49,EIDRM:24,ECHRNG:106,EL2NSYNC:156,EL3HLT:107,EL3RST:108,ELNRNG:109,EUNATCH:110,ENOCSI:111,EL2HLT:112,EDEADLK:16,ENOLCK:46,EBADE:113,EBADR:114,EXFULL:115,ENOANO:104,EBADRQC:103,EBADSLT:102,EDEADLOCK:16,EBFONT:101,ENOSTR:100,ENODATA:116,ETIME:117,ENOSR:118,ENONET:119,ENOPKG:120,EREMOTE:121,ENOLINK:47,EADV:122,ESRMNT:123,ECOMM:124,EPROTO:65,EMULTIHOP:36,EDOTDOT:125,EBADMSG:9,ENOTUNIQ:126,EBADFD:127,EREMCHG:128,ELIBACC:129,ELIBBAD:130,ELIBSCN:131,ELIBMAX:132,ELIBEXEC:133,ENOSYS:52,ENOTEMPTY:55,ENAMETOOLONG:37,ELOOP:32,EOPNOTSUPP:138,EPFNOSUPPORT:139,ECONNRESET:15,ENOBUFS:42,EAFNOSUPPORT:5,EPROTOTYPE:67,ENOTSOCK:57,ENOPROTOOPT:50,ESHUTDOWN:140,ECONNREFUSED:14,EADDRINUSE:3,ECONNABORTED:13,ENETUNREACH:40,ENETDOWN:38,ETIMEDOUT:73,EHOSTDOWN:142,EHOSTUNREACH:23,EINPROGRESS:26,EALREADY:7,EDESTADDRREQ:17,EMSGSIZE:35,EPROTONOSUPPORT:66,ESOCKTNOSUPPORT:137,EADDRNOTAVAIL:4,ENETRESET:39,EISCONN:30,ENOTCONN:53,ETOOMANYREFS:141,EUSERS:136,EDQUOT:19,ESTALE:72,ENOTSUP:138,ENOMEDIUM:148,EILSEQ:25,EOVERFLOW:61,ECANCELED:11,ENOTRECOVERABLE:56,EOWNERDEAD:62,ESTRPIPE:135};var tt={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:false,ignorePermissions:true,ErrnoError:class extends Error{constructor(e){super(j?Ze(e):"");this.name="ErrnoError";this.errno=e;for(var t in et){if(et[t]===e){this.code=t;break}}}},genericErrors:{},filesystems:null,syncFSRequests:0,readFiles:{},FSStream:class{constructor(){this.shared={}}get object(){return this.node}set object(e){this.node=e}get isRead(){return(this.flags&2097155)!==1}get isWrite(){return(this.flags&2097155)!==0}get isAppend(){return this.flags&1024}get flags(){return this.shared.flags}set flags(e){this.shared.flags=e}get position(){return this.shared.position}set position(e){this.shared.position=e}},FSNode:class{constructor(e,t,n,r){if(!e){e=this}this.parent=e;this.mount=e.mount;this.mounted=null;this.id=tt.nextInode++;this.name=t;this.mode=n;this.node_ops={};this.stream_ops={};this.rdev=r;this.readMode=292|73;this.writeMode=146}get read(){return(this.mode&this.readMode)===this.readMode}set read(e){e?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(e){e?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return tt.isDir(this.mode)}get isDevice(){return tt.isChrdev(this.mode)}},lookupPath(e,t={}){e=Ie.resolve(e);if(!e)return{path:"",node:null};var n={follow_mount:true,recurse_count:0};t=Object.assign(n,t);if(t.recurse_count>8){throw new tt.ErrnoError(32)}var r=e.split("/").filter((e=>!!e));var o=tt.root;var a="/";for(var i=0;i<r.length;i++){var s=i===r.length-1;if(s&&t.parent){break}o=tt.lookupNode(o,r[i]);a=xe.join2(a,r[i]);if(tt.isMountpoint(o)){if(!s||s&&t.follow_mount){o=o.mounted.root}}if(!s||t.follow){var u=0;while(tt.isLink(o.mode)){var F=tt.readlink(a);a=Ie.resolve(xe.dirname(a),F);var m=tt.lookupPath(a,{recurse_count:t.recurse_count+1});o=m.node;if(u++>40){throw new tt.ErrnoError(32)}}}}return{path:a,node:o}},getPath(e){var t;while(true){if(tt.isRoot(e)){var n=e.mount.mountpoint;if(!t)return n;return n[n.length-1]!=="/"?`${n}/${t}`:n+t}t=t?`${e.name}/${t}`:e.name;e=e.parent}},hashName(e,t){var n=0;for(var r=0;r<t.length;r++){n=(n<<5)-n+t.charCodeAt(r)|0}return(e+n>>>0)%tt.nameTable.length},hashAddNode(e){var t=tt.hashName(e.parent.id,e.name);e.name_next=tt.nameTable[t];tt.nameTable[t]=e},hashRemoveNode(e){var t=tt.hashName(e.parent.id,e.name);if(tt.nameTable[t]===e){tt.nameTable[t]=e.name_next}else{var n=tt.nameTable[t];while(n){if(n.name_next===e){n.name_next=e.name_next;break}n=n.name_next}}},lookupNode(e,t){var n=tt.mayLookup(e);if(n){throw new tt.ErrnoError(n)}var r=tt.hashName(e.id,t);for(var o=tt.nameTable[r];o;o=o.name_next){var a=o.name;if(o.parent.id===e.id&&a===t){return o}}return tt.lookup(e,t)},createNode(e,t,n,r){A(typeof e=="object");var o=new tt.FSNode(e,t,n,r);tt.hashAddNode(o);return o},destroyNode(e){tt.hashRemoveNode(e)},isRoot(e){return e===e.parent},isMountpoint(e){return!!e.mounted},isFile(e){return(e&61440)===32768},isDir(e){return(e&61440)===16384},isLink(e){return(e&61440)===40960},isChrdev(e){return(e&61440)===8192},isBlkdev(e){return(e&61440)===24576},isFIFO(e){return(e&61440)===4096},isSocket(e){return(e&49152)===49152},flagsToPermissionString(e){var t=["r","w","rw"][e&3];if(e&512){t+="w"}return t},nodePermissions(e,t){if(tt.ignorePermissions){return 0}if(t.includes("r")&&!(e.mode&292)){return 2}else if(t.includes("w")&&!(e.mode&146)){return 2}else if(t.includes("x")&&!(e.mode&73)){return 2}return 0},mayLookup(e){if(!tt.isDir(e.mode))return 54;var t=tt.nodePermissions(e,"x");if(t)return t;if(!e.node_ops.lookup)return 2;return 0},mayCreate(e,t){try{var n=tt.lookupNode(e,t);return 20}catch(e){}return tt.nodePermissions(e,"wx")},mayDelete(e,t,n){var r;try{r=tt.lookupNode(e,t)}catch(e){return e.errno}var o=tt.nodePermissions(e,"wx");if(o){return o}if(n){if(!tt.isDir(r.mode)){return 54}if(tt.isRoot(r)||tt.getPath(r)===tt.cwd()){return 10}}else{if(tt.isDir(r.mode)){return 31}}return 0},mayOpen(e,t){if(!e){return 44}if(tt.isLink(e.mode)){return 32}else if(tt.isDir(e.mode)){if(tt.flagsToPermissionString(t)!=="r"||t&512){return 31}}return tt.nodePermissions(e,tt.flagsToPermissionString(t))},MAX_OPEN_FDS:4096,nextfd(){for(var e=0;e<=tt.MAX_OPEN_FDS;e++){if(!tt.streams[e]){return e}}throw new tt.ErrnoError(33)},getStreamChecked(e){var t=tt.getStream(e);if(!t){throw new tt.ErrnoError(8)}return t},getStream:e=>tt.streams[e],createStream(e,t=-1){A(t>=-1);e=Object.assign(new tt.FSStream,e);if(t==-1){t=tt.nextfd()}e.fd=t;tt.streams[t]=e;return e},closeStream(e){tt.streams[e]=null},dupStream(e,t=-1){var n=tt.createStream(e,t);n.stream_ops?.dup?.(n);return n},chrdev_stream_ops:{open(e){var t=tt.getDevice(e.node.rdev);e.stream_ops=t.stream_ops;e.stream_ops.open?.(e)},llseek(){throw new tt.ErrnoError(70)}},major:e=>e>>8,minor:e=>e&255,makedev:(e,t)=>e<<8|t,registerDevice(e,t){tt.devices[e]={stream_ops:t}},getDevice:e=>tt.devices[e],getMounts(e){var t=[];var n=[e];while(n.length){var r=n.pop();t.push(r);n.push(...r.mounts)}return t},syncfs(e,t){if(typeof e=="function"){t=e;e=false}tt.syncFSRequests++;if(tt.syncFSRequests>1){f(`warning: ${tt.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`)}var n=tt.getMounts(tt.root.mount);var r=0;function o(e){A(tt.syncFSRequests>0);tt.syncFSRequests--;return t(e)}function a(e){if(e){if(!a.errored){a.errored=true;return o(e)}return}if(++r>=n.length){o(null)}}n.forEach((t=>{if(!t.type.syncfs){return a(null)}t.type.syncfs(t,e,a)}))},mount(e,t,n){if(typeof e=="string"){throw e}var r=n==="/";var o=!n;var a;if(r&&tt.root){throw new tt.ErrnoError(10)}else if(!r&&!o){var i=tt.lookupPath(n,{follow_mount:false});n=i.path;a=i.node;if(tt.isMountpoint(a)){throw new tt.ErrnoError(10)}if(!tt.isDir(a.mode)){throw new tt.ErrnoError(54)}}var s={type:e,opts:t,mountpoint:n,mounts:[]};var u=e.mount(s);u.mount=s;s.root=u;if(r){tt.root=u}else if(a){a.mounted=s;if(a.mount){a.mount.mounts.push(s)}}return u},unmount(e){var t=tt.lookupPath(e,{follow_mount:false});if(!tt.isMountpoint(t.node)){throw new tt.ErrnoError(28)}var n=t.node;var r=n.mounted;var o=tt.getMounts(r);Object.keys(tt.nameTable).forEach((e=>{var t=tt.nameTable[e];while(t){var n=t.name_next;if(o.includes(t.mount)){tt.destroyNode(t)}t=n}}));n.mounted=null;var a=n.mount.mounts.indexOf(r);A(a!==-1);n.mount.mounts.splice(a,1)},lookup(e,t){return e.node_ops.lookup(e,t)},mknod(e,t,n){var r=tt.lookupPath(e,{parent:true});var o=r.node;var a=xe.basename(e);if(!a||a==="."||a===".."){throw new tt.ErrnoError(28)}var i=tt.mayCreate(o,a);if(i){throw new tt.ErrnoError(i)}if(!o.node_ops.mknod){throw new tt.ErrnoError(63)}return o.node_ops.mknod(o,a,t,n)},create(e,t){t=t!==undefined?t:438;t&=4095;t|=32768;return tt.mknod(e,t,0)},mkdir(e,t){t=t!==undefined?t:511;t&=511|512;t|=16384;return tt.mknod(e,t,0)},mkdirTree(e,t){var n=e.split("/");var r="";for(var o=0;o<n.length;++o){if(!n[o])continue;r+="/"+n[o];try{tt.mkdir(r,t)}catch(e){if(e.errno!=20)throw e}}},mkdev(e,t,n){if(typeof n=="undefined"){n=t;t=438}t|=8192;return tt.mknod(e,t,n)},symlink(e,t){if(!Ie.resolve(e)){throw new tt.ErrnoError(44)}var n=tt.lookupPath(t,{parent:true});var r=n.node;if(!r){throw new tt.ErrnoError(44)}var o=xe.basename(t);var a=tt.mayCreate(r,o);if(a){throw new tt.ErrnoError(a)}if(!r.node_ops.symlink){throw new tt.ErrnoError(63)}return r.node_ops.symlink(r,o,e)},rename(e,t){var n=xe.dirname(e);var r=xe.dirname(t);var o=xe.basename(e);var a=xe.basename(t);var i,s,u;i=tt.lookupPath(e,{parent:true});s=i.node;i=tt.lookupPath(t,{parent:true});u=i.node;if(!s||!u)throw new tt.ErrnoError(44);if(s.mount!==u.mount){throw new tt.ErrnoError(75)}var F=tt.lookupNode(s,o);var m=Ie.relative(e,r);if(m.charAt(0)!=="."){throw new tt.ErrnoError(28)}m=Ie.relative(t,n);if(m.charAt(0)!=="."){throw new tt.ErrnoError(55)}var l;try{l=tt.lookupNode(u,a)}catch(e){}if(F===l){return}var d=tt.isDir(F.mode);var c=tt.mayDelete(s,o,d);if(c){throw new tt.ErrnoError(c)}c=l?tt.mayDelete(u,a,d):tt.mayCreate(u,a);if(c){throw new tt.ErrnoError(c)}if(!s.node_ops.rename){throw new tt.ErrnoError(63)}if(tt.isMountpoint(F)||l&&tt.isMountpoint(l)){throw new tt.ErrnoError(10)}if(u!==s){c=tt.nodePermissions(s,"w");if(c){throw new tt.ErrnoError(c)}}tt.hashRemoveNode(F);try{s.node_ops.rename(F,u,a);F.parent=u}catch(e){throw e}finally{tt.hashAddNode(F)}},rmdir(e){var t=tt.lookupPath(e,{parent:true});var n=t.node;var r=xe.basename(e);var o=tt.lookupNode(n,r);var a=tt.mayDelete(n,r,true);if(a){throw new tt.ErrnoError(a)}if(!n.node_ops.rmdir){throw new tt.ErrnoError(63)}if(tt.isMountpoint(o)){throw new tt.ErrnoError(10)}n.node_ops.rmdir(n,r);tt.destroyNode(o)},readdir(e){var t=tt.lookupPath(e,{follow:true});var n=t.node;if(!n.node_ops.readdir){throw new tt.ErrnoError(54)}return n.node_ops.readdir(n)},unlink(e){var t=tt.lookupPath(e,{parent:true});var n=t.node;if(!n){throw new tt.ErrnoError(44)}var r=xe.basename(e);var o=tt.lookupNode(n,r);var a=tt.mayDelete(n,r,false);if(a){throw new tt.ErrnoError(a)}if(!n.node_ops.unlink){throw new tt.ErrnoError(63)}if(tt.isMountpoint(o)){throw new tt.ErrnoError(10)}n.node_ops.unlink(n,r);tt.destroyNode(o)},readlink(e){var t=tt.lookupPath(e);var n=t.node;if(!n){throw new tt.ErrnoError(44)}if(!n.node_ops.readlink){throw new tt.ErrnoError(28)}return Ie.resolve(tt.getPath(n.parent),n.node_ops.readlink(n))},stat(e,t){var n=tt.lookupPath(e,{follow:!t});var r=n.node;if(!r){throw new tt.ErrnoError(44)}if(!r.node_ops.getattr){throw new tt.ErrnoError(63)}return r.node_ops.getattr(r)},lstat(e){return tt.stat(e,true)},chmod(e,t,n){var r;if(typeof e=="string"){var o=tt.lookupPath(e,{follow:!n});r=o.node}else{r=e}if(!r.node_ops.setattr){throw new tt.ErrnoError(63)}r.node_ops.setattr(r,{mode:t&4095|r.mode&~4095,timestamp:Date.now()})},lchmod(e,t){tt.chmod(e,t,true)},fchmod(e,t){var n=tt.getStreamChecked(e);tt.chmod(n.node,t)},chown(e,t,n,r){var o;if(typeof e=="string"){var a=tt.lookupPath(e,{follow:!r});o=a.node}else{o=e}if(!o.node_ops.setattr){throw new tt.ErrnoError(63)}o.node_ops.setattr(o,{timestamp:Date.now()})},lchown(e,t,n){tt.chown(e,t,n,true)},fchown(e,t,n){var r=tt.getStreamChecked(e);tt.chown(r.node,t,n)},truncate(e,t){if(t<0){throw new tt.ErrnoError(28)}var n;if(typeof e=="string"){var r=tt.lookupPath(e,{follow:true});n=r.node}else{n=e}if(!n.node_ops.setattr){throw new tt.ErrnoError(63)}if(tt.isDir(n.mode)){throw new tt.ErrnoError(31)}if(!tt.isFile(n.mode)){throw new tt.ErrnoError(28)}var o=tt.nodePermissions(n,"w");if(o){throw new tt.ErrnoError(o)}n.node_ops.setattr(n,{size:t,timestamp:Date.now()})},ftruncate(e,t){var n=tt.getStreamChecked(e);if((n.flags&2097155)===0){throw new tt.ErrnoError(28)}tt.truncate(n.node,t)},utime(e,t,n){var r=tt.lookupPath(e,{follow:true});var o=r.node;o.node_ops.setattr(o,{timestamp:Math.max(t,n)})},open(e,t,n){if(e===""){throw new tt.ErrnoError(44)}t=typeof t=="string"?qe(t):t;if(t&64){n=typeof n=="undefined"?438:n;n=n&4095|32768}else{n=0}var o;if(typeof e=="object"){o=e}else{e=xe.normalize(e);try{var a=tt.lookupPath(e,{follow:!(t&131072)});o=a.node}catch(e){}}var i=false;if(t&64){if(o){if(t&128){throw new tt.ErrnoError(20)}}else{o=tt.mknod(e,n,0);i=true}}if(!o){throw new tt.ErrnoError(44)}if(tt.isChrdev(o.mode)){t&=~512}if(t&65536&&!tt.isDir(o.mode)){throw new tt.ErrnoError(54)}if(!i){var s=tt.mayOpen(o,t);if(s){throw new tt.ErrnoError(s)}}if(t&512&&!i){tt.truncate(o,0)}t&=~(128|512|131072);var u=tt.createStream({node:o,path:tt.getPath(o),flags:t,seekable:true,position:0,stream_ops:o.stream_ops,ungotten:[],error:false});if(u.stream_ops.open){u.stream_ops.open(u)}if(r["logReadFiles"]&&!(t&1)){if(!(e in tt.readFiles)){tt.readFiles[e]=1}}return u},close(e){if(tt.isClosed(e)){throw new tt.ErrnoError(8)}if(e.getdents)e.getdents=null;try{if(e.stream_ops.close){e.stream_ops.close(e)}}catch(e){throw e}finally{tt.closeStream(e.fd)}e.fd=null},isClosed(e){return e.fd===null},llseek(e,t,n){if(tt.isClosed(e)){throw new tt.ErrnoError(8)}if(!e.seekable||!e.stream_ops.llseek){throw new tt.ErrnoError(70)}if(n!=0&&n!=1&&n!=2){throw new tt.ErrnoError(28)}e.position=e.stream_ops.llseek(e,t,n);e.ungotten=[];return e.position},read(e,t,n,r,o){A(n>=0);if(r<0||o<0){throw new tt.ErrnoError(28)}if(tt.isClosed(e)){throw new tt.ErrnoError(8)}if((e.flags&2097155)===1){throw new tt.ErrnoError(8)}if(tt.isDir(e.node.mode)){throw new tt.ErrnoError(31)}if(!e.stream_ops.read){throw new tt.ErrnoError(28)}var a=typeof o!="undefined";if(!a){o=e.position}else if(!e.seekable){throw new tt.ErrnoError(70)}var i=e.stream_ops.read(e,t,n,r,o);if(!a)e.position+=i;return i},write(e,t,n,r,o,a){A(n>=0);if(r<0||o<0){throw new tt.ErrnoError(28)}if(tt.isClosed(e)){throw new tt.ErrnoError(8)}if((e.flags&2097155)===0){throw new tt.ErrnoError(8)}if(tt.isDir(e.node.mode)){throw new tt.ErrnoError(31)}if(!e.stream_ops.write){throw new tt.ErrnoError(28)}if(e.seekable&&e.flags&1024){tt.llseek(e,0,2)}var i=typeof o!="undefined";if(!i){o=e.position}else if(!e.seekable){throw new tt.ErrnoError(70)}var s=e.stream_ops.write(e,t,n,r,o,a);if(!i)e.position+=s;return s},allocate(e,t,n){if(tt.isClosed(e)){throw new tt.ErrnoError(8)}if(t<0||n<=0){throw new tt.ErrnoError(28)}if((e.flags&2097155)===0){throw new tt.ErrnoError(8)}if(!tt.isFile(e.node.mode)&&!tt.isDir(e.node.mode)){throw new tt.ErrnoError(43)}if(!e.stream_ops.allocate){throw new tt.ErrnoError(138)}e.stream_ops.allocate(e,t,n)},mmap(e,t,n,r,o){if((r&2)!==0&&(o&2)===0&&(e.flags&2097155)!==2){throw new tt.ErrnoError(2)}if((e.flags&2097155)===1){throw new tt.ErrnoError(2)}if(!e.stream_ops.mmap){throw new tt.ErrnoError(43)}if(!t){throw new tt.ErrnoError(28)}return e.stream_ops.mmap(e,t,n,r,o)},msync(e,t,n,r,o){A(n>=0);if(!e.stream_ops.msync){return 0}return e.stream_ops.msync(e,t,n,r,o)},ioctl(e,t,n){if(!e.stream_ops.ioctl){throw new tt.ErrnoError(59)}return e.stream_ops.ioctl(e,t,n)},readFile(e,t={}){t.flags=t.flags||0;t.encoding=t.encoding||"binary";if(t.encoding!=="utf8"&&t.encoding!=="binary"){throw new Error(`Invalid encoding type "${t.encoding}"`)}var n;var r=tt.open(e,t.flags);var o=tt.stat(e);var a=o.size;var i=new Uint8Array(a);tt.read(r,i,0,a,0);if(t.encoding==="utf8"){n=Se(i)}else if(t.encoding==="binary"){n=i}tt.close(r);return n},writeFile(e,t,n={}){n.flags=n.flags||577;var r=tt.open(e,n.flags,n.mode);if(typeof t=="string"){var o=new Uint8Array(je(t)+1);var a=Be(t,o,0,o.length);tt.write(r,o,0,a,undefined,n.canOwn)}else if(ArrayBuffer.isView(t)){tt.write(r,t,0,t.byteLength,undefined,n.canOwn)}else{throw new Error("Unsupported data type")}tt.close(r)},cwd:()=>tt.currentPath,chdir(e){var t=tt.lookupPath(e,{follow:true});if(t.node===null){throw new tt.ErrnoError(44)}if(!tt.isDir(t.node.mode)){throw new tt.ErrnoError(54)}var n=tt.nodePermissions(t.node,"x");if(n){throw new tt.ErrnoError(n)}tt.currentPath=t.path},createDefaultDirectories(){tt.mkdir("/tmp");tt.mkdir("/home");tt.mkdir("/home/web_user")},createDefaultDevices(){tt.mkdir("/dev");tt.registerDevice(tt.makedev(1,3),{read:()=>0,write:(e,t,n,r,o)=>r});tt.mkdev("/dev/null",tt.makedev(1,3));Ve.register(tt.makedev(5,0),Ve.default_tty_ops);Ve.register(tt.makedev(6,0),Ve.default_tty1_ops);tt.mkdev("/dev/tty",tt.makedev(5,0));tt.mkdev("/dev/tty1",tt.makedev(6,0));var e=new Uint8Array(1024),t=0;var n=()=>{if(t===0){t=Re(e).byteLength}return e[--t]};tt.createDevice("/dev","random",n);tt.createDevice("/dev","urandom",n);tt.mkdir("/dev/shm");tt.mkdir("/dev/shm/tmp")},createSpecialDirectories(){tt.mkdir("/proc");var e=tt.mkdir("/proc/self");tt.mkdir("/proc/self/fd");tt.mount({mount(){var t=tt.createNode(e,"fd",16384|511,73);t.node_ops={lookup(e,t){var n=+t;var r=tt.getStreamChecked(n);var o={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>r.path}};o.parent=o;return o}};return t}},{},"/proc/self/fd")},createStandardStreams(e,t,n){if(e){tt.createDevice("/dev","stdin",e)}else{tt.symlink("/dev/tty","/dev/stdin")}if(t){tt.createDevice("/dev","stdout",null,t)}else{tt.symlink("/dev/tty","/dev/stdout")}if(n){tt.createDevice("/dev","stderr",null,n)}else{tt.symlink("/dev/tty1","/dev/stderr")}var r=tt.open("/dev/stdin",0);var o=tt.open("/dev/stdout",1);var a=tt.open("/dev/stderr",1);A(r.fd===0,`invalid handle for stdin (${r.fd})`);A(o.fd===1,`invalid handle for stdout (${o.fd})`);A(a.fd===2,`invalid handle for stderr (${a.fd})`)},staticInit(){[44].forEach((e=>{tt.genericErrors[e]=new tt.ErrnoError(e);tt.genericErrors[e].stack="<generic error, no stack>"}));tt.nameTable=new Array(4096);tt.mount($e,{},"/");tt.createDefaultDirectories();tt.createDefaultDevices();tt.createSpecialDirectories();tt.filesystems={MEMFS:$e}},init(e,t,n){A(!tt.initialized,"FS.init was previously called. If you want to initialize later with custom parameters, remove any earlier calls (note that one is automatically added to the generated code)");tt.initialized=true;e??=r["stdin"];t??=r["stdout"];n??=r["stderr"];tt.createStandardStreams(e,t,n)},quit(){tt.initialized=false;hn(0);for(var e=0;e<tt.streams.length;e++){var t=tt.streams[e];if(!t){continue}tt.close(t)}},findObject(e,t){var n=tt.analyzePath(e,t);if(!n.exists){return null}return n.object},analyzePath(e,t){try{var n=tt.lookupPath(e,{follow:!t});e=n.path}catch(e){}var r={isRoot:false,exists:false,error:0,name:null,path:null,object:null,parentExists:false,parentPath:null,parentObject:null};try{var n=tt.lookupPath(e,{parent:true});r.parentExists=true;r.parentPath=n.path;r.parentObject=n.node;r.name=xe.basename(e);n=tt.lookupPath(e,{follow:!t});r.exists=true;r.path=n.path;r.object=n.node;r.name=n.node.name;r.isRoot=n.path==="/"}catch(e){r.error=e.errno}return r},createPath(e,t,n,r){e=typeof e=="string"?e:tt.getPath(e);var o=t.split("/").reverse();while(o.length){var a=o.pop();if(!a)continue;var i=xe.join2(e,a);try{tt.mkdir(i)}catch(e){}e=i}return i},createFile(e,t,n,r,o){var a=xe.join2(typeof e=="string"?e:tt.getPath(e),t);var i=Qe(r,o);return tt.create(a,i)},createDataFile(e,t,n,r,o,a){var i=t;if(e){e=typeof e=="string"?e:tt.getPath(e);i=t?xe.join2(e,t):e}var s=Qe(r,o);var u=tt.create(i,s);if(n){if(typeof n=="string"){var F=new Array(n.length);for(var m=0,l=n.length;m<l;++m)F[m]=n.charCodeAt(m);n=F}tt.chmod(u,s|146);var d=tt.open(u,577);tt.write(d,n,0,n.length,0,a);tt.close(d);tt.chmod(u,s)}},createDevice(e,t,n,r){var o=xe.join2(typeof e=="string"?e:tt.getPath(e),t);var a=Qe(!!n,!!r);tt.createDevice.major??=64;var i=tt.makedev(tt.createDevice.major++,0);tt.registerDevice(i,{open(e){e.seekable=false},close(e){if(r?.buffer?.length){r(10)}},read(e,t,r,o,a){var i=0;for(var s=0;s<o;s++){var u;try{u=n()}catch(e){throw new tt.ErrnoError(29)}if(u===undefined&&i===0){throw new tt.ErrnoError(6)}if(u===null||u===undefined)break;i++;t[r+s]=u}if(i){e.node.timestamp=Date.now()}return i},write(e,t,n,o,a){for(var i=0;i<o;i++){try{r(t[n+i])}catch(e){throw new tt.ErrnoError(29)}}if(o){e.node.timestamp=Date.now()}return i}});return tt.mkdev(o,a,i)},forceLoadFile(e){if(e.isDevice||e.isFolder||e.link||e.contents)return true;if(typeof XMLHttpRequest!="undefined"){throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.")}else{try{e.contents=g(e.url);e.usedBytes=e.contents.length}catch(e){throw new tt.ErrnoError(29)}}},createLazyFile(e,t,n,r,o){class a{constructor(){this.lengthKnown=false;this.chunks=[]}get(e){if(e>this.length-1||e<0){return undefined}var t=e%this.chunkSize;var n=e/this.chunkSize|0;return this.getter(n)[t]}setDataGetter(e){this.getter=e}cacheLength(){var e=new XMLHttpRequest;e.open("HEAD",n,false);e.send(null);if(!(e.status>=200&&e.status<300||e.status===304))throw new Error("Couldn't load "+n+". Status: "+e.status);var t=Number(e.getResponseHeader("Content-length"));var r;var o=(r=e.getResponseHeader("Accept-Ranges"))&&r==="bytes";var a=(r=e.getResponseHeader("Content-Encoding"))&&r==="gzip";var i=1024*1024;if(!o)i=t;var s=(e,r)=>{if(e>r)throw new Error("invalid range ("+e+", "+r+") or no bytes requested!");if(r>t-1)throw new Error("only "+t+" bytes available! programmer error!");var o=new XMLHttpRequest;o.open("GET",n,false);if(t!==i)o.setRequestHeader("Range","bytes="+e+"-"+r);o.responseType="arraybuffer";if(o.overrideMimeType){o.overrideMimeType("text/plain; charset=x-user-defined")}o.send(null);if(!(o.status>=200&&o.status<300||o.status===304))throw new Error("Couldn't load "+n+". Status: "+o.status);if(o.response!==undefined){return new Uint8Array(o.response||[])}return Le(o.responseText||"",true)};var u=this;u.setDataGetter((e=>{var n=e*i;var r=(e+1)*i-1;r=Math.min(r,t-1);if(typeof u.chunks[e]=="undefined"){u.chunks[e]=s(n,r)}if(typeof u.chunks[e]=="undefined")throw new Error("doXHR failed!");return u.chunks[e]}));if(a||!t){i=t=1;t=this.getter(0).length;i=t;h("LazyFiles on gzip forces download of the whole file when length is accessed")}this._length=t;this._chunkSize=i;this.lengthKnown=true}get length(){if(!this.lengthKnown){this.cacheLength()}return this._length}get chunkSize(){if(!this.lengthKnown){this.cacheLength()}return this._chunkSize}}if(typeof XMLHttpRequest!="undefined"){if(!u)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var i=new a;var s={isDevice:false,contents:i}}else{var s={isDevice:false,url:n}}var F=tt.createFile(e,t,s,r,o);if(s.contents){F.contents=s.contents}else if(s.url){F.contents=null;F.url=s.url}Object.defineProperties(F,{usedBytes:{get:function(){return this.contents.length}}});var m={};var l=Object.keys(F.stream_ops);l.forEach((e=>{var t=F.stream_ops[e];m[e]=(...e)=>{tt.forceLoadFile(F);return t(...e)}}));function d(e,t,n,r,o){var a=e.node.contents;if(o>=a.length)return 0;var i=Math.min(a.length-o,r);A(i>=0);if(a.slice){for(var s=0;s<i;s++){t[n+s]=a[o+s]}}else{for(var s=0;s<i;s++){t[n+s]=a.get(o+s)}}return i}m.read=(e,t,n,r,o)=>{tt.forceLoadFile(F);return d(e,t,n,r,o)};m.mmap=(e,t,n,r,o)=>{tt.forceLoadFile(F);var a=ze(t);if(!a){throw new tt.ErrnoError(48)}d(e,y,a,t,n);return{ptr:a,allocated:true}};F.stream_ops=m;return F},absolutePath(){q("FS.absolutePath has been removed; use PATH_FS.resolve instead")},createFolder(){q("FS.createFolder has been removed; use FS.mkdir instead")},createLink(){q("FS.createLink has been removed; use FS.symlink instead")},joinPath(){q("FS.joinPath has been removed; use PATH.join instead")},mmapAlloc(){q("FS.mmapAlloc has been replaced by the top level function mmapAlloc")},standardizePath(){q("FS.standardizePath has been removed; use PATH.normalize instead")}};var nt={DEFAULT_POLLMASK:5,calculateAt(e,t,n){if(xe.isAbs(t)){return t}var r;if(e===-100){r=tt.cwd()}else{var o=nt.getStreamFromFD(e);r=o.path}if(t.length==0){if(!n){throw new tt.ErrnoError(44)}return r}return xe.join2(r,t)},doStat(e,t,n){var r=e(t);S[n>>2]=r.dev;S[n+4>>2]=r.mode;v[n+8>>2]=r.nlink;S[n+12>>2]=r.uid;S[n+16>>2]=r.gid;S[n+20>>2]=r.rdev;le=[r.size>>>0,(me=r.size,+Math.abs(me)>=1?me>0?+Math.floor(me/4294967296)>>>0:~~+Math.ceil((me-+(~~me>>>0))/4294967296)>>>0:0)],S[n+24>>2]=le[0],S[n+28>>2]=le[1];S[n+32>>2]=4096;S[n+36>>2]=r.blocks;var o=r.atime.getTime();var a=r.mtime.getTime();var i=r.ctime.getTime();le=[Math.floor(o/1e3)>>>0,(me=Math.floor(o/1e3),+Math.abs(me)>=1?me>0?+Math.floor(me/4294967296)>>>0:~~+Math.ceil((me-+(~~me>>>0))/4294967296)>>>0:0)],S[n+40>>2]=le[0],S[n+44>>2]=le[1];v[n+48>>2]=o%1e3*1e3*1e3;le=[Math.floor(a/1e3)>>>0,(me=Math.floor(a/1e3),+Math.abs(me)>=1?me>0?+Math.floor(me/4294967296)>>>0:~~+Math.ceil((me-+(~~me>>>0))/4294967296)>>>0:0)],S[n+56>>2]=le[0],S[n+60>>2]=le[1];v[n+64>>2]=a%1e3*1e3*1e3;le=[Math.floor(i/1e3)>>>0,(me=Math.floor(i/1e3),+Math.abs(me)>=1?me>0?+Math.floor(me/4294967296)>>>0:~~+Math.ceil((me-+(~~me>>>0))/4294967296)>>>0:0)],S[n+72>>2]=le[0],S[n+76>>2]=le[1];v[n+80>>2]=i%1e3*1e3*1e3;le=[r.ino>>>0,(me=r.ino,+Math.abs(me)>=1?me>0?+Math.floor(me/4294967296)>>>0:~~+Math.ceil((me-+(~~me>>>0))/4294967296)>>>0:0)],S[n+88>>2]=le[0],S[n+92>>2]=le[1];return 0},doMsync(e,t,n,r,o){if(!tt.isFile(t.node.mode)){throw new tt.ErrnoError(43)}if(r&2){return 0}var a=M.slice(e,e+n);tt.msync(t,a,o,n,r)},getStreamFromFD(e){var t=tt.getStreamChecked(e);return t},varargs:undefined,getStr(e){var t=ve(e);return t}};function rt(e,t,n){nt.varargs=n;try{var r=nt.getStreamFromFD(e);switch(t){case 0:{var o=Te();if(o<0){return-28}while(tt.streams[o]){o++}var a;a=tt.dupStream(r,o);return a.fd}case 1:case 2:return 0;case 3:return r.flags;case 4:{var o=Te();r.flags|=o;return 0}case 12:{var o=Oe();var i=0;E[o+i>>1]=2;return 0}case 13:case 14:return 0}return-28}catch(e){if(typeof tt=="undefined"||!(e.name==="ErrnoError"))throw e;return-e.errno}}function ot(e,t){try{var n=nt.getStreamFromFD(e);return nt.doStat(tt.stat,n.path,t)}catch(e){if(typeof tt=="undefined"||!(e.name==="ErrnoError"))throw e;return-e.errno}}var at=(e,t)=>{A(e==e>>>0||e==(e|0));A(t===(t|0));return t+2097152>>>0<4194305-!!e?(e>>>0)+t*4294967296:NaN};function it(e,t,n){var r=at(t,n);try{if(isNaN(r))return 61;tt.ftruncate(e,r);return 0}catch(e){if(typeof tt=="undefined"||!(e.name==="ErrnoError"))throw e;return-e.errno}}var st=(e,t,n)=>{A(typeof n=="number","stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!");return Be(e,M,t,n)};function ut(e,t,n){try{var r=nt.getStreamFromFD(e);r.getdents||=tt.readdir(r.path);var o=280;var a=0;var i=tt.llseek(r,0,1);var s=Math.floor(i/o);while(s<r.getdents.length&&a+o<=n){var u;var F;var m=r.getdents[s];if(m==="."){u=r.node.id;F=4}else if(m===".."){var l=tt.lookupPath(r.path,{parent:true});u=l.node.id;F=4}else{var d=tt.lookupNode(r.node,m);u=d.id;F=tt.isChrdev(d.mode)?2:tt.isDir(d.mode)?4:tt.isLink(d.mode)?10:8}A(u);le=[u>>>0,(me=u,+Math.abs(me)>=1?me>0?+Math.floor(me/4294967296)>>>0:~~+Math.ceil((me-+(~~me>>>0))/4294967296)>>>0:0)],S[t+a>>2]=le[0],S[t+a+4>>2]=le[1];le=[(s+1)*o>>>0,(me=(s+1)*o,+Math.abs(me)>=1?me>0?+Math.floor(me/4294967296)>>>0:~~+Math.ceil((me-+(~~me>>>0))/4294967296)>>>0:0)],S[t+a+8>>2]=le[0],S[t+a+12>>2]=le[1];E[t+a+16>>1]=280;y[t+a+18]=F;st(m,t+a+19,256);a+=o;s+=1}tt.llseek(r,s*o,0);return a}catch(e){if(typeof tt=="undefined"||!(e.name==="ErrnoError"))throw e;return-e.errno}}function Ft(e,t,n){nt.varargs=n;try{var r=nt.getStreamFromFD(e);switch(t){case 21509:{if(!r.tty)return-59;return 0}case 21505:{if(!r.tty)return-59;if(r.tty.ops.ioctl_tcgets){var o=r.tty.ops.ioctl_tcgets(r);var a=Oe();S[a>>2]=o.c_iflag||0;S[a+4>>2]=o.c_oflag||0;S[a+8>>2]=o.c_cflag||0;S[a+12>>2]=o.c_lflag||0;for(var i=0;i<32;i++){y[a+i+17]=o.c_cc[i]||0}return 0}return 0}case 21510:case 21511:case 21512:{if(!r.tty)return-59;return 0}case 21506:case 21507:case 21508:{if(!r.tty)return-59;if(r.tty.ops.ioctl_tcsets){var a=Oe();var s=S[a>>2];var u=S[a+4>>2];var F=S[a+8>>2];var m=S[a+12>>2];var l=[];for(var i=0;i<32;i++){l.push(y[a+i+17])}return r.tty.ops.ioctl_tcsets(r.tty,t,{c_iflag:s,c_oflag:u,c_cflag:F,c_lflag:m,c_cc:l})}return 0}case 21519:{if(!r.tty)return-59;var a=Oe();S[a>>2]=0;return 0}case 21520:{if(!r.tty)return-59;return-28}case 21531:{var a=Oe();return tt.ioctl(r,t,a)}case 21523:{if(!r.tty)return-59;if(r.tty.ops.ioctl_tiocgwinsz){var d=r.tty.ops.ioctl_tiocgwinsz(r.tty);var a=Oe();E[a>>1]=d[0];E[a+2>>1]=d[1]}return 0}case 21524:{if(!r.tty)return-59;return 0}case 21515:{if(!r.tty)return-59;return 0}default:return-28}}catch(e){if(typeof tt=="undefined"||!(e.name==="ErrnoError"))throw e;return-e.errno}}function mt(e,t){try{e=nt.getStr(e);return nt.doStat(tt.lstat,e,t)}catch(e){if(typeof tt=="undefined"||!(e.name==="ErrnoError"))throw e;return-e.errno}}function lt(e,t,n,r){try{t=nt.getStr(t);var o=r&256;var a=r&4096;r=r&~6400;A(!r,`unknown flags in __syscall_newfstatat: ${r}`);t=nt.calculateAt(e,t,a);return nt.doStat(o?tt.lstat:tt.stat,t,n)}catch(e){if(typeof tt=="undefined"||!(e.name==="ErrnoError"))throw e;return-e.errno}}function dt(e,t,n,r){nt.varargs=r;try{t=nt.getStr(t);t=nt.calculateAt(e,t);var o=r?Te():0;return tt.open(t,n,o).fd}catch(e){if(typeof tt=="undefined"||!(e.name==="ErrnoError"))throw e;return-e.errno}}function ct(e){try{e=nt.getStr(e);tt.rmdir(e);return 0}catch(e){if(typeof tt=="undefined"||!(e.name==="ErrnoError"))throw e;return-e.errno}}function _t(e,t){try{e=nt.getStr(e);return nt.doStat(tt.stat,e,t)}catch(e){if(typeof tt=="undefined"||!(e.name==="ErrnoError"))throw e;return-e.errno}}function Pt(e,t,n){try{t=nt.getStr(t);t=nt.calculateAt(e,t);if(n===0){tt.unlink(t)}else if(n===512){tt.rmdir(t)}else{q("Invalid flags passed to unlinkat")}return 0}catch(e){if(typeof tt=="undefined"||!(e.name==="ErrnoError"))throw e;return-e.errno}}var gt=()=>{q("native code called abort()")};var ht=(e,t,n)=>M.copyWithin(e,t,t+n);var ft=()=>{throw Infinity};function Dt(e,t,n){var r=at(e,t);var o=new Date(r*1e3);S[n>>2]=o.getUTCSeconds();S[n+4>>2]=o.getUTCMinutes();S[n+8>>2]=o.getUTCHours();S[n+12>>2]=o.getUTCDate();S[n+16>>2]=o.getUTCMonth();S[n+20>>2]=o.getUTCFullYear()-1900;S[n+24>>2]=o.getUTCDay();var a=Date.UTC(o.getUTCFullYear(),0,1,0,0,0,0);var i=(o.getTime()-a)/(1e3*60*60*24)|0;S[n+28>>2]=i}var bt=e=>e%4===0&&(e%100!==0||e%400===0);var pt=[0,31,60,91,121,152,182,213,244,274,305,335];var At=[0,31,59,90,120,151,181,212,243,273,304,334];var yt=e=>{var t=bt(e.getFullYear());var n=t?pt:At;var r=n[e.getMonth()]+e.getDate()-1;return r};function Mt(e,t,n){var r=at(e,t);var o=new Date(r*1e3);S[n>>2]=o.getSeconds();S[n+4>>2]=o.getMinutes();S[n+8>>2]=o.getHours();S[n+12>>2]=o.getDate();S[n+16>>2]=o.getMonth();S[n+20>>2]=o.getFullYear()-1900;S[n+24>>2]=o.getDay();var a=yt(o)|0;S[n+28>>2]=a;S[n+36>>2]=-(o.getTimezoneOffset()*60);var i=new Date(o.getFullYear(),0,1);var s=new Date(o.getFullYear(),6,1).getTimezoneOffset();var u=i.getTimezoneOffset();var F=(s!=u&&o.getTimezoneOffset()==Math.min(u,s))|0;S[n+32>>2]=F}var Et=(e,t,n,r)=>{var o=(new Date).getFullYear();var a=new Date(o,0,1);var i=new Date(o,6,1);var s=a.getTimezoneOffset();var u=i.getTimezoneOffset();var F=Math.max(s,u);v[e>>2]=F*60;S[t>>2]=Number(s!=u);var m=e=>{var t=e>=0?"-":"+";var n=Math.abs(e);var r=String(Math.floor(n/60)).padStart(2,"0");var o=String(n%60).padStart(2,"0");return`UTC${t}${r}${o}`};var l=m(s);var d=m(u);A(l);A(d);A(je(l)<=16,`timezone name truncated to fit in TZNAME_MAX (${l})`);A(je(d)<=16,`timezone name truncated to fit in TZNAME_MAX (${d})`);if(u<s){st(l,n,17);st(d,r,17)}else{st(l,r,17);st(d,n,17)}};var Gt=()=>Date.now();var St=()=>2147483648;var vt=e=>{var t=b.buffer;var n=(e-t.byteLength+65535)/65536|0;try{b.grow(n);O();return 1}catch(n){f(`growMemory: Attempted to grow heap from ${t.byteLength} bytes to ${e} bytes, but got error: ${n}`)}};var Ct=e=>{var t=M.length;e>>>=0;A(e>t);var n=St();if(e>n){f(`Cannot enlarge memory, requested ${e} bytes, but the limit is ${n} bytes!`);return false}for(var r=1;r<=4;r*=2){var o=t*(1+.2/r);o=Math.min(o,e+100663296);var a=Math.min(n,We(Math.max(e,o),65536));var i=vt(a);if(i){return true}}f(`Failed to grow the heap from ${t} bytes to ${a} bytes, not enough memory!`);return false};var Tt={};var Ot=()=>d||"./this.program";var xt=()=>{if(!xt.strings){var e=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8";var t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:Ot()};for(var n in Tt){if(Tt[n]===undefined)delete t[n];else t[n]=Tt[n]}var r=[];for(var n in t){r.push(`${n}=${t[n]}`)}xt.strings=r}return xt.strings};var wt=(e,t)=>{for(var n=0;n<e.length;++n){A(e.charCodeAt(n)===(e.charCodeAt(n)&255));y[t++]=e.charCodeAt(n)}y[t]=0};var Rt=(e,t)=>{var n=0;xt().forEach(((r,o)=>{var a=t+n;v[e+o*4>>2]=a;wt(r,a);n+=r.length+1}));return 0};var It=(e,t)=>{var n=xt();v[e>>2]=n.length;var r=0;n.forEach((e=>r+=e.length+1));v[t>>2]=r;return 0};function kt(e){try{var t=nt.getStreamFromFD(e);tt.close(t);return 0}catch(e){if(typeof tt=="undefined"||!(e.name==="ErrnoError"))throw e;return e.errno}}var jt=(e,t,n,r)=>{var o=0;for(var a=0;a<n;a++){var i=v[t>>2];var s=v[t+4>>2];t+=8;var u=tt.read(e,y,i,s,r);if(u<0)return-1;o+=u;if(u<s)break;if(typeof r!="undefined"){r+=u}}return o};function Bt(e,t,n,r){try{var o=nt.getStreamFromFD(e);var a=jt(o,t,n);v[r>>2]=a;return 0}catch(e){if(typeof tt=="undefined"||!(e.name==="ErrnoError"))throw e;return e.errno}}function Lt(e,t,n,r,o){var a=at(t,n);try{if(isNaN(a))return 61;var i=nt.getStreamFromFD(e);tt.llseek(i,a,r);le=[i.position>>>0,(me=i.position,+Math.abs(me)>=1?me>0?+Math.floor(me/4294967296)>>>0:~~+Math.ceil((me-+(~~me>>>0))/4294967296)>>>0:0)],S[o>>2]=le[0],S[o+4>>2]=le[1];if(i.getdents&&a===0&&r===0)i.getdents=null;return 0}catch(e){if(typeof tt=="undefined"||!(e.name==="ErrnoError"))throw e;return e.errno}}function Nt(e){try{var t=nt.getStreamFromFD(e);if(t.stream_ops?.fsync){return t.stream_ops.fsync(t)}return 0}catch(e){if(typeof tt=="undefined"||!(e.name==="ErrnoError"))throw e;return e.errno}}var Vt=(e,t,n,r)=>{var o=0;for(var a=0;a<n;a++){var i=v[t>>2];var s=v[t+4>>2];t+=8;var u=tt.write(e,y,i,s,r);if(u<0)return-1;o+=u;if(u<s){break}if(typeof r!="undefined"){r+=u}}return o};function Ut(e,t,n,r){try{var o=nt.getStreamFromFD(e);var a=Vt(o,t,n);v[r>>2]=a;return 0}catch(e){if(typeof tt=="undefined"||!(e.name==="ErrnoError"))throw e;return e.errno}}var Wt=[];var zt;var $t=e=>{var t=Wt[e];if(!t){if(e>=Wt.length)Wt.length=e+1;Wt[e]=t=zt.get(e)}A(zt.get(e)==t,"JavaScript-side Wasm function table mirror is out of date!");return t};var Ht=typeof TextDecoder!="undefined"?new TextDecoder("utf-16le"):undefined;var Xt=(e,t)=>{A(e%2==0,"Pointer passed to UTF16ToString must be aligned to two bytes!");var n=e;var r=n>>1;var o=r+t/2;while(!(r>=o)&&G[r])++r;n=r<<1;if(n-e>32&&Ht)return Ht.decode(M.subarray(e,n));var a="";for(var i=0;!(i>=t/2);++i){var s=E[e+i*2>>1];if(s==0)break;a+=String.fromCharCode(s)}return a};var Yt=(e,t)=>{A(e<16384);if(e<128){t.push(e)}else{t.push(e%128|128,e>>7)}};var Kt=e=>{A(!e.includes("j"),"i64 not permitted in function signatures when WASM_BIGINT is disabled");var t={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"};var n={parameters:[],results:e[0]=="v"?[]:[t[e[0]]]};for(var r=1;r<e.length;++r){A(e[r]in t,"invalid signature char: "+e[r]);n.parameters.push(t[e[r]])}return n};var Jt=(e,t)=>{var n=e.slice(0,1);var r=e.slice(1);var o={i:127,p:127,j:126,f:125,d:124,e:111};t.push(96);Yt(r.length,t);for(var a=0;a<r.length;++a){A(r[a]in o,"invalid signature char: "+r[a]);t.push(o[r[a]])}if(n=="v"){t.push(0)}else{t.push(1,o[n])}};var qt=(e,t)=>{A(!t.includes("j"),"i64 not permitted in function signatures when WASM_BIGINT is disabled");if(typeof WebAssembly.Function=="function"){return new WebAssembly.Function(Kt(t),e)}var n=[1];Jt(t,n);var r=[0,97,115,109,1,0,0,0,1];Yt(n.length,r);r.push(...n);r.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var o=new WebAssembly.Module(new Uint8Array(r));var a=new WebAssembly.Instance(o,{e:{f:e}});var i=a.exports["f"];return i};var Qt=(e,t)=>{if(Zt){for(var n=e;n<e+t;n++){var r=$t(n);if(r){Zt.set(r,n)}}}};var Zt;var en=e=>{if(!Zt){Zt=new WeakMap;Qt(0,zt.length)}return Zt.get(e)||0};var tn=[];var nn=()=>{if(tn.length){return tn.pop()}try{zt.grow(1)}catch(e){if(!(e instanceof RangeError)){throw e}throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH."}return zt.length-1};var rn=(e,t)=>{zt.set(e,t);Wt[e]=zt.get(e)};var on=(e,t)=>{A(typeof e!="undefined");var n=en(e);if(n){return n}var r=nn();try{rn(r,e)}catch(n){if(!(n instanceof TypeError)){throw n}A(typeof t!="undefined","Missing signature argument to addFunction: "+e);var o=qt(e,t);rn(r,o)}Zt.set(e,r);return r};var an=e=>{var t=r["_"+e];A(t,"Cannot call unknown function "+e+", make sure it is exported");return t};var sn=(e,t)=>{A(e.length>=0,"writeArrayToMemory array must have a length (should be an array or typed array)");y.set(e,t)};var un=e=>Mn(e);var Fn=e=>{var t=je(e)+1;var n=un(t);st(e,n,t);return n};var mn=(e,t,n,r,o)=>{var a={string:e=>{var t=0;if(e!==null&&e!==undefined&&e!==0){t=Fn(e)}return t},array:e=>{var t=un(e.length);sn(e,t);return t}};function i(e){if(t==="string"){return ve(e)}if(t==="boolean")return Boolean(e);return e}var s=an(e);var u=[];var F=0;A(t!=="array",'Return type should not be "array".');if(r){for(var m=0;m<r.length;m++){var l=a[n[m]];if(l){if(F===0)F=Me();u[m]=l(r[m])}else{u[m]=r[m]}}}var d=s(...u);function c(e){if(F!==0)ye(F);return i(e)}d=c(d);return d};var ln=(e,t,n,r)=>(...r)=>mn(e,t,n,r);var dn=e=>{Zt.delete($t(e));rn(e,null);tn.push(e)};var cn=(e,t,n)=>{A(t%2==0,"Pointer passed to stringToUTF16 must be aligned to two bytes!");A(typeof n=="number","stringToUTF16(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!");n??=2147483647;if(n<2)return 0;n-=2;var r=t;var o=n<e.length*2?n/2:e.length;for(var a=0;a<o;++a){var i=e.charCodeAt(a);E[t>>1]=i;t+=2}E[t>>1]=0;return t-r};tt.createPreloadedFile=Je;tt.staticInit();function _n(){ce("fetchSettings")}var Pn={__assert_fail:Ce,__syscall_fcntl64:rt,__syscall_fstat64:ot,__syscall_ftruncate64:it,__syscall_getdents64:ut,__syscall_ioctl:Ft,__syscall_lstat64:mt,__syscall_newfstatat:lt,__syscall_openat:dt,__syscall_rmdir:ct,__syscall_stat64:_t,__syscall_unlinkat:Pt,_abort_js:gt,_emscripten_memcpy_js:ht,_emscripten_throw_longjmp:ft,_gmtime_js:Dt,_localtime_js:Mt,_tzset_js:Et,emscripten_date_now:Gt,emscripten_resize_heap:Ct,environ_get:Rt,environ_sizes_get:It,fd_close:kt,fd_read:Bt,fd_seek:Lt,fd_sync:Nt,fd_write:Ut,invoke_ii:Sn,invoke_iii:vn,invoke_iiii:Cn,invoke_iiiii:On,invoke_v:xn,invoke_vii:wn,invoke_viii:Gn,invoke_viiii:Tn,invoke_viiiiiiiii:Rn};var gn=Fe();r["_PDFiumExt_Init"]=te("PDFiumExt_Init",0);r["_FPDF_InitLibraryWithConfig"]=te("FPDF_InitLibraryWithConfig",1);r["_PDFiumExt_OpenFileWriter"]=te("PDFiumExt_OpenFileWriter",0);r["_PDFiumExt_GetFileWriterSize"]=te("PDFiumExt_GetFileWriterSize",1);r["_PDFiumExt_GetFileWriterData"]=te("PDFiumExt_GetFileWriterData",3);r["_PDFiumExt_CloseFileWriter"]=te("PDFiumExt_CloseFileWriter",1);r["_PDFiumExt_SaveAsCopy"]=te("PDFiumExt_SaveAsCopy",2);r["_FPDF_SaveAsCopy"]=te("FPDF_SaveAsCopy",3);r["_PDFiumExt_OpenFormFillInfo"]=te("PDFiumExt_OpenFormFillInfo",0);r["_PDFiumExt_CloseFormFillInfo"]=te("PDFiumExt_CloseFormFillInfo",1);r["_PDFiumExt_InitFormFillEnvironment"]=te("PDFiumExt_InitFormFillEnvironment",2);r["_FPDFDOC_InitFormFillEnvironment"]=te("FPDFDOC_InitFormFillEnvironment",2);r["_PDFiumExt_ExitFormFillEnvironment"]=te("PDFiumExt_ExitFormFillEnvironment",1);r["_FPDFDOC_ExitFormFillEnvironment"]=te("FPDFDOC_ExitFormFillEnvironment",1);r["_EPDF_PNG_EncodeRGBA"]=te("EPDF_PNG_EncodeRGBA",6);r["_FPDFAnnot_IsSupportedSubtype"]=te("FPDFAnnot_IsSupportedSubtype",1);r["_FPDFPage_CreateAnnot"]=te("FPDFPage_CreateAnnot",2);r["_FPDFPage_GetAnnotCount"]=te("FPDFPage_GetAnnotCount",1);r["_FPDFPage_GetAnnot"]=te("FPDFPage_GetAnnot",2);r["_FPDFPage_GetAnnotIndex"]=te("FPDFPage_GetAnnotIndex",2);r["_FPDFPage_CloseAnnot"]=te("FPDFPage_CloseAnnot",1);r["_FPDFPage_RemoveAnnot"]=te("FPDFPage_RemoveAnnot",2);r["_FPDFAnnot_GetSubtype"]=te("FPDFAnnot_GetSubtype",1);r["_FPDFAnnot_IsObjectSupportedSubtype"]=te("FPDFAnnot_IsObjectSupportedSubtype",1);r["_FPDFAnnot_UpdateObject"]=te("FPDFAnnot_UpdateObject",2);r["_FPDFAnnot_AddInkStroke"]=te("FPDFAnnot_AddInkStroke",3);r["_FPDFAnnot_RemoveInkList"]=te("FPDFAnnot_RemoveInkList",1);r["_FPDFAnnot_AppendObject"]=te("FPDFAnnot_AppendObject",2);r["_FPDFAnnot_GetObjectCount"]=te("FPDFAnnot_GetObjectCount",1);r["_FPDFAnnot_GetObject"]=te("FPDFAnnot_GetObject",2);r["_FPDFAnnot_RemoveObject"]=te("FPDFAnnot_RemoveObject",2);r["_FPDFAnnot_SetColor"]=te("FPDFAnnot_SetColor",6);r["_FPDFAnnot_GetColor"]=te("FPDFAnnot_GetColor",6);r["_FPDFAnnot_HasAttachmentPoints"]=te("FPDFAnnot_HasAttachmentPoints",1);r["_FPDFAnnot_SetAttachmentPoints"]=te("FPDFAnnot_SetAttachmentPoints",3);r["_FPDFAnnot_AppendAttachmentPoints"]=te("FPDFAnnot_AppendAttachmentPoints",2);r["_FPDFAnnot_CountAttachmentPoints"]=te("FPDFAnnot_CountAttachmentPoints",1);r["_FPDFAnnot_GetAttachmentPoints"]=te("FPDFAnnot_GetAttachmentPoints",3);r["_FPDFAnnot_SetRect"]=te("FPDFAnnot_SetRect",2);r["_FPDFAnnot_GetRect"]=te("FPDFAnnot_GetRect",2);r["_FPDFAnnot_GetVertices"]=te("FPDFAnnot_GetVertices",3);r["_FPDFAnnot_GetInkListCount"]=te("FPDFAnnot_GetInkListCount",1);r["_FPDFAnnot_GetInkListPath"]=te("FPDFAnnot_GetInkListPath",4);r["_FPDFAnnot_GetLine"]=te("FPDFAnnot_GetLine",3);r["_FPDFAnnot_SetBorder"]=te("FPDFAnnot_SetBorder",4);r["_FPDFAnnot_GetBorder"]=te("FPDFAnnot_GetBorder",4);r["_FPDFAnnot_HasKey"]=te("FPDFAnnot_HasKey",2);r["_FPDFAnnot_GetValueType"]=te("FPDFAnnot_GetValueType",2);r["_FPDFAnnot_SetStringValue"]=te("FPDFAnnot_SetStringValue",3);r["_FPDFAnnot_GetStringValue"]=te("FPDFAnnot_GetStringValue",4);r["_FPDFAnnot_GetNumberValue"]=te("FPDFAnnot_GetNumberValue",3);r["_FPDFAnnot_SetAP"]=te("FPDFAnnot_SetAP",3);r["_FPDFAnnot_GetAP"]=te("FPDFAnnot_GetAP",4);r["_FPDFAnnot_GetLinkedAnnot"]=te("FPDFAnnot_GetLinkedAnnot",2);r["_FPDFAnnot_GetFlags"]=te("FPDFAnnot_GetFlags",1);r["_FPDFAnnot_SetFlags"]=te("FPDFAnnot_SetFlags",2);r["_FPDFAnnot_GetFormFieldFlags"]=te("FPDFAnnot_GetFormFieldFlags",2);r["_FPDFAnnot_SetFormFieldFlags"]=te("FPDFAnnot_SetFormFieldFlags",3);r["_FPDFAnnot_GetFormFieldAtPoint"]=te("FPDFAnnot_GetFormFieldAtPoint",3);r["_FPDFAnnot_GetFormFieldName"]=te("FPDFAnnot_GetFormFieldName",4);r["_FPDFAnnot_GetFormFieldType"]=te("FPDFAnnot_GetFormFieldType",2);r["_FPDFAnnot_GetFormAdditionalActionJavaScript"]=te("FPDFAnnot_GetFormAdditionalActionJavaScript",5);r["_FPDFAnnot_GetFormFieldAlternateName"]=te("FPDFAnnot_GetFormFieldAlternateName",4);r["_FPDFAnnot_GetFormFieldValue"]=te("FPDFAnnot_GetFormFieldValue",4);r["_FPDFAnnot_GetOptionCount"]=te("FPDFAnnot_GetOptionCount",2);r["_FPDFAnnot_GetOptionLabel"]=te("FPDFAnnot_GetOptionLabel",5);r["_FPDFAnnot_IsOptionSelected"]=te("FPDFAnnot_IsOptionSelected",3);r["_FPDFAnnot_GetFontSize"]=te("FPDFAnnot_GetFontSize",3);r["_FPDFAnnot_SetFontColor"]=te("FPDFAnnot_SetFontColor",5);r["_FPDFAnnot_GetFontColor"]=te("FPDFAnnot_GetFontColor",5);r["_FPDFAnnot_IsChecked"]=te("FPDFAnnot_IsChecked",2);r["_FPDFAnnot_SetFocusableSubtypes"]=te("FPDFAnnot_SetFocusableSubtypes",3);r["_FPDFAnnot_GetFocusableSubtypesCount"]=te("FPDFAnnot_GetFocusableSubtypesCount",1);r["_FPDFAnnot_GetFocusableSubtypes"]=te("FPDFAnnot_GetFocusableSubtypes",3);r["_FPDFAnnot_GetLink"]=te("FPDFAnnot_GetLink",1);r["_FPDFAnnot_GetFormControlCount"]=te("FPDFAnnot_GetFormControlCount",2);r["_FPDFAnnot_GetFormControlIndex"]=te("FPDFAnnot_GetFormControlIndex",2);r["_FPDFAnnot_GetFormFieldExportValue"]=te("FPDFAnnot_GetFormFieldExportValue",4);r["_FPDFAnnot_SetURI"]=te("FPDFAnnot_SetURI",2);r["_FPDFAnnot_GetFileAttachment"]=te("FPDFAnnot_GetFileAttachment",1);r["_FPDFAnnot_AddFileAttachment"]=te("FPDFAnnot_AddFileAttachment",2);r["_EPDFAnnot_SetColor"]=te("EPDFAnnot_SetColor",5);r["_EPDFAnnot_GetColor"]=te("EPDFAnnot_GetColor",5);r["_EPDFAnnot_ClearColor"]=te("EPDFAnnot_ClearColor",2);r["_EPDFAnnot_SetOpacity"]=te("EPDFAnnot_SetOpacity",2);r["_EPDFAnnot_GetOpacity"]=te("EPDFAnnot_GetOpacity",2);r["_EPDFAnnot_GetBorderEffect"]=te("EPDFAnnot_GetBorderEffect",2);r["_EPDFAnnot_GetRectangleDifferences"]=te("EPDFAnnot_GetRectangleDifferences",5);r["_EPDFAnnot_GetBorderDashPatternCount"]=te("EPDFAnnot_GetBorderDashPatternCount",1);r["_EPDFAnnot_GetBorderDashPattern"]=te("EPDFAnnot_GetBorderDashPattern",3);r["_EPDFAnnot_SetBorderDashPattern"]=te("EPDFAnnot_SetBorderDashPattern",3);r["_EPDFAnnot_GetBorderStyle"]=te("EPDFAnnot_GetBorderStyle",2);r["_EPDFAnnot_SetBorderStyle"]=te("EPDFAnnot_SetBorderStyle",3);r["_EPDFAnnot_GenerateAppearance"]=te("EPDFAnnot_GenerateAppearance",1);r["_EPDFAnnot_GenerateAppearanceWithBlend"]=te("EPDFAnnot_GenerateAppearanceWithBlend",2);r["_EPDFAnnot_GetBlendMode"]=te("EPDFAnnot_GetBlendMode",1);r["_EPDFAnnot_SetIntent"]=te("EPDFAnnot_SetIntent",2);r["_EPDFAnnot_GetIntent"]=te("EPDFAnnot_GetIntent",3);r["_EPDFAnnot_GetRichContent"]=te("EPDFAnnot_GetRichContent",3);r["_EPDFAnnot_SetLineEndings"]=te("EPDFAnnot_SetLineEndings",3);r["_EPDFAnnot_GetLineEndings"]=te("EPDFAnnot_GetLineEndings",3);r["_EPDFAnnot_SetVertices"]=te("EPDFAnnot_SetVertices",3);r["_EPDFAnnot_SetLine"]=te("EPDFAnnot_SetLine",3);r["_EPDFAnnot_SetDefaultAppearance"]=te("EPDFAnnot_SetDefaultAppearance",6);r["_EPDFAnnot_GetDefaultAppearance"]=te("EPDFAnnot_GetDefaultAppearance",6);r["_EPDFAnnot_SetTextAlignment"]=te("EPDFAnnot_SetTextAlignment",2);r["_EPDFAnnot_GetTextAlignment"]=te("EPDFAnnot_GetTextAlignment",1);r["_EPDFAnnot_SetVerticalAlignment"]=te("EPDFAnnot_SetVerticalAlignment",2);r["_EPDFAnnot_GetVerticalAlignment"]=te("EPDFAnnot_GetVerticalAlignment",1);r["_EPDFPage_GetAnnotByName"]=te("EPDFPage_GetAnnotByName",2);r["_EPDFPage_RemoveAnnotByName"]=te("EPDFPage_RemoveAnnotByName",2);r["_EPDFAnnot_SetLinkedAnnot"]=te("EPDFAnnot_SetLinkedAnnot",3);r["_EPDFPage_GetAnnotCountRaw"]=te("EPDFPage_GetAnnotCountRaw",2);r["_EPDFPage_GetAnnotRaw"]=te("EPDFPage_GetAnnotRaw",3);r["_EPDFPage_RemoveAnnotRaw"]=te("EPDFPage_RemoveAnnotRaw",3);r["_EPDFAnnot_SetIcon"]=te("EPDFAnnot_SetIcon",2);r["_EPDFAnnot_GetIcon"]=te("EPDFAnnot_GetIcon",1);r["_EPDFPage_CreateAnnot"]=te("EPDFPage_CreateAnnot",2);r["_FPDFDoc_GetAttachmentCount"]=te("FPDFDoc_GetAttachmentCount",1);r["_FPDFDoc_AddAttachment"]=te("FPDFDoc_AddAttachment",2);r["_FPDFDoc_GetAttachment"]=te("FPDFDoc_GetAttachment",2);r["_FPDFDoc_DeleteAttachment"]=te("FPDFDoc_DeleteAttachment",2);r["_FPDFAttachment_GetName"]=te("FPDFAttachment_GetName",3);r["_FPDFAttachment_HasKey"]=te("FPDFAttachment_HasKey",2);r["_FPDFAttachment_GetValueType"]=te("FPDFAttachment_GetValueType",2);r["_FPDFAttachment_SetStringValue"]=te("FPDFAttachment_SetStringValue",3);r["_FPDFAttachment_GetStringValue"]=te("FPDFAttachment_GetStringValue",4);r["_FPDFAttachment_SetFile"]=te("FPDFAttachment_SetFile",4);r["_FPDFAttachment_GetFile"]=te("FPDFAttachment_GetFile",4);r["_FPDFAttachment_GetSubtype"]=te("FPDFAttachment_GetSubtype",3);r["_FPDFCatalog_IsTagged"]=te("FPDFCatalog_IsTagged",1);r["_FPDFCatalog_SetLanguage"]=te("FPDFCatalog_SetLanguage",2);r["_FPDFAvail_Create"]=te("FPDFAvail_Create",2);r["_FPDFAvail_Destroy"]=te("FPDFAvail_Destroy",1);r["_FPDFAvail_IsDocAvail"]=te("FPDFAvail_IsDocAvail",2);r["_FPDFAvail_GetDocument"]=te("FPDFAvail_GetDocument",2);r["_FPDFAvail_GetFirstPageNum"]=te("FPDFAvail_GetFirstPageNum",1);r["_FPDFAvail_IsPageAvail"]=te("FPDFAvail_IsPageAvail",3);r["_FPDFAvail_IsFormAvail"]=te("FPDFAvail_IsFormAvail",2);r["_FPDFAvail_IsLinearized"]=te("FPDFAvail_IsLinearized",1);r["_FPDFBookmark_GetFirstChild"]=te("FPDFBookmark_GetFirstChild",2);r["_FPDFBookmark_GetNextSibling"]=te("FPDFBookmark_GetNextSibling",2);r["_FPDFBookmark_GetTitle"]=te("FPDFBookmark_GetTitle",3);r["_FPDFBookmark_GetCount"]=te("FPDFBookmark_GetCount",1);r["_FPDFBookmark_Find"]=te("FPDFBookmark_Find",2);r["_FPDFBookmark_GetDest"]=te("FPDFBookmark_GetDest",2);r["_FPDFBookmark_GetAction"]=te("FPDFBookmark_GetAction",1);r["_FPDFAction_GetType"]=te("FPDFAction_GetType",1);r["_FPDFAction_GetDest"]=te("FPDFAction_GetDest",2);r["_FPDFAction_GetFilePath"]=te("FPDFAction_GetFilePath",3);r["_FPDFAction_GetURIPath"]=te("FPDFAction_GetURIPath",4);r["_FPDFDest_GetDestPageIndex"]=te("FPDFDest_GetDestPageIndex",2);r["_FPDFDest_GetView"]=te("FPDFDest_GetView",3);r["_FPDFDest_GetLocationInPage"]=te("FPDFDest_GetLocationInPage",7);r["_FPDFLink_GetLinkAtPoint"]=te("FPDFLink_GetLinkAtPoint",3);r["_FPDFLink_GetLinkZOrderAtPoint"]=te("FPDFLink_GetLinkZOrderAtPoint",3);r["_FPDFLink_GetDest"]=te("FPDFLink_GetDest",2);r["_FPDFLink_GetAction"]=te("FPDFLink_GetAction",1);r["_FPDFLink_Enumerate"]=te("FPDFLink_Enumerate",3);r["_FPDFLink_GetAnnot"]=te("FPDFLink_GetAnnot",2);r["_FPDFLink_GetAnnotRect"]=te("FPDFLink_GetAnnotRect",2);r["_FPDFLink_CountQuadPoints"]=te("FPDFLink_CountQuadPoints",1);r["_FPDFLink_GetQuadPoints"]=te("FPDFLink_GetQuadPoints",3);r["_FPDF_GetPageAAction"]=te("FPDF_GetPageAAction",2);r["_FPDF_GetFileIdentifier"]=te("FPDF_GetFileIdentifier",4);r["_FPDF_GetMetaText"]=te("FPDF_GetMetaText",4);r["_FPDF_GetPageLabel"]=te("FPDF_GetPageLabel",4);r["_EPDF_SetMetaText"]=te("EPDF_SetMetaText",3);r["_EPDF_HasMetaText"]=te("EPDF_HasMetaText",2);r["_FPDFPageObj_NewImageObj"]=te("FPDFPageObj_NewImageObj",1);r["_FPDFImageObj_LoadJpegFile"]=te("FPDFImageObj_LoadJpegFile",4);r["_FPDFImageObj_LoadJpegFileInline"]=te("FPDFImageObj_LoadJpegFileInline",4);r["_FPDFImageObj_SetMatrix"]=te("FPDFImageObj_SetMatrix",7);r["_FPDFImageObj_SetBitmap"]=te("FPDFImageObj_SetBitmap",4);r["_FPDFImageObj_GetBitmap"]=te("FPDFImageObj_GetBitmap",1);r["_FPDFImageObj_GetRenderedBitmap"]=te("FPDFImageObj_GetRenderedBitmap",3);r["_FPDFImageObj_GetImageDataDecoded"]=te("FPDFImageObj_GetImageDataDecoded",3);r["_FPDFImageObj_GetImageDataRaw"]=te("FPDFImageObj_GetImageDataRaw",3);r["_FPDFImageObj_GetImageFilterCount"]=te("FPDFImageObj_GetImageFilterCount",1);r["_FPDFImageObj_GetImageFilter"]=te("FPDFImageObj_GetImageFilter",4);r["_FPDFImageObj_GetImageMetadata"]=te("FPDFImageObj_GetImageMetadata",3);r["_FPDFImageObj_GetImagePixelSize"]=te("FPDFImageObj_GetImagePixelSize",3);r["_FPDFImageObj_GetIccProfileDataDecoded"]=te("FPDFImageObj_GetIccProfileDataDecoded",5);r["_FPDF_CreateNewDocument"]=te("FPDF_CreateNewDocument",0);r["_FPDFPage_Delete"]=te("FPDFPage_Delete",2);r["_FPDF_MovePages"]=te("FPDF_MovePages",4);r["_FPDFPage_New"]=te("FPDFPage_New",4);r["_FPDFPage_GetRotation"]=te("FPDFPage_GetRotation",1);r["_FPDFPage_InsertObject"]=te("FPDFPage_InsertObject",2);r["_FPDFPage_InsertObjectAtIndex"]=te("FPDFPage_InsertObjectAtIndex",3);r["_FPDFPage_RemoveObject"]=te("FPDFPage_RemoveObject",2);r["_FPDFPage_CountObjects"]=te("FPDFPage_CountObjects",1);r["_FPDFPage_GetObject"]=te("FPDFPage_GetObject",2);r["_FPDFPage_HasTransparency"]=te("FPDFPage_HasTransparency",1);r["_FPDFPageObj_Destroy"]=te("FPDFPageObj_Destroy",1);r["_FPDFPageObj_GetMarkedContentID"]=te("FPDFPageObj_GetMarkedContentID",1);r["_FPDFPageObj_CountMarks"]=te("FPDFPageObj_CountMarks",1);r["_FPDFPageObj_GetMark"]=te("FPDFPageObj_GetMark",2);r["_FPDFPageObj_AddMark"]=te("FPDFPageObj_AddMark",2);r["_FPDFPageObj_RemoveMark"]=te("FPDFPageObj_RemoveMark",2);r["_FPDFPageObjMark_GetName"]=te("FPDFPageObjMark_GetName",4);r["_FPDFPageObjMark_CountParams"]=te("FPDFPageObjMark_CountParams",1);r["_FPDFPageObjMark_GetParamKey"]=te("FPDFPageObjMark_GetParamKey",5);r["_FPDFPageObjMark_GetParamValueType"]=te("FPDFPageObjMark_GetParamValueType",2);r["_FPDFPageObjMark_GetParamIntValue"]=te("FPDFPageObjMark_GetParamIntValue",3);r["_FPDFPageObjMark_GetParamStringValue"]=te("FPDFPageObjMark_GetParamStringValue",5);r["_FPDFPageObjMark_GetParamBlobValue"]=te("FPDFPageObjMark_GetParamBlobValue",5);r["_FPDFPageObj_HasTransparency"]=te("FPDFPageObj_HasTransparency",1);r["_FPDFPageObjMark_SetIntParam"]=te("FPDFPageObjMark_SetIntParam",5);r["_FPDFPageObjMark_SetStringParam"]=te("FPDFPageObjMark_SetStringParam",5);r["_FPDFPageObjMark_SetBlobParam"]=te("FPDFPageObjMark_SetBlobParam",6);r["_FPDFPageObjMark_RemoveParam"]=te("FPDFPageObjMark_RemoveParam",3);r["_FPDFPageObj_GetType"]=te("FPDFPageObj_GetType",1);r["_FPDFPageObj_GetIsActive"]=te("FPDFPageObj_GetIsActive",2);r["_FPDFPageObj_SetIsActive"]=te("FPDFPageObj_SetIsActive",2);r["_FPDFPage_GenerateContent"]=te("FPDFPage_GenerateContent",1);r["_FPDFPageObj_Transform"]=te("FPDFPageObj_Transform",7);r["_FPDFPageObj_TransformF"]=te("FPDFPageObj_TransformF",2);r["_FPDFPageObj_GetMatrix"]=te("FPDFPageObj_GetMatrix",2);r["_FPDFPageObj_SetMatrix"]=te("FPDFPageObj_SetMatrix",2);r["_FPDFPageObj_SetBlendMode"]=te("FPDFPageObj_SetBlendMode",2);r["_FPDFPage_TransformAnnots"]=te("FPDFPage_TransformAnnots",7);r["_FPDFPage_SetRotation"]=te("FPDFPage_SetRotation",2);r["_FPDFPageObj_SetFillColor"]=te("FPDFPageObj_SetFillColor",5);r["_FPDFPageObj_GetFillColor"]=te("FPDFPageObj_GetFillColor",5);r["_FPDFPageObj_GetBounds"]=te("FPDFPageObj_GetBounds",5);r["_FPDFPageObj_GetRotatedBounds"]=te("FPDFPageObj_GetRotatedBounds",2);r["_FPDFPageObj_SetStrokeColor"]=te("FPDFPageObj_SetStrokeColor",5);r["_FPDFPageObj_GetStrokeColor"]=te("FPDFPageObj_GetStrokeColor",5);r["_FPDFPageObj_SetStrokeWidth"]=te("FPDFPageObj_SetStrokeWidth",2);r["_FPDFPageObj_GetStrokeWidth"]=te("FPDFPageObj_GetStrokeWidth",2);r["_FPDFPageObj_GetLineJoin"]=te("FPDFPageObj_GetLineJoin",1);r["_FPDFPageObj_SetLineJoin"]=te("FPDFPageObj_SetLineJoin",2);r["_FPDFPageObj_GetLineCap"]=te("FPDFPageObj_GetLineCap",1);r["_FPDFPageObj_SetLineCap"]=te("FPDFPageObj_SetLineCap",2);r["_FPDFPageObj_GetDashPhase"]=te("FPDFPageObj_GetDashPhase",2);r["_FPDFPageObj_SetDashPhase"]=te("FPDFPageObj_SetDashPhase",2);r["_FPDFPageObj_GetDashCount"]=te("FPDFPageObj_GetDashCount",1);r["_FPDFPageObj_GetDashArray"]=te("FPDFPageObj_GetDashArray",3);r["_FPDFPageObj_SetDashArray"]=te("FPDFPageObj_SetDashArray",4);r["_FPDFFormObj_CountObjects"]=te("FPDFFormObj_CountObjects",1);r["_FPDFFormObj_GetObject"]=te("FPDFFormObj_GetObject",2);r["_FPDFFormObj_RemoveObject"]=te("FPDFFormObj_RemoveObject",2);r["_FPDFPageObj_CreateNewPath"]=te("FPDFPageObj_CreateNewPath",2);r["_FPDFPageObj_CreateNewRect"]=te("FPDFPageObj_CreateNewRect",4);r["_FPDFPath_CountSegments"]=te("FPDFPath_CountSegments",1);r["_FPDFPath_GetPathSegment"]=te("FPDFPath_GetPathSegment",2);r["_FPDFPath_MoveTo"]=te("FPDFPath_MoveTo",3);r["_FPDFPath_LineTo"]=te("FPDFPath_LineTo",3);r["_FPDFPath_BezierTo"]=te("FPDFPath_BezierTo",7);r["_FPDFPath_Close"]=te("FPDFPath_Close",1);r["_FPDFPath_SetDrawMode"]=te("FPDFPath_SetDrawMode",3);r["_FPDFPath_GetDrawMode"]=te("FPDFPath_GetDrawMode",3);r["_FPDFPathSegment_GetPoint"]=te("FPDFPathSegment_GetPoint",3);r["_FPDFPathSegment_GetType"]=te("FPDFPathSegment_GetType",1);r["_FPDFPathSegment_GetClose"]=te("FPDFPathSegment_GetClose",1);r["_FPDFPageObj_NewTextObj"]=te("FPDFPageObj_NewTextObj",3);r["_FPDFText_SetText"]=te("FPDFText_SetText",2);r["_FPDFText_SetCharcodes"]=te("FPDFText_SetCharcodes",3);r["_FPDFText_LoadFont"]=te("FPDFText_LoadFont",5);r["_FPDFText_LoadStandardFont"]=te("FPDFText_LoadStandardFont",2);r["_FPDFText_LoadCidType2Font"]=te("FPDFText_LoadCidType2Font",6);r["_FPDFTextObj_GetFontSize"]=te("FPDFTextObj_GetFontSize",2);r["_FPDFTextObj_GetText"]=te("FPDFTextObj_GetText",4);r["_FPDFTextObj_GetRenderedBitmap"]=te("FPDFTextObj_GetRenderedBitmap",4);r["_FPDFFont_Close"]=te("FPDFFont_Close",1);r["_FPDFPageObj_CreateTextObj"]=te("FPDFPageObj_CreateTextObj",3);r["_FPDFTextObj_GetTextRenderMode"]=te("FPDFTextObj_GetTextRenderMode",1);r["_FPDFTextObj_SetTextRenderMode"]=te("FPDFTextObj_SetTextRenderMode",2);r["_FPDFTextObj_GetFont"]=te("FPDFTextObj_GetFont",1);r["_FPDFFont_GetBaseFontName"]=te("FPDFFont_GetBaseFontName",3);r["_FPDFFont_GetFamilyName"]=te("FPDFFont_GetFamilyName",3);r["_FPDFFont_GetFontData"]=te("FPDFFont_GetFontData",4);r["_FPDFFont_GetIsEmbedded"]=te("FPDFFont_GetIsEmbedded",1);r["_FPDFFont_GetFlags"]=te("FPDFFont_GetFlags",1);r["_FPDFFont_GetWeight"]=te("FPDFFont_GetWeight",1);r["_FPDFFont_GetItalicAngle"]=te("FPDFFont_GetItalicAngle",2);r["_FPDFFont_GetAscent"]=te("FPDFFont_GetAscent",3);r["_FPDFFont_GetDescent"]=te("FPDFFont_GetDescent",3);r["_FPDFFont_GetGlyphWidth"]=te("FPDFFont_GetGlyphWidth",4);r["_FPDFFont_GetGlyphPath"]=te("FPDFFont_GetGlyphPath",3);r["_FPDFGlyphPath_CountGlyphSegments"]=te("FPDFGlyphPath_CountGlyphSegments",1);r["_FPDFGlyphPath_GetGlyphPathSegment"]=te("FPDFGlyphPath_GetGlyphPathSegment",2);r["_EPDFText_RedactInRect"]=te("EPDFText_RedactInRect",4);r["_EPDFText_RedactInQuads"]=te("EPDFText_RedactInQuads",5);r["_FPDFDoc_GetPageMode"]=te("FPDFDoc_GetPageMode",1);r["_FPDFPage_Flatten"]=te("FPDFPage_Flatten",2);r["_FPDFPage_HasFormFieldAtPoint"]=te("FPDFPage_HasFormFieldAtPoint",4);r["_FPDFPage_FormFieldZOrderAtPoint"]=te("FPDFPage_FormFieldZOrderAtPoint",4);r["_malloc"]=te("malloc",1);r["_free"]=te("free",1);r["_FORM_OnMouseMove"]=te("FORM_OnMouseMove",5);r["_FORM_OnMouseWheel"]=te("FORM_OnMouseWheel",6);r["_FORM_OnFocus"]=te("FORM_OnFocus",5);r["_FORM_OnLButtonDown"]=te("FORM_OnLButtonDown",5);r["_FORM_OnLButtonUp"]=te("FORM_OnLButtonUp",5);r["_FORM_OnLButtonDoubleClick"]=te("FORM_OnLButtonDoubleClick",5);r["_FORM_OnRButtonDown"]=te("FORM_OnRButtonDown",5);r["_FORM_OnRButtonUp"]=te("FORM_OnRButtonUp",5);r["_FORM_OnKeyDown"]=te("FORM_OnKeyDown",4);r["_FORM_OnKeyUp"]=te("FORM_OnKeyUp",4);r["_FORM_OnChar"]=te("FORM_OnChar",4);r["_FORM_GetFocusedText"]=te("FORM_GetFocusedText",4);r["_FORM_GetSelectedText"]=te("FORM_GetSelectedText",4);r["_FORM_ReplaceAndKeepSelection"]=te("FORM_ReplaceAndKeepSelection",3);r["_FORM_ReplaceSelection"]=te("FORM_ReplaceSelection",3);r["_FORM_SelectAllText"]=te("FORM_SelectAllText",2);r["_FORM_CanUndo"]=te("FORM_CanUndo",2);r["_FORM_CanRedo"]=te("FORM_CanRedo",2);r["_FORM_Undo"]=te("FORM_Undo",2);r["_FORM_Redo"]=te("FORM_Redo",2);r["_FORM_ForceToKillFocus"]=te("FORM_ForceToKillFocus",1);r["_FORM_GetFocusedAnnot"]=te("FORM_GetFocusedAnnot",3);r["_FORM_SetFocusedAnnot"]=te("FORM_SetFocusedAnnot",2);r["_FPDF_FFLDraw"]=te("FPDF_FFLDraw",9);r["_FPDF_SetFormFieldHighlightColor"]=te("FPDF_SetFormFieldHighlightColor",3);r["_FPDF_SetFormFieldHighlightAlpha"]=te("FPDF_SetFormFieldHighlightAlpha",2);r["_FPDF_RemoveFormFieldHighlight"]=te("FPDF_RemoveFormFieldHighlight",1);r["_FORM_OnAfterLoadPage"]=te("FORM_OnAfterLoadPage",2);r["_FORM_OnBeforeClosePage"]=te("FORM_OnBeforeClosePage",2);r["_FORM_DoDocumentJSAction"]=te("FORM_DoDocumentJSAction",1);r["_FORM_DoDocumentOpenAction"]=te("FORM_DoDocumentOpenAction",1);r["_FORM_DoDocumentAAction"]=te("FORM_DoDocumentAAction",2);r["_FORM_DoPageAAction"]=te("FORM_DoPageAAction",3);r["_FORM_SetIndexSelected"]=te("FORM_SetIndexSelected",4);r["_FORM_IsIndexSelected"]=te("FORM_IsIndexSelected",3);r["_FPDFDoc_GetJavaScriptActionCount"]=te("FPDFDoc_GetJavaScriptActionCount",1);r["_FPDFDoc_GetJavaScriptAction"]=te("FPDFDoc_GetJavaScriptAction",2);r["_FPDFDoc_CloseJavaScriptAction"]=te("FPDFDoc_CloseJavaScriptAction",1);r["_FPDFJavaScriptAction_GetName"]=te("FPDFJavaScriptAction_GetName",3);r["_FPDFJavaScriptAction_GetScript"]=te("FPDFJavaScriptAction_GetScript",3);r["_FPDF_ImportPagesByIndex"]=te("FPDF_ImportPagesByIndex",5);r["_FPDF_ImportPages"]=te("FPDF_ImportPages",4);r["_FPDF_ImportNPagesToOne"]=te("FPDF_ImportNPagesToOne",5);r["_FPDF_NewXObjectFromPage"]=te("FPDF_NewXObjectFromPage",3);r["_FPDF_CloseXObject"]=te("FPDF_CloseXObject",1);r["_FPDF_NewFormObjectFromXObject"]=te("FPDF_NewFormObjectFromXObject",1);r["_FPDF_CopyViewerPreferences"]=te("FPDF_CopyViewerPreferences",2);r["_FPDF_RenderPageBitmapWithColorScheme_Start"]=te("FPDF_RenderPageBitmapWithColorScheme_Start",10);r["_FPDF_RenderPageBitmap_Start"]=te("FPDF_RenderPageBitmap_Start",9);r["_FPDF_RenderPage_Continue"]=te("FPDF_RenderPage_Continue",2);r["_FPDF_RenderPage_Close"]=te("FPDF_RenderPage_Close",1);r["_FPDF_SaveWithVersion"]=te("FPDF_SaveWithVersion",4);r["_FPDFText_GetCharIndexFromTextIndex"]=te("FPDFText_GetCharIndexFromTextIndex",2);r["_FPDFText_GetTextIndexFromCharIndex"]=te("FPDFText_GetTextIndexFromCharIndex",2);r["_FPDF_GetSignatureCount"]=te("FPDF_GetSignatureCount",1);r["_FPDF_GetSignatureObject"]=te("FPDF_GetSignatureObject",2);r["_FPDFSignatureObj_GetContents"]=te("FPDFSignatureObj_GetContents",3);r["_FPDFSignatureObj_GetByteRange"]=te("FPDFSignatureObj_GetByteRange",3);r["_FPDFSignatureObj_GetSubFilter"]=te("FPDFSignatureObj_GetSubFilter",3);r["_FPDFSignatureObj_GetReason"]=te("FPDFSignatureObj_GetReason",3);r["_FPDFSignatureObj_GetTime"]=te("FPDFSignatureObj_GetTime",3);r["_FPDFSignatureObj_GetDocMDPPermission"]=te("FPDFSignatureObj_GetDocMDPPermission",1);r["_FPDF_StructTree_GetForPage"]=te("FPDF_StructTree_GetForPage",1);r["_FPDF_StructTree_Close"]=te("FPDF_StructTree_Close",1);r["_FPDF_StructTree_CountChildren"]=te("FPDF_StructTree_CountChildren",1);r["_FPDF_StructTree_GetChildAtIndex"]=te("FPDF_StructTree_GetChildAtIndex",2);r["_FPDF_StructElement_GetAltText"]=te("FPDF_StructElement_GetAltText",3);r["_FPDF_StructElement_GetActualText"]=te("FPDF_StructElement_GetActualText",3);r["_FPDF_StructElement_GetID"]=te("FPDF_StructElement_GetID",3);r["_FPDF_StructElement_GetLang"]=te("FPDF_StructElement_GetLang",3);r["_FPDF_StructElement_GetAttributeCount"]=te("FPDF_StructElement_GetAttributeCount",1);r["_FPDF_StructElement_GetAttributeAtIndex"]=te("FPDF_StructElement_GetAttributeAtIndex",2);r["_FPDF_StructElement_GetStringAttribute"]=te("FPDF_StructElement_GetStringAttribute",4);r["_FPDF_StructElement_GetMarkedContentID"]=te("FPDF_StructElement_GetMarkedContentID",1);r["_FPDF_StructElement_GetType"]=te("FPDF_StructElement_GetType",3);r["_FPDF_StructElement_GetObjType"]=te("FPDF_StructElement_GetObjType",3);r["_FPDF_StructElement_GetTitle"]=te("FPDF_StructElement_GetTitle",3);r["_FPDF_StructElement_CountChildren"]=te("FPDF_StructElement_CountChildren",1);r["_FPDF_StructElement_GetChildAtIndex"]=te("FPDF_StructElement_GetChildAtIndex",2);r["_FPDF_StructElement_GetChildMarkedContentID"]=te("FPDF_StructElement_GetChildMarkedContentID",2);r["_FPDF_StructElement_GetParent"]=te("FPDF_StructElement_GetParent",1);r["_FPDF_StructElement_Attr_GetCount"]=te("FPDF_StructElement_Attr_GetCount",1);r["_FPDF_StructElement_Attr_GetName"]=te("FPDF_StructElement_Attr_GetName",5);r["_FPDF_StructElement_Attr_GetValue"]=te("FPDF_StructElement_Attr_GetValue",2);r["_FPDF_StructElement_Attr_GetType"]=te("FPDF_StructElement_Attr_GetType",1);r["_FPDF_StructElement_Attr_GetBooleanValue"]=te("FPDF_StructElement_Attr_GetBooleanValue",2);r["_FPDF_StructElement_Attr_GetNumberValue"]=te("FPDF_StructElement_Attr_GetNumberValue",2);r["_FPDF_StructElement_Attr_GetStringValue"]=te("FPDF_StructElement_Attr_GetStringValue",4);r["_FPDF_StructElement_Attr_GetBlobValue"]=te("FPDF_StructElement_Attr_GetBlobValue",4);r["_FPDF_StructElement_Attr_CountChildren"]=te("FPDF_StructElement_Attr_CountChildren",1);r["_FPDF_StructElement_Attr_GetChildAtIndex"]=te("FPDF_StructElement_Attr_GetChildAtIndex",2);r["_FPDF_StructElement_GetMarkedContentIdCount"]=te("FPDF_StructElement_GetMarkedContentIdCount",1);r["_FPDF_StructElement_GetMarkedContentIdAtIndex"]=te("FPDF_StructElement_GetMarkedContentIdAtIndex",2);r["_FPDF_AddInstalledFont"]=te("FPDF_AddInstalledFont",3);r["_FPDF_SetSystemFontInfo"]=te("FPDF_SetSystemFontInfo",1);r["_FPDF_GetDefaultTTFMap"]=te("FPDF_GetDefaultTTFMap",0);r["_FPDF_GetDefaultTTFMapCount"]=te("FPDF_GetDefaultTTFMapCount",0);r["_FPDF_GetDefaultTTFMapEntry"]=te("FPDF_GetDefaultTTFMapEntry",1);r["_FPDF_GetDefaultSystemFontInfo"]=te("FPDF_GetDefaultSystemFontInfo",0);r["_FPDF_FreeDefaultSystemFontInfo"]=te("FPDF_FreeDefaultSystemFontInfo",1);r["_FPDFText_LoadPage"]=te("FPDFText_LoadPage",1);r["_FPDFText_ClosePage"]=te("FPDFText_ClosePage",1);r["_FPDFText_CountChars"]=te("FPDFText_CountChars",1);r["_FPDFText_GetUnicode"]=te("FPDFText_GetUnicode",2);r["_FPDFText_GetTextObject"]=te("FPDFText_GetTextObject",2);r["_FPDFText_IsGenerated"]=te("FPDFText_IsGenerated",2);r["_FPDFText_IsHyphen"]=te("FPDFText_IsHyphen",2);r["_FPDFText_HasUnicodeMapError"]=te("FPDFText_HasUnicodeMapError",2);r["_FPDFText_GetFontSize"]=te("FPDFText_GetFontSize",2);r["_FPDFText_GetFontInfo"]=te("FPDFText_GetFontInfo",5);r["_FPDFText_GetFontWeight"]=te("FPDFText_GetFontWeight",2);r["_FPDFText_GetFillColor"]=te("FPDFText_GetFillColor",6);r["_FPDFText_GetStrokeColor"]=te("FPDFText_GetStrokeColor",6);r["_FPDFText_GetCharAngle"]=te("FPDFText_GetCharAngle",2);r["_FPDFText_GetCharBox"]=te("FPDFText_GetCharBox",6);r["_FPDFText_GetLooseCharBox"]=te("FPDFText_GetLooseCharBox",3);r["_FPDFText_GetMatrix"]=te("FPDFText_GetMatrix",3);r["_FPDFText_GetCharOrigin"]=te("FPDFText_GetCharOrigin",4);r["_FPDFText_GetCharIndexAtPos"]=te("FPDFText_GetCharIndexAtPos",5);r["_FPDFText_GetText"]=te("FPDFText_GetText",4);r["_FPDFText_CountRects"]=te("FPDFText_CountRects",3);r["_FPDFText_GetRect"]=te("FPDFText_GetRect",6);r["_FPDFText_GetBoundedText"]=te("FPDFText_GetBoundedText",7);r["_FPDFText_FindStart"]=te("FPDFText_FindStart",4);r["_FPDFText_FindNext"]=te("FPDFText_FindNext",1);r["_FPDFText_FindPrev"]=te("FPDFText_FindPrev",1);r["_FPDFText_GetSchResultIndex"]=te("FPDFText_GetSchResultIndex",1);r["_FPDFText_GetSchCount"]=te("FPDFText_GetSchCount",1);r["_FPDFText_FindClose"]=te("FPDFText_FindClose",1);r["_FPDFLink_LoadWebLinks"]=te("FPDFLink_LoadWebLinks",1);r["_FPDFLink_CountWebLinks"]=te("FPDFLink_CountWebLinks",1);r["_FPDFLink_GetURL"]=te("FPDFLink_GetURL",4);r["_FPDFLink_CountRects"]=te("FPDFLink_CountRects",2);r["_FPDFLink_GetRect"]=te("FPDFLink_GetRect",7);r["_FPDFLink_GetTextRange"]=te("FPDFLink_GetTextRange",4);r["_FPDFLink_CloseWebLinks"]=te("FPDFLink_CloseWebLinks",1);r["_FPDFPage_GetDecodedThumbnailData"]=te("FPDFPage_GetDecodedThumbnailData",3);r["_FPDFPage_GetRawThumbnailData"]=te("FPDFPage_GetRawThumbnailData",3);r["_FPDFPage_GetThumbnailAsBitmap"]=te("FPDFPage_GetThumbnailAsBitmap",1);r["_FPDFPage_SetMediaBox"]=te("FPDFPage_SetMediaBox",5);r["_FPDFPage_SetCropBox"]=te("FPDFPage_SetCropBox",5);r["_FPDFPage_SetBleedBox"]=te("FPDFPage_SetBleedBox",5);r["_FPDFPage_SetTrimBox"]=te("FPDFPage_SetTrimBox",5);r["_FPDFPage_SetArtBox"]=te("FPDFPage_SetArtBox",5);r["_FPDFPage_GetMediaBox"]=te("FPDFPage_GetMediaBox",5);r["_FPDFPage_GetCropBox"]=te("FPDFPage_GetCropBox",5);r["_FPDFPage_GetBleedBox"]=te("FPDFPage_GetBleedBox",5);r["_FPDFPage_GetTrimBox"]=te("FPDFPage_GetTrimBox",5);r["_FPDFPage_GetArtBox"]=te("FPDFPage_GetArtBox",5);r["_FPDFPage_TransFormWithClip"]=te("FPDFPage_TransFormWithClip",3);r["_FPDFPageObj_TransformClipPath"]=te("FPDFPageObj_TransformClipPath",7);r["_FPDFPageObj_GetClipPath"]=te("FPDFPageObj_GetClipPath",1);r["_FPDFClipPath_CountPaths"]=te("FPDFClipPath_CountPaths",1);r["_FPDFClipPath_CountPathSegments"]=te("FPDFClipPath_CountPathSegments",2);r["_FPDFClipPath_GetPathSegment"]=te("FPDFClipPath_GetPathSegment",3);r["_FPDF_CreateClipPath"]=te("FPDF_CreateClipPath",4);r["_FPDF_DestroyClipPath"]=te("FPDF_DestroyClipPath",1);r["_FPDFPage_InsertClipPath"]=te("FPDFPage_InsertClipPath",2);r["_FPDF_InitLibrary"]=te("FPDF_InitLibrary",0);r["_FPDF_DestroyLibrary"]=te("FPDF_DestroyLibrary",0);r["_FPDF_SetSandBoxPolicy"]=te("FPDF_SetSandBoxPolicy",2);r["_FPDF_LoadDocument"]=te("FPDF_LoadDocument",2);r["_FPDF_GetFormType"]=te("FPDF_GetFormType",1);r["_FPDF_LoadXFA"]=te("FPDF_LoadXFA",1);r["_FPDF_LoadMemDocument"]=te("FPDF_LoadMemDocument",3);r["_FPDF_LoadMemDocument64"]=te("FPDF_LoadMemDocument64",3);r["_FPDF_LoadCustomDocument"]=te("FPDF_LoadCustomDocument",2);r["_FPDF_GetFileVersion"]=te("FPDF_GetFileVersion",2);r["_FPDF_DocumentHasValidCrossReferenceTable"]=te("FPDF_DocumentHasValidCrossReferenceTable",1);r["_FPDF_GetDocPermissions"]=te("FPDF_GetDocPermissions",1);r["_FPDF_GetDocUserPermissions"]=te("FPDF_GetDocUserPermissions",1);r["_FPDF_GetSecurityHandlerRevision"]=te("FPDF_GetSecurityHandlerRevision",1);r["_FPDF_GetPageCount"]=te("FPDF_GetPageCount",1);r["_FPDF_LoadPage"]=te("FPDF_LoadPage",2);r["_FPDF_GetPageWidthF"]=te("FPDF_GetPageWidthF",1);r["_FPDF_GetPageWidth"]=te("FPDF_GetPageWidth",1);r["_FPDF_GetPageHeightF"]=te("FPDF_GetPageHeightF",1);r["_FPDF_GetPageHeight"]=te("FPDF_GetPageHeight",1);r["_FPDF_GetPageBoundingBox"]=te("FPDF_GetPageBoundingBox",2);r["_FPDF_RenderPageBitmap"]=te("FPDF_RenderPageBitmap",8);r["_FPDF_RenderPageBitmapWithMatrix"]=te("FPDF_RenderPageBitmapWithMatrix",5);r["_EPDF_RenderAnnotBitmap"]=te("EPDF_RenderAnnotBitmap",6);r["_FPDF_ClosePage"]=te("FPDF_ClosePage",1);r["_FPDF_CloseDocument"]=te("FPDF_CloseDocument",1);r["_FPDF_GetLastError"]=te("FPDF_GetLastError",0);r["_FPDF_DeviceToPage"]=te("FPDF_DeviceToPage",10);r["_FPDF_PageToDevice"]=te("FPDF_PageToDevice",10);r["_FPDFBitmap_Create"]=te("FPDFBitmap_Create",3);r["_FPDFBitmap_CreateEx"]=te("FPDFBitmap_CreateEx",5);r["_FPDFBitmap_GetFormat"]=te("FPDFBitmap_GetFormat",1);r["_FPDFBitmap_FillRect"]=te("FPDFBitmap_FillRect",6);r["_FPDFBitmap_GetBuffer"]=te("FPDFBitmap_GetBuffer",1);r["_FPDFBitmap_GetWidth"]=te("FPDFBitmap_GetWidth",1);r["_FPDFBitmap_GetHeight"]=te("FPDFBitmap_GetHeight",1);r["_FPDFBitmap_GetStride"]=te("FPDFBitmap_GetStride",1);r["_FPDFBitmap_Destroy"]=te("FPDFBitmap_Destroy",1);r["_FPDF_GetPageSizeByIndexF"]=te("FPDF_GetPageSizeByIndexF",3);r["_FPDF_GetPageSizeByIndex"]=te("FPDF_GetPageSizeByIndex",4);r["_FPDF_VIEWERREF_GetPrintScaling"]=te("FPDF_VIEWERREF_GetPrintScaling",1);r["_FPDF_VIEWERREF_GetNumCopies"]=te("FPDF_VIEWERREF_GetNumCopies",1);r["_FPDF_VIEWERREF_GetPrintPageRange"]=te("FPDF_VIEWERREF_GetPrintPageRange",1);r["_FPDF_VIEWERREF_GetPrintPageRangeCount"]=te("FPDF_VIEWERREF_GetPrintPageRangeCount",1);r["_FPDF_VIEWERREF_GetPrintPageRangeElement"]=te("FPDF_VIEWERREF_GetPrintPageRangeElement",2);r["_FPDF_VIEWERREF_GetDuplex"]=te("FPDF_VIEWERREF_GetDuplex",1);r["_FPDF_VIEWERREF_GetName"]=te("FPDF_VIEWERREF_GetName",4);r["_FPDF_CountNamedDests"]=te("FPDF_CountNamedDests",1);r["_FPDF_GetNamedDestByName"]=te("FPDF_GetNamedDestByName",2);r["_FPDF_GetNamedDest"]=te("FPDF_GetNamedDest",4);r["_FPDF_GetXFAPacketCount"]=te("FPDF_GetXFAPacketCount",1);r["_FPDF_GetXFAPacketName"]=te("FPDF_GetXFAPacketName",4);r["_FPDF_GetXFAPacketContent"]=te("FPDF_GetXFAPacketContent",5);r["_FPDF_GetTrailerEnds"]=te("FPDF_GetTrailerEnds",3);var hn=te("fflush",1);var fn=te("emscripten_builtin_memalign",2);var Dn=te("strerror",1);var bn=te("setThrew",2);var pn=()=>(pn=gn["emscripten_stack_init"])();var An=()=>(An=gn["emscripten_stack_get_end"])();var yn=e=>(yn=gn["_emscripten_stack_restore"])(e);var Mn=e=>(Mn=gn["_emscripten_stack_alloc"])(e);var En=()=>(En=gn["emscripten_stack_get_current"])();r["dynCall_ji"]=te("dynCall_ji",2);r["dynCall_jij"]=te("dynCall_jij",4);r["dynCall_iiij"]=te("dynCall_iiij",5);r["dynCall_iij"]=te("dynCall_iij",4);r["dynCall_j"]=te("dynCall_j",1);r["dynCall_jji"]=te("dynCall_jji",4);r["dynCall_iji"]=te("dynCall_iji",4);r["dynCall_viijii"]=te("dynCall_viijii",7);r["dynCall_iiji"]=te("dynCall_iiji",5);r["dynCall_jiji"]=te("dynCall_jiji",5);r["dynCall_iiiiij"]=te("dynCall_iiiiij",7);r["dynCall_iiiiijj"]=te("dynCall_iiiiijj",9);r["dynCall_iiiiiijj"]=te("dynCall_iiiiiijj",10);r["dynCall_viji"]=te("dynCall_viji",5);function Gn(e,t,n,r){var o=Me();try{$t(e)(t,n,r)}catch(e){ye(o);if(e!==e+0)throw e;bn(1,0)}}function Sn(e,t){var n=Me();try{return $t(e)(t)}catch(e){ye(n);if(e!==e+0)throw e;bn(1,0)}}function vn(e,t,n){var r=Me();try{return $t(e)(t,n)}catch(e){ye(r);if(e!==e+0)throw e;bn(1,0)}}function Cn(e,t,n,r){var o=Me();try{return $t(e)(t,n,r)}catch(e){ye(o);if(e!==e+0)throw e;bn(1,0)}}function Tn(e,t,n,r,o){var a=Me();try{$t(e)(t,n,r,o)}catch(e){ye(a);if(e!==e+0)throw e;bn(1,0)}}function On(e,t,n,r,o){var a=Me();try{return $t(e)(t,n,r,o)}catch(e){ye(a);if(e!==e+0)throw e;bn(1,0)}}function xn(e){var t=Me();try{$t(e)()}catch(e){ye(t);if(e!==e+0)throw e;bn(1,0)}}function wn(e,t,n){var r=Me();try{$t(e)(t,n)}catch(e){ye(r);if(e!==e+0)throw e;bn(1,0)}}function Rn(e,t,n,r,o,a,i,s,u,F){var m=Me();try{$t(e)(t,n,r,o,a,i,s,u,F)}catch(e){ye(m);if(e!==e+0)throw e;bn(1,0)}}r["wasmExports"]=gn;r["ccall"]=mn;r["cwrap"]=ln;r["addFunction"]=on;r["removeFunction"]=dn;r["setValue"]=Ae;r["getValue"]=be;r["UTF8ToString"]=ve;r["stringToUTF8"]=st;r["UTF16ToString"]=Xt;r["stringToUTF16"]=cn;var In=["writeI53ToI64","writeI53ToI64Clamped","writeI53ToI64Signaling","writeI53ToU64Clamped","writeI53ToU64Signaling","readI53FromI64","readI53FromU64","convertI32PairToI53","convertU32PairToI53","getTempRet0","setTempRet0","exitJS","inetPton4","inetNtop4","inetPton6","inetNtop6","readSockaddr","writeSockaddr","emscriptenLog","readEmAsmArgs","jstoi_q","listenOnce","autoResumeAudioContext","dynCallLegacy","getDynCaller","dynCall","handleException","keepRuntimeAlive","runtimeKeepalivePush","runtimeKeepalivePop","callUserCallback","maybeExit","asmjsMangle","HandleAllocator","getNativeTypeSize","STACK_SIZE","STACK_ALIGN","POINTER_SIZE","ASSERTIONS","reallyNegative","unSign","strLen","reSign","formatString","intArrayToString","AsciiToString","lengthBytesUTF16","UTF32ToString","stringToUTF32","lengthBytesUTF32","stringToNewUTF8","registerKeyEventCallback","maybeCStringToJsString","findEventTarget","getBoundingClientRect","fillMouseEventData","registerMouseEventCallback","registerWheelEventCallback","registerUiEventCallback","registerFocusEventCallback","fillDeviceOrientationEventData","registerDeviceOrientationEventCallback","fillDeviceMotionEventData","registerDeviceMotionEventCallback","screenOrientation","fillOrientationChangeEventData","registerOrientationChangeEventCallback","fillFullscreenChangeEventData","registerFullscreenChangeEventCallback","JSEvents_requestFullscreen","JSEvents_resizeCanvasForFullscreen","registerRestoreOldStyle","hideEverythingExceptGivenElement","restoreHiddenElements","setLetterbox","softFullscreenResizeWebGLRenderTarget","doRequestFullscreen","fillPointerlockChangeEventData","registerPointerlockChangeEventCallback","registerPointerlockErrorEventCallback","requestPointerLock","fillVisibilityChangeEventData","registerVisibilityChangeEventCallback","registerTouchEventCallback","fillGamepadEventData","registerGamepadEventCallback","registerBeforeUnloadEventCallback","fillBatteryEventData","battery","registerBatteryEventCallback","setCanvasElementSize","getCanvasElementSize","jsStackTrace","getCallstack","convertPCtoSourceLocation","checkWasiClock","wasiRightsToMuslOFlags","wasiOFlagsToMuslOFlags","createDyncallWrapper","safeSetTimeout","setImmediateWrapped","clearImmediateWrapped","polyfillSetImmediate","registerPostMainLoop","registerPreMainLoop","getPromise","makePromise","idsToPromises","makePromiseCallback","ExceptionInfo","findMatchingCatch","Browser_asyncPrepareDataCounter","safeRequestAnimationFrame","arraySum","addDays","getSocketFromFD","getSocketAddress","FS_unlink","FS_mkdirTree","_setNetworkCallback","heapObjectForWebGLType","toTypedArrayIndex","webgl_enable_ANGLE_instanced_arrays","webgl_enable_OES_vertex_array_object","webgl_enable_WEBGL_draw_buffers","webgl_enable_WEBGL_multi_draw","webgl_enable_EXT_polygon_offset_clamp","webgl_enable_EXT_clip_control","webgl_enable_WEBGL_polygon_mode","emscriptenWebGLGet","computeUnpackAlignedImageSize","colorChannelsInGlTextureFormat","emscriptenWebGLGetTexPixelData","emscriptenWebGLGetUniform","webglGetUniformLocation","webglPrepareUniformLocationsBeforeFirstUse","webglGetLeftBracePos","emscriptenWebGLGetVertexAttrib","__glGetActiveAttribOrUniform","writeGLArray","registerWebGlEventCallback","runAndAbortIfError","ALLOC_NORMAL","ALLOC_STACK","allocate","writeStringToMemory","writeAsciiToMemory","setErrNo","demangle","stackTrace"];In.forEach(he);var kn=["run","addOnPreRun","addOnInit","addOnPreMain","addOnExit","addOnPostRun","addRunDependency","removeRunDependency","out","err","callMain","abort","wasmMemory","writeStackCookie","checkStackCookie","convertI32PairToI53Checked","stackSave","stackRestore","stackAlloc","ptrToString","zeroMemory","getHeapMax","growMemory","ENV","ERRNO_CODES","strError","DNS","Protocols","Sockets","initRandomFill","randomFill","timers","warnOnce","readEmAsmArgsArray","jstoi_s","getExecutableName","asyncLoad","alignMemory","mmapAlloc","wasmTable","noExitRuntime","getCFunc","uleb128Encode","sigToWasmTypes","generateFuncType","convertJsFunctionToWasm","freeTableIndexes","functionsInTableMap","getEmptyTableSlot","updateTableMap","getFunctionAddress","PATH","PATH_FS","UTF8Decoder","UTF8ArrayToString","stringToUTF8Array","lengthBytesUTF8","intArrayFromString","stringToAscii","UTF16Decoder","stringToUTF8OnStack","writeArrayToMemory","JSEvents","specialHTMLTargets","findCanvasEventTarget","currentFullscreenStrategy","restoreOldWindowedStyle","UNWIND_CACHE","ExitStatus","getEnvStrings","doReadv","doWritev","promiseMap","uncaughtExceptionCount","exceptionLast","exceptionCaught","Browser","getPreloadedImageData__data","wget","MONTH_DAYS_REGULAR","MONTH_DAYS_LEAP","MONTH_DAYS_REGULAR_CUMULATIVE","MONTH_DAYS_LEAP_CUMULATIVE","isLeapYear","ydayFromDate","SYSCALLS","preloadPlugins","FS_createPreloadedFile","FS_modeStringToFlags","FS_getMode","FS_stdin_getChar_buffer","FS_stdin_getChar","FS_createPath","FS_createDevice","FS_readFile","FS","FS_createDataFile","FS_createLazyFile","MEMFS","TTY","PIPEFS","SOCKFS","tempFixedLengthArray","miniTempWebGLFloatBuffers","miniTempWebGLIntBuffers","GL","AL","GLUT","EGL","GLEW","IDBStore","SDL","SDL_gfx","allocateUTF8","allocateUTF8OnStack","print","printErr"];kn.forEach(fe);var jn;var Bn;H=function e(){if(!jn)Nn();if(!jn)H=e};function Ln(){pn();x()}function Nn(){if(z>0){return}Ln();if(!Bn){Bn=1;B();if(z>0){return}}function e(){if(jn)return;jn=1;r["calledRun"]=1;if(p)return;L();o(r);r["onRuntimeInitialized"]?.();A(!r["_main"],'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]');N()}if(r["setStatus"]){r["setStatus"]("Running...");setTimeout((()=>{setTimeout((()=>r["setStatus"]("")),1);e()}),1)}else{e()}w()}if(r["preInit"]){if(typeof r["preInit"]=="function")r["preInit"]=[r["preInit"]];while(r["preInit"].length>0){r["preInit"].pop()()}}Nn();n=i;for(const e of Object.keys(r)){if(!(e in t)){Object.defineProperty(t,e,{configurable:true,get(){q(`Access to module property ('${e}') is no longer possible via the module constructor argument; Instead, use the result of the module constructor.`)}})}}return n}})();const k={EPDF_HasMetaText:[["number","string"],"boolean"],EPDF_PNG_EncodeRGBA:[["number","number","number","number","number","number"],"number"],EPDF_RenderAnnotBitmap:[["number","number","number","number","number","number"],"boolean"],EPDF_SetMetaText:[["number","string","number"],"boolean"],EPDFAnnot_ClearColor:[["number","number"],"boolean"],EPDFAnnot_GenerateAppearance:[["number"],"boolean"],EPDFAnnot_GenerateAppearanceWithBlend:[["number","number"],"boolean"],EPDFAnnot_GetBlendMode:[["number"],"number"],EPDFAnnot_GetBorderDashPattern:[["number","number","number"],"boolean"],EPDFAnnot_GetBorderDashPatternCount:[["number"],"number"],EPDFAnnot_GetBorderEffect:[["number","number"],"boolean"],EPDFAnnot_GetBorderStyle:[["number","number"],"number"],EPDFAnnot_GetColor:[["number","number","number","number","number"],"boolean"],EPDFAnnot_GetDefaultAppearance:[["number","number","number","number","number","number"],"boolean"],EPDFAnnot_GetIcon:[["number"],"number"],EPDFAnnot_GetIntent:[["number","number","number"],"number"],EPDFAnnot_GetLineEndings:[["number","number","number"],"boolean"],EPDFAnnot_GetOpacity:[["number","number"],"boolean"],EPDFAnnot_GetRectangleDifferences:[["number","number","number","number","number"],"boolean"],EPDFAnnot_GetRichContent:[["number","number","number"],"number"],EPDFAnnot_GetTextAlignment:[["number"],"number"],EPDFAnnot_GetVerticalAlignment:[["number"],"number"],EPDFAnnot_SetBorderDashPattern:[["number","number","number"],"boolean"],EPDFAnnot_SetBorderStyle:[["number","number","number"],"boolean"],EPDFAnnot_SetColor:[["number","number","number","number","number"],"boolean"],EPDFAnnot_SetDefaultAppearance:[["number","number","number","number","number","number"],"boolean"],EPDFAnnot_SetIcon:[["number","number"],"boolean"],EPDFAnnot_SetIntent:[["number","string"],"boolean"],EPDFAnnot_SetLine:[["number","number","number"],"boolean"],EPDFAnnot_SetLineEndings:[["number","number","number"],"boolean"],EPDFAnnot_SetLinkedAnnot:[["number","string","number"],"boolean"],EPDFAnnot_SetOpacity:[["number","number"],"boolean"],EPDFAnnot_SetTextAlignment:[["number","number"],"boolean"],EPDFAnnot_SetVerticalAlignment:[["number","number"],"boolean"],EPDFAnnot_SetVertices:[["number","number","number"],"boolean"],EPDFPage_CreateAnnot:[["number","number"],"number"],EPDFPage_GetAnnotByName:[["number","number"],"number"],EPDFPage_GetAnnotCountRaw:[["number","number"],"number"],EPDFPage_GetAnnotRaw:[["number","number","number"],"number"],EPDFPage_RemoveAnnotByName:[["number","number"],"boolean"],EPDFPage_RemoveAnnotRaw:[["number","number","number"],"boolean"],EPDFText_RedactInQuads:[["number","number","number","boolean","boolean"],"boolean"],EPDFText_RedactInRect:[["number","number","boolean","boolean"],"boolean"],FORM_CanRedo:[["number","number"],"boolean"],FORM_CanUndo:[["number","number"],"boolean"],FORM_DoDocumentAAction:[["number","number"],null],FORM_DoDocumentJSAction:[["number"],null],FORM_DoDocumentOpenAction:[["number"],null],FORM_DoPageAAction:[["number","number","number"],null],FORM_ForceToKillFocus:[["number"],"boolean"],FORM_GetFocusedAnnot:[["number","number","number"],"boolean"],FORM_GetFocusedText:[["number","number","number","number"],"number"],FORM_GetSelectedText:[["number","number","number","number"],"number"],FORM_IsIndexSelected:[["number","number","number"],"boolean"],FORM_OnAfterLoadPage:[["number","number"],null],FORM_OnBeforeClosePage:[["number","number"],null],FORM_OnChar:[["number","number","number","number"],"boolean"],FORM_OnFocus:[["number","number","number","number","number"],"boolean"],FORM_OnKeyDown:[["number","number","number","number"],"boolean"],FORM_OnKeyUp:[["number","number","number","number"],"boolean"],FORM_OnLButtonDoubleClick:[["number","number","number","number","number"],"boolean"],FORM_OnLButtonDown:[["number","number","number","number","number"],"boolean"],FORM_OnLButtonUp:[["number","number","number","number","number"],"boolean"],FORM_OnMouseMove:[["number","number","number","number","number"],"boolean"],FORM_OnMouseWheel:[["number","number","number","number","number","number"],"boolean"],FORM_OnRButtonDown:[["number","number","number","number","number"],"boolean"],FORM_OnRButtonUp:[["number","number","number","number","number"],"boolean"],FORM_Redo:[["number","number"],"boolean"],FORM_ReplaceAndKeepSelection:[["number","number","number"],null],FORM_ReplaceSelection:[["number","number","number"],null],FORM_SelectAllText:[["number","number"],"boolean"],FORM_SetFocusedAnnot:[["number","number"],"boolean"],FORM_SetIndexSelected:[["number","number","number","boolean"],"boolean"],FORM_Undo:[["number","number"],"boolean"],FPDF_AddInstalledFont:[["number","number","number"],null],FPDF_CloseDocument:[["number"],null],FPDF_ClosePage:[["number"],null],FPDF_CloseXObject:[["number"],null],FPDF_CopyViewerPreferences:[["number","number"],"boolean"],FPDF_CountNamedDests:[["number"],"number"],FPDF_CreateClipPath:[["number","number","number","number"],"number"],FPDF_CreateNewDocument:[[],"number"],FPDF_DestroyClipPath:[["number"],null],FPDF_DestroyLibrary:[[],null],FPDF_DeviceToPage:[["number","number","number","number","number","number","number","number","number","number"],"boolean"],FPDF_DocumentHasValidCrossReferenceTable:[["number"],"boolean"],FPDF_FFLDraw:[["number","number","number","number","number","number","number","number","number"],null],FPDF_FreeDefaultSystemFontInfo:[["number"],null],FPDF_GetDefaultSystemFontInfo:[[],"number"],FPDF_GetDefaultTTFMap:[[],"number"],FPDF_GetDefaultTTFMapCount:[[],"number"],FPDF_GetDefaultTTFMapEntry:[["number"],"number"],FPDF_GetDocPermissions:[["number"],"number"],FPDF_GetDocUserPermissions:[["number"],"number"],FPDF_GetFileIdentifier:[["number","number","number","number"],"number"],FPDF_GetFileVersion:[["number","number"],"boolean"],FPDF_GetFormType:[["number"],"number"],FPDF_GetLastError:[[],"number"],FPDF_GetMetaText:[["number","string","number","number"],"number"],FPDF_GetNamedDest:[["number","number","number","number"],"number"],FPDF_GetNamedDestByName:[["number","string"],"number"],FPDF_GetPageAAction:[["number","number"],"number"],FPDF_GetPageBoundingBox:[["number","number"],"boolean"],FPDF_GetPageCount:[["number"],"number"],FPDF_GetPageHeight:[["number"],"number"],FPDF_GetPageHeightF:[["number"],"number"],FPDF_GetPageLabel:[["number","number","number","number"],"number"],FPDF_GetPageSizeByIndex:[["number","number","number","number"],"number"],FPDF_GetPageSizeByIndexF:[["number","number","number"],"boolean"],FPDF_GetPageWidth:[["number"],"number"],FPDF_GetPageWidthF:[["number"],"number"],FPDF_GetSecurityHandlerRevision:[["number"],"number"],FPDF_GetSignatureCount:[["number"],"number"],FPDF_GetSignatureObject:[["number","number"],"number"],FPDF_GetTrailerEnds:[["number","number","number"],"number"],FPDF_GetXFAPacketContent:[["number","number","number","number","number"],"boolean"],FPDF_GetXFAPacketCount:[["number"],"number"],FPDF_GetXFAPacketName:[["number","number","number","number"],"number"],FPDF_ImportNPagesToOne:[["number","number","number","number","number"],"number"],FPDF_ImportPages:[["number","number","string","number"],"boolean"],FPDF_ImportPagesByIndex:[["number","number","number","number","number"],"boolean"],FPDF_InitLibrary:[[],null],FPDF_InitLibraryWithConfig:[["number"],null],FPDF_LoadCustomDocument:[["number","string"],"number"],FPDF_LoadDocument:[["number","string"],"number"],FPDF_LoadMemDocument:[["number","number","string"],"number"],FPDF_LoadMemDocument64:[["number","number","string"],"number"],FPDF_LoadPage:[["number","number"],"number"],FPDF_LoadXFA:[["number"],"boolean"],FPDF_MovePages:[["number","number","number","number"],"boolean"],FPDF_NewFormObjectFromXObject:[["number"],"number"],FPDF_NewXObjectFromPage:[["number","number","number"],"number"],FPDF_PageToDevice:[["number","number","number","number","number","number","number","number","number","number"],"boolean"],FPDF_RemoveFormFieldHighlight:[["number"],null],FPDF_RenderPage_Close:[["number"],null],FPDF_RenderPage_Continue:[["number","number"],"number"],FPDF_RenderPageBitmap:[["number","number","number","number","number","number","number","number"],null],FPDF_RenderPageBitmap_Start:[["number","number","number","number","number","number","number","number","number"],"number"],FPDF_RenderPageBitmapWithColorScheme_Start:[["number","number","number","number","number","number","number","number","number","number"],"number"],FPDF_RenderPageBitmapWithMatrix:[["number","number","number","number","number"],null],FPDF_SaveAsCopy:[["number","number","number"],"boolean"],FPDF_SaveWithVersion:[["number","number","number","number"],"boolean"],FPDF_SetFormFieldHighlightAlpha:[["number","number"],null],FPDF_SetFormFieldHighlightColor:[["number","number","number"],null],FPDF_SetSandBoxPolicy:[["number","boolean"],null],FPDF_SetSystemFontInfo:[["number"],null],FPDF_StructElement_Attr_CountChildren:[["number"],"number"],FPDF_StructElement_Attr_GetBlobValue:[["number","number","number","number"],"boolean"],FPDF_StructElement_Attr_GetBooleanValue:[["number","number"],"boolean"],FPDF_StructElement_Attr_GetChildAtIndex:[["number","number"],"number"],FPDF_StructElement_Attr_GetCount:[["number"],"number"],FPDF_StructElement_Attr_GetName:[["number","number","number","number","number"],"boolean"],FPDF_StructElement_Attr_GetNumberValue:[["number","number"],"boolean"],FPDF_StructElement_Attr_GetStringValue:[["number","number","number","number"],"boolean"],FPDF_StructElement_Attr_GetType:[["number"],"number"],FPDF_StructElement_Attr_GetValue:[["number","string"],"number"],FPDF_StructElement_CountChildren:[["number"],"number"],FPDF_StructElement_GetActualText:[["number","number","number"],"number"],FPDF_StructElement_GetAltText:[["number","number","number"],"number"],FPDF_StructElement_GetAttributeAtIndex:[["number","number"],"number"],FPDF_StructElement_GetAttributeCount:[["number"],"number"],FPDF_StructElement_GetChildAtIndex:[["number","number"],"number"],FPDF_StructElement_GetChildMarkedContentID:[["number","number"],"number"],FPDF_StructElement_GetID:[["number","number","number"],"number"],FPDF_StructElement_GetLang:[["number","number","number"],"number"],FPDF_StructElement_GetMarkedContentID:[["number"],"number"],FPDF_StructElement_GetMarkedContentIdAtIndex:[["number","number"],"number"],FPDF_StructElement_GetMarkedContentIdCount:[["number"],"number"],FPDF_StructElement_GetObjType:[["number","number","number"],"number"],FPDF_StructElement_GetParent:[["number"],"number"],FPDF_StructElement_GetStringAttribute:[["number","string","number","number"],"number"],FPDF_StructElement_GetTitle:[["number","number","number"],"number"],FPDF_StructElement_GetType:[["number","number","number"],"number"],FPDF_StructTree_Close:[["number"],null],FPDF_StructTree_CountChildren:[["number"],"number"],FPDF_StructTree_GetChildAtIndex:[["number","number"],"number"],FPDF_StructTree_GetForPage:[["number"],"number"],FPDF_VIEWERREF_GetDuplex:[["number"],"number"],FPDF_VIEWERREF_GetName:[["number","string","number","number"],"number"],FPDF_VIEWERREF_GetNumCopies:[["number"],"number"],FPDF_VIEWERREF_GetPrintPageRange:[["number"],"number"],FPDF_VIEWERREF_GetPrintPageRangeCount:[["number"],"number"],FPDF_VIEWERREF_GetPrintPageRangeElement:[["number","number"],"number"],FPDF_VIEWERREF_GetPrintScaling:[["number"],"boolean"],FPDFAction_GetDest:[["number","number"],"number"],FPDFAction_GetFilePath:[["number","number","number"],"number"],FPDFAction_GetType:[["number"],"number"],FPDFAction_GetURIPath:[["number","number","number","number"],"number"],FPDFAnnot_AddFileAttachment:[["number","number"],"number"],FPDFAnnot_AddInkStroke:[["number","number","number"],"number"],FPDFAnnot_AppendAttachmentPoints:[["number","number"],"boolean"],FPDFAnnot_AppendObject:[["number","number"],"boolean"],FPDFAnnot_CountAttachmentPoints:[["number"],"number"],FPDFAnnot_GetAP:[["number","number","number","number"],"number"],FPDFAnnot_GetAttachmentPoints:[["number","number","number"],"boolean"],FPDFAnnot_GetBorder:[["number","number","number","number"],"boolean"],FPDFAnnot_GetColor:[["number","number","number","number","number","number"],"boolean"],FPDFAnnot_GetFileAttachment:[["number"],"number"],FPDFAnnot_GetFlags:[["number"],"number"],FPDFAnnot_GetFocusableSubtypes:[["number","number","number"],"boolean"],FPDFAnnot_GetFocusableSubtypesCount:[["number"],"number"],FPDFAnnot_GetFontColor:[["number","number","number","number","number"],"boolean"],FPDFAnnot_GetFontSize:[["number","number","number"],"boolean"],FPDFAnnot_GetFormAdditionalActionJavaScript:[["number","number","number","number","number"],"number"],FPDFAnnot_GetFormControlCount:[["number","number"],"number"],FPDFAnnot_GetFormControlIndex:[["number","number"],"number"],FPDFAnnot_GetFormFieldAlternateName:[["number","number","number","number"],"number"],FPDFAnnot_GetFormFieldAtPoint:[["number","number","number"],"number"],FPDFAnnot_GetFormFieldExportValue:[["number","number","number","number"],"number"],FPDFAnnot_GetFormFieldFlags:[["number","number"],"number"],FPDFAnnot_GetFormFieldName:[["number","number","number","number"],"number"],FPDFAnnot_GetFormFieldType:[["number","number"],"number"],FPDFAnnot_GetFormFieldValue:[["number","number","number","number"],"number"],FPDFAnnot_GetInkListCount:[["number"],"number"],FPDFAnnot_GetInkListPath:[["number","number","number","number"],"number"],FPDFAnnot_GetLine:[["number","number","number"],"boolean"],FPDFAnnot_GetLink:[["number"],"number"],FPDFAnnot_GetLinkedAnnot:[["number","string"],"number"],FPDFAnnot_GetNumberValue:[["number","string","number"],"boolean"],FPDFAnnot_GetObject:[["number","number"],"number"],FPDFAnnot_GetObjectCount:[["number"],"number"],FPDFAnnot_GetOptionCount:[["number","number"],"number"],FPDFAnnot_GetOptionLabel:[["number","number","number","number","number"],"number"],FPDFAnnot_GetRect:[["number","number"],"boolean"],FPDFAnnot_GetStringValue:[["number","string","number","number"],"number"],FPDFAnnot_GetSubtype:[["number"],"number"],FPDFAnnot_GetValueType:[["number","string"],"number"],FPDFAnnot_GetVertices:[["number","number","number"],"number"],FPDFAnnot_HasAttachmentPoints:[["number"],"boolean"],FPDFAnnot_HasKey:[["number","string"],"boolean"],FPDFAnnot_IsChecked:[["number","number"],"boolean"],FPDFAnnot_IsObjectSupportedSubtype:[["number"],"boolean"],FPDFAnnot_IsOptionSelected:[["number","number","number"],"boolean"],FPDFAnnot_IsSupportedSubtype:[["number"],"boolean"],FPDFAnnot_RemoveInkList:[["number"],"boolean"],FPDFAnnot_RemoveObject:[["number","number"],"boolean"],FPDFAnnot_SetAP:[["number","number","number"],"boolean"],FPDFAnnot_SetAttachmentPoints:[["number","number","number"],"boolean"],FPDFAnnot_SetBorder:[["number","number","number","number"],"boolean"],FPDFAnnot_SetColor:[["number","number","number","number","number","number"],"boolean"],FPDFAnnot_SetFlags:[["number","number"],"boolean"],FPDFAnnot_SetFocusableSubtypes:[["number","number","number"],"boolean"],FPDFAnnot_SetFontColor:[["number","number","number","number","number"],"boolean"],FPDFAnnot_SetFormFieldFlags:[["number","number","number"],"boolean"],FPDFAnnot_SetRect:[["number","number"],"boolean"],FPDFAnnot_SetStringValue:[["number","string","number"],"boolean"],FPDFAnnot_SetURI:[["number","number"],"boolean"],FPDFAnnot_UpdateObject:[["number","number"],"boolean"],FPDFAttachment_GetFile:[["number","number","number","number"],"boolean"],FPDFAttachment_GetName:[["number","number","number"],"number"],FPDFAttachment_GetStringValue:[["number","string","number","number"],"number"],FPDFAttachment_GetSubtype:[["number","number","number"],"number"],FPDFAttachment_GetValueType:[["number","string"],"number"],FPDFAttachment_HasKey:[["number","string"],"boolean"],FPDFAttachment_SetFile:[["number","number","number","number"],"boolean"],FPDFAttachment_SetStringValue:[["number","string","number"],"boolean"],FPDFAvail_Create:[["number","number"],"number"],FPDFAvail_Destroy:[["number"],null],FPDFAvail_GetDocument:[["number","string"],"number"],FPDFAvail_GetFirstPageNum:[["number"],"number"],FPDFAvail_IsDocAvail:[["number","number"],"number"],FPDFAvail_IsFormAvail:[["number","number"],"number"],FPDFAvail_IsLinearized:[["number"],"number"],FPDFAvail_IsPageAvail:[["number","number","number"],"number"],FPDFBitmap_Create:[["number","number","number"],"number"],FPDFBitmap_CreateEx:[["number","number","number","number","number"],"number"],FPDFBitmap_Destroy:[["number"],null],FPDFBitmap_FillRect:[["number","number","number","number","number","number"],"boolean"],FPDFBitmap_GetBuffer:[["number"],"number"],FPDFBitmap_GetFormat:[["number"],"number"],FPDFBitmap_GetHeight:[["number"],"number"],FPDFBitmap_GetStride:[["number"],"number"],FPDFBitmap_GetWidth:[["number"],"number"],FPDFBookmark_Find:[["number","number"],"number"],FPDFBookmark_GetAction:[["number"],"number"],FPDFBookmark_GetCount:[["number"],"number"],FPDFBookmark_GetDest:[["number","number"],"number"],FPDFBookmark_GetFirstChild:[["number","number"],"number"],FPDFBookmark_GetNextSibling:[["number","number"],"number"],FPDFBookmark_GetTitle:[["number","number","number"],"number"],FPDFCatalog_IsTagged:[["number"],"boolean"],FPDFCatalog_SetLanguage:[["number","string"],"boolean"],FPDFClipPath_CountPaths:[["number"],"number"],FPDFClipPath_CountPathSegments:[["number","number"],"number"],FPDFClipPath_GetPathSegment:[["number","number","number"],"number"],FPDFDest_GetDestPageIndex:[["number","number"],"number"],FPDFDest_GetLocationInPage:[["number","number","number","number","number","number","number"],"boolean"],FPDFDest_GetView:[["number","number","number"],"number"],FPDFDoc_AddAttachment:[["number","number"],"number"],FPDFDoc_CloseJavaScriptAction:[["number"],null],FPDFDoc_DeleteAttachment:[["number","number"],"boolean"],FPDFDOC_ExitFormFillEnvironment:[["number"],null],FPDFDoc_GetAttachment:[["number","number"],"number"],FPDFDoc_GetAttachmentCount:[["number"],"number"],FPDFDoc_GetJavaScriptAction:[["number","number"],"number"],FPDFDoc_GetJavaScriptActionCount:[["number"],"number"],FPDFDoc_GetPageMode:[["number"],"number"],FPDFDOC_InitFormFillEnvironment:[["number","number"],"number"],FPDFFont_Close:[["number"],null],FPDFFont_GetAscent:[["number","number","number"],"boolean"],FPDFFont_GetBaseFontName:[["number","number","number"],"number"],FPDFFont_GetDescent:[["number","number","number"],"boolean"],FPDFFont_GetFamilyName:[["number","number","number"],"number"],FPDFFont_GetFlags:[["number"],"number"],FPDFFont_GetFontData:[["number","number","number","number"],"boolean"],FPDFFont_GetGlyphPath:[["number","number","number"],"number"],FPDFFont_GetGlyphWidth:[["number","number","number","number"],"boolean"],FPDFFont_GetIsEmbedded:[["number"],"number"],FPDFFont_GetItalicAngle:[["number","number"],"boolean"],FPDFFont_GetWeight:[["number"],"number"],FPDFFormObj_CountObjects:[["number"],"number"],FPDFFormObj_GetObject:[["number","number"],"number"],FPDFFormObj_RemoveObject:[["number","number"],"boolean"],FPDFGlyphPath_CountGlyphSegments:[["number"],"number"],FPDFGlyphPath_GetGlyphPathSegment:[["number","number"],"number"],FPDFImageObj_GetBitmap:[["number"],"number"],FPDFImageObj_GetIccProfileDataDecoded:[["number","number","number","number","number"],"boolean"],FPDFImageObj_GetImageDataDecoded:[["number","number","number"],"number"],FPDFImageObj_GetImageDataRaw:[["number","number","number"],"number"],FPDFImageObj_GetImageFilter:[["number","number","number","number"],"number"],FPDFImageObj_GetImageFilterCount:[["number"],"number"],FPDFImageObj_GetImageMetadata:[["number","number","number"],"boolean"],FPDFImageObj_GetImagePixelSize:[["number","number","number"],"boolean"],FPDFImageObj_GetRenderedBitmap:[["number","number","number"],"number"],FPDFImageObj_LoadJpegFile:[["number","number","number","number"],"boolean"],FPDFImageObj_LoadJpegFileInline:[["number","number","number","number"],"boolean"],FPDFImageObj_SetBitmap:[["number","number","number","number"],"boolean"],FPDFImageObj_SetMatrix:[["number","number","number","number","number","number","number"],"boolean"],FPDFJavaScriptAction_GetName:[["number","number","number"],"number"],FPDFJavaScriptAction_GetScript:[["number","number","number"],"number"],FPDFLink_CloseWebLinks:[["number"],null],FPDFLink_CountQuadPoints:[["number"],"number"],FPDFLink_CountRects:[["number","number"],"number"],FPDFLink_CountWebLinks:[["number"],"number"],FPDFLink_Enumerate:[["number","number","number"],"boolean"],FPDFLink_GetAction:[["number"],"number"],FPDFLink_GetAnnot:[["number","number"],"number"],FPDFLink_GetAnnotRect:[["number","number"],"boolean"],FPDFLink_GetDest:[["number","number"],"number"],FPDFLink_GetLinkAtPoint:[["number","number","number"],"number"],FPDFLink_GetLinkZOrderAtPoint:[["number","number","number"],"number"],FPDFLink_GetQuadPoints:[["number","number","number"],"boolean"],FPDFLink_GetRect:[["number","number","number","number","number","number","number"],"boolean"],FPDFLink_GetTextRange:[["number","number","number","number"],"boolean"],FPDFLink_GetURL:[["number","number","number","number"],"number"],FPDFLink_LoadWebLinks:[["number"],"number"],FPDFPage_CloseAnnot:[["number"],null],FPDFPage_CountObjects:[["number"],"number"],FPDFPage_CreateAnnot:[["number","number"],"number"],FPDFPage_Delete:[["number","number"],null],FPDFPage_Flatten:[["number","number"],"number"],FPDFPage_FormFieldZOrderAtPoint:[["number","number","number","number"],"number"],FPDFPage_GenerateContent:[["number"],"boolean"],FPDFPage_GetAnnot:[["number","number"],"number"],FPDFPage_GetAnnotCount:[["number"],"number"],FPDFPage_GetAnnotIndex:[["number","number"],"number"],FPDFPage_GetArtBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetBleedBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetCropBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetDecodedThumbnailData:[["number","number","number"],"number"],FPDFPage_GetMediaBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetObject:[["number","number"],"number"],FPDFPage_GetRawThumbnailData:[["number","number","number"],"number"],FPDFPage_GetRotation:[["number"],"number"],FPDFPage_GetThumbnailAsBitmap:[["number"],"number"],FPDFPage_GetTrimBox:[["number","number","number","number","number"],"boolean"],FPDFPage_HasFormFieldAtPoint:[["number","number","number","number"],"number"],FPDFPage_HasTransparency:[["number"],"boolean"],FPDFPage_InsertClipPath:[["number","number"],null],FPDFPage_InsertObject:[["number","number"],null],FPDFPage_InsertObjectAtIndex:[["number","number","number"],"boolean"],FPDFPage_New:[["number","number","number","number"],"number"],FPDFPage_RemoveAnnot:[["number","number"],"boolean"],FPDFPage_RemoveObject:[["number","number"],"boolean"],FPDFPage_SetArtBox:[["number","number","number","number","number"],null],FPDFPage_SetBleedBox:[["number","number","number","number","number"],null],FPDFPage_SetCropBox:[["number","number","number","number","number"],null],FPDFPage_SetMediaBox:[["number","number","number","number","number"],null],FPDFPage_SetRotation:[["number","number"],null],FPDFPage_SetTrimBox:[["number","number","number","number","number"],null],FPDFPage_TransformAnnots:[["number","number","number","number","number","number","number"],null],FPDFPage_TransFormWithClip:[["number","number","number"],"boolean"],FPDFPageObj_AddMark:[["number","string"],"number"],FPDFPageObj_CountMarks:[["number"],"number"],FPDFPageObj_CreateNewPath:[["number","number"],"number"],FPDFPageObj_CreateNewRect:[["number","number","number","number"],"number"],FPDFPageObj_CreateTextObj:[["number","number","number"],"number"],FPDFPageObj_Destroy:[["number"],null],FPDFPageObj_GetBounds:[["number","number","number","number","number"],"boolean"],FPDFPageObj_GetClipPath:[["number"],"number"],FPDFPageObj_GetDashArray:[["number","number","number"],"boolean"],FPDFPageObj_GetDashCount:[["number"],"number"],FPDFPageObj_GetDashPhase:[["number","number"],"boolean"],FPDFPageObj_GetFillColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_GetIsActive:[["number","number"],"boolean"],FPDFPageObj_GetLineCap:[["number"],"number"],FPDFPageObj_GetLineJoin:[["number"],"number"],FPDFPageObj_GetMark:[["number","number"],"number"],FPDFPageObj_GetMarkedContentID:[["number"],"number"],FPDFPageObj_GetMatrix:[["number","number"],"boolean"],FPDFPageObj_GetRotatedBounds:[["number","number"],"boolean"],FPDFPageObj_GetStrokeColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_GetStrokeWidth:[["number","number"],"boolean"],FPDFPageObj_GetType:[["number"],"number"],FPDFPageObj_HasTransparency:[["number"],"boolean"],FPDFPageObj_NewImageObj:[["number"],"number"],FPDFPageObj_NewTextObj:[["number","string","number"],"number"],FPDFPageObj_RemoveMark:[["number","number"],"boolean"],FPDFPageObj_SetBlendMode:[["number","string"],null],FPDFPageObj_SetDashArray:[["number","number","number","number"],"boolean"],FPDFPageObj_SetDashPhase:[["number","number"],"boolean"],FPDFPageObj_SetFillColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_SetIsActive:[["number","boolean"],"boolean"],FPDFPageObj_SetLineCap:[["number","number"],"boolean"],FPDFPageObj_SetLineJoin:[["number","number"],"boolean"],FPDFPageObj_SetMatrix:[["number","number"],"boolean"],FPDFPageObj_SetStrokeColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_SetStrokeWidth:[["number","number"],"boolean"],FPDFPageObj_Transform:[["number","number","number","number","number","number","number"],null],FPDFPageObj_TransformClipPath:[["number","number","number","number","number","number","number"],null],FPDFPageObj_TransformF:[["number","number"],"boolean"],FPDFPageObjMark_CountParams:[["number"],"number"],FPDFPageObjMark_GetName:[["number","number","number","number"],"boolean"],FPDFPageObjMark_GetParamBlobValue:[["number","string","number","number","number"],"boolean"],FPDFPageObjMark_GetParamIntValue:[["number","string","number"],"boolean"],FPDFPageObjMark_GetParamKey:[["number","number","number","number","number"],"boolean"],FPDFPageObjMark_GetParamStringValue:[["number","string","number","number","number"],"boolean"],FPDFPageObjMark_GetParamValueType:[["number","string"],"number"],FPDFPageObjMark_RemoveParam:[["number","number","string"],"boolean"],FPDFPageObjMark_SetBlobParam:[["number","number","number","string","number","number"],"boolean"],FPDFPageObjMark_SetIntParam:[["number","number","number","string","number"],"boolean"],FPDFPageObjMark_SetStringParam:[["number","number","number","string","string"],"boolean"],FPDFPath_BezierTo:[["number","number","number","number","number","number","number"],"boolean"],FPDFPath_Close:[["number"],"boolean"],FPDFPath_CountSegments:[["number"],"number"],FPDFPath_GetDrawMode:[["number","number","number"],"boolean"],FPDFPath_GetPathSegment:[["number","number"],"number"],FPDFPath_LineTo:[["number","number","number"],"boolean"],FPDFPath_MoveTo:[["number","number","number"],"boolean"],FPDFPath_SetDrawMode:[["number","number","boolean"],"boolean"],FPDFPathSegment_GetClose:[["number"],"boolean"],FPDFPathSegment_GetPoint:[["number","number","number"],"boolean"],FPDFPathSegment_GetType:[["number"],"number"],FPDFSignatureObj_GetByteRange:[["number","number","number"],"number"],FPDFSignatureObj_GetContents:[["number","number","number"],"number"],FPDFSignatureObj_GetDocMDPPermission:[["number"],"number"],FPDFSignatureObj_GetReason:[["number","number","number"],"number"],FPDFSignatureObj_GetSubFilter:[["number","number","number"],"number"],FPDFSignatureObj_GetTime:[["number","number","number"],"number"],FPDFText_ClosePage:[["number"],null],FPDFText_CountChars:[["number"],"number"],FPDFText_CountRects:[["number","number","number"],"number"],FPDFText_FindClose:[["number"],null],FPDFText_FindNext:[["number"],"boolean"],FPDFText_FindPrev:[["number"],"boolean"],FPDFText_FindStart:[["number","number","number","number"],"number"],FPDFText_GetBoundedText:[["number","number","number","number","number","number","number"],"number"],FPDFText_GetCharAngle:[["number","number"],"number"],FPDFText_GetCharBox:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetCharIndexAtPos:[["number","number","number","number","number"],"number"],FPDFText_GetCharIndexFromTextIndex:[["number","number"],"number"],FPDFText_GetCharOrigin:[["number","number","number","number"],"boolean"],FPDFText_GetFillColor:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetFontInfo:[["number","number","number","number","number"],"number"],FPDFText_GetFontSize:[["number","number"],"number"],FPDFText_GetFontWeight:[["number","number"],"number"],FPDFText_GetLooseCharBox:[["number","number","number"],"boolean"],FPDFText_GetMatrix:[["number","number","number"],"boolean"],FPDFText_GetRect:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetSchCount:[["number"],"number"],FPDFText_GetSchResultIndex:[["number"],"number"],FPDFText_GetStrokeColor:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetText:[["number","number","number","number"],"number"],FPDFText_GetTextIndexFromCharIndex:[["number","number"],"number"],FPDFText_GetTextObject:[["number","number"],"number"],FPDFText_GetUnicode:[["number","number"],"number"],FPDFText_HasUnicodeMapError:[["number","number"],"number"],FPDFText_IsGenerated:[["number","number"],"number"],FPDFText_IsHyphen:[["number","number"],"number"],FPDFText_LoadCidType2Font:[["number","number","number","string","number","number"],"number"],FPDFText_LoadFont:[["number","number","number","number","boolean"],"number"],FPDFText_LoadPage:[["number"],"number"],FPDFText_LoadStandardFont:[["number","string"],"number"],FPDFText_SetCharcodes:[["number","number","number"],"boolean"],FPDFText_SetText:[["number","number"],"boolean"],FPDFTextObj_GetFont:[["number"],"number"],FPDFTextObj_GetFontSize:[["number","number"],"boolean"],FPDFTextObj_GetRenderedBitmap:[["number","number","number","number"],"number"],FPDFTextObj_GetText:[["number","number","number","number"],"number"],FPDFTextObj_GetTextRenderMode:[["number"],"number"],FPDFTextObj_SetTextRenderMode:[["number","number"],"boolean"],PDFiumExt_CloseFileWriter:[["number"],null],PDFiumExt_CloseFormFillInfo:[["number"],null],PDFiumExt_ExitFormFillEnvironment:[["number"],null],PDFiumExt_GetFileWriterData:[["number","number","number"],"number"],PDFiumExt_GetFileWriterSize:[["number"],"number"],PDFiumExt_Init:[[],null],PDFiumExt_InitFormFillEnvironment:[["number","number"],"number"],PDFiumExt_OpenFileWriter:[[],"number"],PDFiumExt_OpenFormFillInfo:[[],"number"],PDFiumExt_SaveAsCopy:[["number","number"],"number"]};async function j(e){const t={pdfium:e};for(const n in k){const r=n;const o=k[r][0];const a=k[r][1];t[r]=e.cwrap(n,a,o)}return t}async function B(e){const t=await I(e);return j(t)}function L(e,t,n,r=100){let o=e.wasmExports.malloc(r);for(let t=0;t<r;t++){e.HEAP8[o+t]=0}const a=t(o,r);let i;if(a>r){e.wasmExports.free(o);o=e.wasmExports.malloc(a);for(let t=0;t<a;t++){e.HEAP8[o+t]=0}t(o,a);i=n(o)}else{i=n(o)}e.wasmExports.free(o);return i}function N(e,t){const n=t(0,0);const r=e.wasmExports.malloc(n);t(r,n);const o=new ArrayBuffer(n);const a=new DataView(o);for(let t=0;t<n;t++){a.setInt8(t,e.getValue(r+t,"i8"))}e.wasmExports.free(r);return o}class V{constructor(e){this.pdfium=e;this.docs=new Map}setDocument(e,t,n){let r=this.docs.get(e);if(!r){r=new U(t,n,this.pdfium);this.docs.set(e,r)}}getContext(e){return this.docs.get(e)}closeDocument(e){const t=this.docs.get(e);if(!t)return false;t.dispose();this.docs.delete(e);return true}}class U{constructor(e,t,n){this.filePtr=e;this.docPtr=t;this.pageCache=new W(n,t)}acquirePage(e){return this.pageCache.acquire(e)}borrowPage(e,t){return this.pageCache.borrowPage(e,t)}dispose(){this.pageCache.forceReleaseAll();this.pageCache.pdf.FPDF_CloseDocument(this.docPtr);this.pageCache.pdf.pdfium.wasmExports.free(this.filePtr)}}class W{constructor(e,t){this.pdf=e;this.docPtr=t;this.cache=new Map}acquire(e){let t=this.cache.get(e);if(!t){const n=this.pdf.FPDF_LoadPage(this.docPtr,e);t=new $(this.pdf,this.docPtr,e,n,(()=>{this.cache.delete(e)}));this.cache.set(e,t)}t.clearExpiryTimer();t.bumpRefCount();return t}borrowPage(e,t){const n=this.cache.has(e);const r=this.acquire(e);try{return t(r)}finally{n?r.release():r.disposeImmediate()}}forceReleaseAll(){for(const e of this.cache.values()){e.disposeImmediate()}this.cache.clear()}}const z=5e3;class ${constructor(e,t,n,r,o){this.pdf=e;this.docPtr=t;this.pageIdx=n;this.pagePtr=r;this.onFinalDispose=o;this.refCount=0;this.disposed=false}bumpRefCount(){if(this.disposed)throw new Error("Context already disposed");this.refCount++}clearExpiryTimer(){if(this.expiryTimer){clearTimeout(this.expiryTimer);this.expiryTimer=void 0}}release(){if(this.disposed)return;this.refCount--;if(this.refCount===0){this.expiryTimer=setTimeout((()=>this.disposeImmediate()),z)}}disposeImmediate(){if(this.disposed)return;this.disposed=true;if(this.textPagePtr!==void 0){this.pdf.FPDFText_ClosePage(this.textPagePtr)}if(this.formHandle!==void 0){this.pdf.FORM_OnBeforeClosePage(this.pagePtr,this.formHandle);this.pdf.PDFiumExt_ExitFormFillEnvironment(this.formHandle)}if(this.formInfoPtr!==void 0){this.pdf.PDFiumExt_CloseFormFillInfo(this.formInfoPtr)}this.pdf.FPDF_ClosePage(this.pagePtr);this.onFinalDispose()}getTextPage(){this.ensureAlive();if(this.textPagePtr===void 0){this.textPagePtr=this.pdf.FPDFText_LoadPage(this.pagePtr)}return this.textPagePtr}getFormHandle(){this.ensureAlive();if(this.formHandle===void 0){this.formInfoPtr=this.pdf.PDFiumExt_OpenFormFillInfo();this.formHandle=this.pdf.PDFiumExt_InitFormFillEnvironment(this.docPtr,this.formInfoPtr);this.pdf.FORM_OnAfterLoadPage(this.pagePtr,this.formHandle)}return this.formHandle}withAnnotation(e,t){this.ensureAlive();const n=this.pdf.FPDFPage_GetAnnot(this.pagePtr,e);try{return t(n)}finally{this.pdf.FPDFPage_CloseAnnot(n)}}ensureAlive(){if(this.disposed)throw new Error("PageContext already disposed")}}const H=e=>e;const X={MAX_TOTAL_MEMORY:2*1024*1024*1024};const Y={MEMORY:X};const K="PDFiumEngine";const J="MemoryManager";class q{constructor(e,t){this.pdfiumModule=e;this.logger=t;this.allocations=new Map;this.totalAllocated=0}malloc(e){if(this.totalAllocated+e>Y.MEMORY.MAX_TOTAL_MEMORY){throw new Error(`Total memory usage would exceed limit: ${this.totalAllocated+e} > ${Y.MEMORY.MAX_TOTAL_MEMORY}`)}const t=this.pdfiumModule.pdfium.wasmExports.malloc(e);if(!t){throw new Error(`Failed to allocate ${e} bytes`)}const n={ptr:H(t),size:e,timestamp:Date.now(),stack:this.logger.isEnabled("debug")?(new Error).stack:void 0};this.allocations.set(t,n);this.totalAllocated+=e;return H(t)}free(e){const t=this.allocations.get(e);if(!t){this.logger.warn(K,J,`Freeing untracked pointer: ${e}`)}else{this.totalAllocated-=t.size;this.allocations.delete(e)}this.pdfiumModule.pdfium.wasmExports.free(e)}getStats(){return{totalAllocated:this.totalAllocated,allocationCount:this.allocations.size,allocations:this.logger.isEnabled("debug")?Array.from(this.allocations.values()):[]}}checkLeaks(){if(this.allocations.size>0){this.logger.warn(K,J,`Potential memory leak: ${this.allocations.size} unfreed allocations`);for(const[e,t]of this.allocations){this.logger.warn(K,J,`  - ${e}: ${t.size} bytes`,t.stack)}}}}const Q="PDFiumEngine";const Z="Engine";class ee extends Error{constructor(e){super(e);this.name="OffscreenCanvasError"}}const te=(e,t="image/webp",n)=>{if(typeof OffscreenCanvas==="undefined"){return Promise.reject(new ee("OffscreenCanvas is not available in this environment. This converter is intended for browser use only. Falling back to WASM-based image encoding."))}const r=e();const o=new ImageData(r.data,r.width,r.height);const a=new OffscreenCanvas(o.width,o.height);a.getContext("2d").putImageData(o,0,0);return a.convertToBlob({type:t,quality:n})};class ne{constructor(e,t={}){this.pdfiumModule=e;const{logger:n=new x,imageDataConverter:r=te}=t;this.cache=new V(this.pdfiumModule);this.logger=n;this.imageDataConverter=r;this.memoryManager=new q(this.pdfiumModule,this.logger);if(this.logger.isEnabled("debug")){setInterval((()=>{this.memoryManager.checkLeaks()}),1e4)}}initialize(){this.logger.debug(Q,Z,"initialize");this.logger.perf(Q,Z,`Initialize`,"Begin","General");this.pdfiumModule.PDFiumExt_Init();this.logger.perf(Q,Z,`Initialize`,"End","General");return e.resolve(true)}destroy(){this.logger.debug(Q,Z,"destroy");this.logger.perf(Q,Z,`Destroy`,"Begin","General");this.pdfiumModule.FPDF_DestroyLibrary();this.logger.perf(Q,Z,`Destroy`,"End","General");return e.resolve(true)}openDocumentUrl(n,r){const o=(r==null?void 0:r.mode)??"auto";const a=(r==null?void 0:r.password)??"";this.logger.debug(Q,Z,"openDocumentUrl called",n.url,o);const i=e.create();(async()=>{try{const e=await this.fetchFullAndOpen(n,a);e.wait((e=>i.resolve(e)),(e=>i.reject(e.reason)))}catch(e){this.logger.error(Q,Z,"openDocumentUrl error",e);i.reject({code:t.Unknown,message:String(e)})}})();return i}async checkRangeSupport(e){try{this.logger.debug(Q,Z,"checkRangeSupport",e);const t=await fetch(e,{method:"HEAD"});const n=t.headers.get("Content-Length");const r=t.headers.get("Accept-Ranges");if(r==="bytes"){return{supportsRanges:true,fileLength:parseInt(n??"0"),content:null}}const o=await fetch(e,{headers:{Range:"bytes=0-1"}});if(o.status===200){const e=await o.arrayBuffer();return{supportsRanges:false,fileLength:parseInt(n??"0"),content:e}}return{supportsRanges:o.status===206,fileLength:parseInt(n??"0"),content:null}}catch(e){this.logger.error(Q,Z,"checkRangeSupport failed",e);throw new Error("Failed to check range support: "+e)}}async fetchFullAndOpen(e,t){this.logger.debug(Q,Z,"fetchFullAndOpen",e.url);const n=await fetch(e.url);if(!n.ok){throw new Error(`Could not fetch PDF: ${n.statusText}`)}const r=await n.arrayBuffer();const o={id:e.id,name:e.name,content:r};return this.openDocumentBuffer(o,{password:t})}async openDocumentWithRangeRequest(e,t,n){this.logger.debug(Q,Z,"openDocumentWithRangeRequest",e.url);const r=n??(await this.retrieveFileLength(e.url)).fileLength;const o=(t,n)=>{const r=new XMLHttpRequest;r.open("GET",e.url,false);r.overrideMimeType("text/plain; charset=x-user-defined");r.setRequestHeader("Range",`bytes=${t}-${t+n-1}`);r.send(null);if(r.status===206||r.status===200){return this.convertResponseToUint8Array(r.responseText)}throw new Error(`Range request failed with status ${r.status}`)};return this.openDocumentFromLoader({id:e.id,fileLength:r,callback:o},t)}async retrieveFileLength(e){this.logger.debug(Q,Z,"retrieveFileLength",e);const t=await fetch(e,{method:"HEAD"});if(!t.ok){throw new Error(`Failed HEAD request for file length: ${t.statusText}`)}const n=t.headers.get("Content-Length")||"0";const r=parseInt(n,10)||0;if(!r){throw new Error(`Content-Length not found or zero.`)}return{fileLength:r}}convertResponseToUint8Array(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++){t[n]=e.charCodeAt(n)&255}return t}openDocumentBuffer(t,n){this.logger.debug(Q,Z,"openDocumentBuffer",t,n);this.logger.perf(Q,Z,`OpenDocumentBuffer`,"Begin",t.id);const r=new Uint8Array(t.content);const o=r.length;const a=this.memoryManager.malloc(o);this.pdfiumModule.pdfium.HEAPU8.set(r,a);const i=this.pdfiumModule.FPDF_LoadMemDocument(a,o,(n==null?void 0:n.password)??"");if(!i){const n=this.pdfiumModule.FPDF_GetLastError();this.logger.error(Q,Z,`FPDF_LoadMemDocument failed with ${n}`);this.memoryManager.free(a);this.logger.perf(Q,Z,`OpenDocumentBuffer`,"End",t.id);return e.reject({code:n,message:`FPDF_LoadMemDocument failed`})}const s=this.pdfiumModule.FPDF_GetPageCount(i);const u=[];const F=this.memoryManager.malloc(8);for(let n=0;n<s;n++){const r=this.pdfiumModule.FPDF_GetPageSizeByIndexF(i,n,F);if(!r){const n=this.pdfiumModule.FPDF_GetLastError();this.logger.error(Q,Z,`FPDF_GetPageSizeByIndexF failed with ${n}`);this.memoryManager.free(F);this.pdfiumModule.FPDF_CloseDocument(i);this.memoryManager.free(a);this.logger.perf(Q,Z,`OpenDocumentBuffer`,"End",t.id);return e.reject({code:n,message:`FPDF_GetPageSizeByIndexF failed`})}const o={index:n,size:{width:this.pdfiumModule.pdfium.getValue(F,"float"),height:this.pdfiumModule.pdfium.getValue(F+4,"float")}};u.push(o)}this.memoryManager.free(F);const m={id:t.id,name:t.name,pageCount:s,pages:u};this.cache.setDocument(t.id,a,i);this.logger.perf(Q,Z,`OpenDocumentBuffer`,"End",t.id);return e.resolve(m)}openDocumentFromLoader(t,n=""){const{fileLength:r,callback:o,...a}=t;this.logger.debug(Q,Z,"openDocumentFromLoader",a,n);this.logger.perf(Q,Z,`OpenDocumentFromLoader`,"Begin",a.id);const i=(e,t,n,a)=>{try{this.logger.debug(Q,Z,"readBlock",t,a,n);if(t<0||t>=r){this.logger.error(Q,Z,"Offset out of bounds:",t);return 0}const e=o(t,a);const i=new Uint8Array(this.pdfiumModule.pdfium.HEAPU8.buffer,n,e.length);i.set(e);return e.length}catch(e){this.logger.error(Q,Z,"ReadBlock error:",e);return 0}};const s=this.pdfiumModule.pdfium.addFunction(i,"iiiii");const u=12;const F=this.memoryManager.malloc(u);this.pdfiumModule.pdfium.setValue(F,r,"i32");this.pdfiumModule.pdfium.setValue(F+4,s,"i32");this.pdfiumModule.pdfium.setValue(F+8,0,"i32");const m=this.pdfiumModule.FPDF_LoadCustomDocument(F,n);if(!m){const t=this.pdfiumModule.FPDF_GetLastError();this.logger.error(Q,Z,`FPDF_LoadCustomDocument failed with ${t}`);this.memoryManager.free(F);this.logger.perf(Q,Z,`OpenDocumentFromLoader`,"End",a.id);return e.reject({code:t,message:`FPDF_LoadCustomDocument failed`})}const l=this.pdfiumModule.FPDF_GetPageCount(m);const d=[];const c=this.memoryManager.malloc(8);for(let t=0;t<l;t++){const n=this.pdfiumModule.FPDF_GetPageSizeByIndexF(m,t,c);if(!n){const t=this.pdfiumModule.FPDF_GetLastError();this.logger.error(Q,Z,`FPDF_GetPageSizeByIndexF failed with ${t}`);this.memoryManager.free(c);this.pdfiumModule.FPDF_CloseDocument(m);this.memoryManager.free(F);this.logger.perf(Q,Z,`OpenDocumentFromLoader`,"End",a.id);return e.reject({code:t,message:`FPDF_GetPageSizeByIndexF failed`})}const r={index:t,size:{width:this.pdfiumModule.pdfium.getValue(c,"float"),height:this.pdfiumModule.pdfium.getValue(c+4,"float")}};d.push(r)}this.memoryManager.free(c);const _={id:a.id,name:a.name,pageCount:l,pages:d};this.cache.setDocument(a.id,F,m);this.logger.perf(Q,Z,`OpenDocumentFromLoader`,"End",a.id);return e.resolve(_)}getMetadata(r){this.logger.debug(Q,Z,"getMetadata",r);this.logger.perf(Q,Z,`GetMetadata`,"Begin",r.id);const o=this.cache.getContext(r.id);if(!o){this.logger.perf(Q,Z,`GetMetadata`,"End",r.id);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const a=this.readMetaText(o.docPtr,"CreationDate");const i=this.readMetaText(o.docPtr,"ModDate");const s={title:this.readMetaText(o.docPtr,"Title"),author:this.readMetaText(o.docPtr,"Author"),subject:this.readMetaText(o.docPtr,"Subject"),keywords:this.readMetaText(o.docPtr,"Keywords"),producer:this.readMetaText(o.docPtr,"Producer"),creator:this.readMetaText(o.docPtr,"Creator"),creationDate:a?n(a)??null:null,modificationDate:i?n(i)??null:null};this.logger.perf(Q,Z,`GetMetadata`,"End",r.id);return e.resolve(s)}setMetadata(n,r){this.logger.debug(Q,Z,"setMetadata",n,r);this.logger.perf(Q,Z,"SetMetadata","Begin",n.id);const o=this.cache.getContext(n.id);if(!o){this.logger.perf(Q,Z,"SetMetadata","End",n.id);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const a=[["title","Title"],["author","Author"],["subject","Subject"],["keywords","Keywords"],["producer","Producer"],["creator","Creator"]];let i=true;for(const[e,t]of a){const n=r[e];if(n===void 0)continue;const a=n===null?null:n;if(!this.setMetaText(o.docPtr,t,a))i=false}const s=(e,t)=>{const n=r[e];if(n===void 0)return;if(n===null){if(!this.setMetaText(o.docPtr,t,null))i=false;return}const a=n;const s=g(a);if(!this.setMetaText(o.docPtr,t,s))i=false};s("creationDate","CreationDate");s("modificationDate","ModDate");this.logger.perf(Q,Z,"SetMetadata","End",n.id);return i?e.resolve(true):e.reject({code:t.Unknown,message:"one or more metadata fields could not be written"})}getDocPermissions(n){this.logger.debug(Q,Z,"getDocPermissions",n);this.logger.perf(Q,Z,`getDocPermissions`,"Begin",n.id);const r=this.cache.getContext(n.id);if(!r){this.logger.perf(Q,Z,`getDocPermissions`,"End",n.id);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const o=this.pdfiumModule.FPDF_GetDocPermissions(r.docPtr);return e.resolve(o)}getDocUserPermissions(n){this.logger.debug(Q,Z,"getDocUserPermissions",n);this.logger.perf(Q,Z,`getDocUserPermissions`,"Begin",n.id);const r=this.cache.getContext(n.id);if(!r){this.logger.perf(Q,Z,`getDocUserPermissions`,"End",n.id);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const o=this.pdfiumModule.FPDF_GetDocUserPermissions(r.docPtr);return e.resolve(o)}getSignatures(n){this.logger.debug(Q,Z,"getSignatures",n);this.logger.perf(Q,Z,`GetSignatures`,"Begin",n.id);const r=this.cache.getContext(n.id);if(!r){this.logger.perf(Q,Z,`GetSignatures`,"End",n.id);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const o=[];const a=this.pdfiumModule.FPDF_GetSignatureCount(r.docPtr);for(let e=0;e<a;e++){const t=this.pdfiumModule.FPDF_GetSignatureObject(r.docPtr,e);const n=N(this.pdfiumModule.pdfium,((e,n)=>this.pdfiumModule.FPDFSignatureObj_GetContents(t,e,n)));const a=N(this.pdfiumModule.pdfium,((e,n)=>this.pdfiumModule.FPDFSignatureObj_GetByteRange(t,e,n)*4));const i=N(this.pdfiumModule.pdfium,((e,n)=>this.pdfiumModule.FPDFSignatureObj_GetSubFilter(t,e,n)));const s=L(this.pdfiumModule.pdfium,((e,n)=>this.pdfiumModule.FPDFSignatureObj_GetReason(t,e,n)),this.pdfiumModule.pdfium.UTF16ToString);const u=L(this.pdfiumModule.pdfium,((e,n)=>this.pdfiumModule.FPDFSignatureObj_GetTime(t,e,n)),this.pdfiumModule.pdfium.UTF8ToString);const F=this.pdfiumModule.FPDFSignatureObj_GetDocMDPPermission(t);o.push({contents:n,byteRange:a,subFilter:i,reason:s,time:u,docMDP:F})}this.logger.perf(Q,Z,`GetSignatures`,"End",n.id);return e.resolve(o)}getBookmarks(n){this.logger.debug(Q,Z,"getBookmarks",n);this.logger.perf(Q,Z,`GetBookmarks`,"Begin",n.id);const r=this.cache.getContext(n.id);if(!r){this.logger.perf(Q,Z,`getBookmarks`,"End",n.id);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const o=this.readPdfBookmarks(r.docPtr,0);this.logger.perf(Q,Z,`GetBookmarks`,"End",n.id);return e.resolve({bookmarks:o})}renderPage(e,t,n){this.logger.debug(Q,Z,"renderPage",e,t,n);this.logger.perf(Q,Z,`RenderPage`,"Begin",`${e.id}-${t.index}`);const r={origin:{x:0,y:0},size:t.size};const o=this.renderRectEncoded(e,t,r,n);this.logger.perf(Q,Z,`RenderPage`,"End",`${e.id}-${t.index}`);return o}renderPageRect(e,t,n,r){this.logger.debug(Q,Z,"renderPageRect",e,t,n,r);this.logger.perf(Q,Z,`RenderPageRect`,"Begin",`${e.id}-${t.index}`);const o=this.renderRectEncoded(e,t,n,r);this.logger.perf(Q,Z,`RenderPageRect`,"End",`${e.id}-${t.index}`);return o}getAllAnnotations(n){this.logger.debug(Q,Z,"getAllAnnotations-with-progress",n);this.logger.perf(Q,Z,"GetAllAnnotations","Begin",n.id);const o=e.create();let a=false;o.wait(r,(e=>{if(e.type==="abort")a=true}));const i=this.cache.getContext(n.id);if(!i){this.logger.perf(Q,Z,"GetAllAnnotations","End",n.id);o.reject({code:t.DocNotOpen,message:"document does not open"});return o}const s=100;const u={};const F=e=>{if(a)return;const t=Math.min(e+s,n.pageCount);for(let r=e;r<t&&!a;++r){this.logger.debug(Q,Z,"GetAllAnnotations","Begin",n.id,r);const e=this.readPageAnnotationsRaw(i,n.pages[r]);u[r]=e;this.logger.debug(Q,Z,"GetAllAnnotations","End",n.id,r);o.progress({page:r,annotations:e})}if(a)return;if(t>=n.pageCount){this.logger.perf(Q,Z,"GetAllAnnotations","End",n.id);o.resolve(u);return}setTimeout((()=>F(t)),0)};F(0);return o}readAllAnnotations(e,t){const n={};for(let r=0;r<e.pageCount;r++){const o=this.readPageAnnotations(t,e.pages[r]);n[r]=o}return n}getPageAnnotations(n,r){this.logger.debug(Q,Z,"getPageAnnotations",n,r);this.logger.perf(Q,Z,`GetPageAnnotations`,"Begin",`${n.id}-${r.index}`);const o=this.cache.getContext(n.id);if(!o){this.logger.perf(Q,Z,`GetPageAnnotations`,"End",`${n.id}-${r.index}`);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const a=this.readPageAnnotations(o,r);this.logger.perf(Q,Z,`GetPageAnnotations`,"End",`${n.id}-${r.index}`);this.logger.debug(Q,Z,`GetPageAnnotations`,`${n.id}-${r.index}`,a);return e.resolve(a)}createPageAnnotation(n,r,s,u){this.logger.debug(Q,Z,"createPageAnnotation",n,r,s);this.logger.perf(Q,Z,`CreatePageAnnotation`,"Begin",`${n.id}-${r.index}`);const F=this.cache.getContext(n.id);if(!F){this.logger.perf(Q,Z,`CreatePageAnnotation`,"End",`${n.id}-${r.index}`);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const m=F.acquirePage(r.index);const l=this.pdfiumModule.EPDFPage_CreateAnnot(m.pagePtr,s.type);if(!l){this.logger.perf(Q,Z,`CreatePageAnnotation`,"End",`${n.id}-${r.index}`);m.release();return e.reject({code:t.CantCreateAnnot,message:"can not create annotation with specified type"})}if(!o(s.id)){s.id=a()}if(!this.setAnnotString(l,"NM",s.id)){this.pdfiumModule.FPDFPage_CloseAnnot(l);m.release();return e.reject({code:t.CantSetAnnotString,message:"can not set the name of the annotation"})}if(!this.setPageAnnoRect(r,m.pagePtr,l,s.rect)){this.pdfiumModule.FPDFPage_CloseAnnot(l);m.release();this.logger.perf(Q,Z,`CreatePageAnnotation`,"End",`${n.id}-${r.index}`);return e.reject({code:t.CantSetAnnotRect,message:"can not set the rect of the annotation"})}let d=false;switch(s.type){case i.INK:d=this.addInkStroke(r,m.pagePtr,l,s);break;case i.STAMP:d=this.addStampContent(F.docPtr,r,m.pagePtr,l,s,u==null?void 0:u.imageData);break;case i.TEXT:d=this.addTextContent(r,m.pagePtr,l,s);break;case i.FREETEXT:d=this.addFreeTextContent(r,m.pagePtr,l,s);break;case i.LINE:d=this.addLineContent(r,m.pagePtr,l,s);break;case i.POLYLINE:case i.POLYGON:d=this.addPolyContent(r,m.pagePtr,l,s);break;case i.CIRCLE:case i.SQUARE:d=this.addShapeContent(r,m.pagePtr,l,s);break;case i.UNDERLINE:case i.STRIKEOUT:case i.SQUIGGLY:case i.HIGHLIGHT:d=this.addTextMarkupContent(r,m.pagePtr,l,s);break}if(!d){this.pdfiumModule.FPDFPage_RemoveAnnot(m.pagePtr,l);m.release();this.logger.perf(Q,Z,`CreatePageAnnotation`,"End",`${n.id}-${r.index}`);return e.reject({code:t.CantSetAnnotContent,message:"can not add content of the annotation"})}if(s.blendMode!==void 0){this.pdfiumModule.EPDFAnnot_GenerateAppearanceWithBlend(l,s.blendMode)}else{this.pdfiumModule.EPDFAnnot_GenerateAppearance(l)}this.pdfiumModule.FPDFPage_GenerateContent(m.pagePtr);this.pdfiumModule.FPDFPage_CloseAnnot(l);m.release();this.logger.perf(Q,Z,`CreatePageAnnotation`,"End",`${n.id}-${r.index}`);return e.resolve(s.id)}updatePageAnnotation(n,r,o){this.logger.debug(Q,Z,"updatePageAnnotation",n,r,o);this.logger.perf(Q,Z,"UpdatePageAnnotation","Begin",`${n.id}-${r.index}`);const a=this.cache.getContext(n.id);if(!a){this.logger.perf(Q,Z,"UpdatePageAnnotation","End",`${n.id}-${r.index}`);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const s=a.acquirePage(r.index);const u=this.getAnnotationByName(s.pagePtr,o.id);if(!u){s.release();this.logger.perf(Q,Z,"UpdatePageAnnotation","End",`${n.id}-${r.index}`);return e.reject({code:t.NotFound,message:"annotation not found"})}if(!this.setPageAnnoRect(r,s.pagePtr,u,o.rect)){this.pdfiumModule.FPDFPage_CloseAnnot(u);s.release();this.logger.perf(Q,Z,"UpdatePageAnnotation","End",`${n.id}-${r.index}`);return e.reject({code:t.CantSetAnnotRect,message:"failed to move annotation"})}let F=false;switch(o.type){case i.INK:{if(!this.pdfiumModule.FPDFAnnot_RemoveInkList(u))break;F=this.addInkStroke(r,s.pagePtr,u,o);break}case i.STAMP:{F=this.addStampContent(a.docPtr,r,s.pagePtr,u,o);break}case i.TEXT:{F=this.addTextContent(r,s.pagePtr,u,o);break}case i.FREETEXT:{F=this.addFreeTextContent(r,s.pagePtr,u,o);break}case i.CIRCLE:case i.SQUARE:{F=this.addShapeContent(r,s.pagePtr,u,o);break}case i.LINE:{F=this.addLineContent(r,s.pagePtr,u,o);break}case i.POLYGON:case i.POLYLINE:{F=this.addPolyContent(r,s.pagePtr,u,o);break}case i.HIGHLIGHT:case i.UNDERLINE:case i.STRIKEOUT:case i.SQUIGGLY:{F=this.addTextMarkupContent(r,s.pagePtr,u,o);break}default:F=false}if(F){if(o.blendMode!==void 0){this.pdfiumModule.EPDFAnnot_GenerateAppearanceWithBlend(u,o.blendMode)}else{this.pdfiumModule.EPDFAnnot_GenerateAppearance(u)}this.pdfiumModule.FPDFPage_GenerateContent(s.pagePtr)}this.pdfiumModule.FPDFPage_CloseAnnot(u);s.release();this.logger.perf(Q,Z,"UpdatePageAnnotation","End",`${n.id}-${r.index}`);return F?e.resolve(true):e.reject({code:t.CantSetAnnotContent,message:"failed to update annotation"})}removePageAnnotation(n,r,o){this.logger.debug(Q,Z,"removePageAnnotation",n,r,o);this.logger.perf(Q,Z,`RemovePageAnnotation`,"Begin",`${n.id}-${r.index}`);const a=this.cache.getContext(n.id);if(!a){this.logger.perf(Q,Z,`RemovePageAnnotation`,"End",`${n.id}-${r.index}`);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const i=a.acquirePage(r.index);let s=false;s=this.removeAnnotationByName(i.pagePtr,o.id);if(!s){this.logger.error(Q,Z,`FPDFPage_RemoveAnnot Failed`,`${n.id}-${r.index}`)}else{s=this.pdfiumModule.FPDFPage_GenerateContent(i.pagePtr);if(!s){this.logger.error(Q,Z,`FPDFPage_GenerateContent Failed`,`${n.id}-${r.index}`)}}i.release();this.logger.perf(Q,Z,`RemovePageAnnotation`,"End",`${n.id}-${r.index}`);return e.resolve(s)}getPageTextRects(n,r){this.logger.debug(Q,Z,"getPageTextRects",n,r);this.logger.perf(Q,Z,`GetPageTextRects`,"Begin",`${n.id}-${r.index}`);const o=this.cache.getContext(n.id);if(!o){this.logger.perf(Q,Z,`GetPageTextRects`,"End",`${n.id}-${r.index}`);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const a=o.acquirePage(r.index);const i=this.pdfiumModule.FPDFText_LoadPage(a.pagePtr);const s=this.readPageTextRects(r,a.docPtr,a.pagePtr,i);this.pdfiumModule.FPDFText_ClosePage(i);a.release();this.logger.perf(Q,Z,`GetPageTextRects`,"End",`${n.id}-${r.index}`);return e.resolve(s)}renderThumbnail(n,r,o){const{scaleFactor:a=1,...i}=o??{};this.logger.debug(Q,Z,"renderThumbnail",n,r,o);this.logger.perf(Q,Z,`RenderThumbnail`,"Begin",`${n.id}-${r.index}`);const s=this.cache.getContext(n.id);if(!s){this.logger.perf(Q,Z,`RenderThumbnail`,"End",`${n.id}-${r.index}`);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const u=this.renderPage(n,r,{scaleFactor:Math.max(a,.5),...i});this.logger.perf(Q,Z,`RenderThumbnail`,"End",`${n.id}-${r.index}`);return u}getAttachments(n){this.logger.debug(Q,Z,"getAttachments",n);this.logger.perf(Q,Z,`GetAttachments`,"Begin",n.id);const r=this.cache.getContext(n.id);if(!r){this.logger.perf(Q,Z,`GetAttachments`,"End",n.id);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const o=[];const a=this.pdfiumModule.FPDFDoc_GetAttachmentCount(r.docPtr);for(let e=0;e<a;e++){const t=this.readPdfAttachment(r.docPtr,e);o.push(t)}this.logger.perf(Q,Z,`GetAttachments`,"End",n.id);return e.resolve(o)}readAttachmentContent(n,r){this.logger.debug(Q,Z,"readAttachmentContent",n,r);this.logger.perf(Q,Z,`ReadAttachmentContent`,"Begin",n.id);const o=this.cache.getContext(n.id);if(!o){this.logger.perf(Q,Z,`ReadAttachmentContent`,"End",n.id);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const a=this.pdfiumModule.FPDFDoc_GetAttachment(o.docPtr,r.index);const i=this.memoryManager.malloc(4);if(!this.pdfiumModule.FPDFAttachment_GetFile(a,0,0,i)){this.memoryManager.free(i);this.logger.perf(Q,Z,`ReadAttachmentContent`,"End",n.id);return e.reject({code:t.CantReadAttachmentSize,message:"can not read attachment size"})}const s=this.pdfiumModule.pdfium.getValue(i,"i32")>>>0;const u=this.memoryManager.malloc(s);if(!this.pdfiumModule.FPDFAttachment_GetFile(a,u,s,i)){this.memoryManager.free(i);this.memoryManager.free(u);this.logger.perf(Q,Z,`ReadAttachmentContent`,"End",n.id);return e.reject({code:t.CantReadAttachmentContent,message:"can not read attachment content"})}const F=new ArrayBuffer(s);const m=new DataView(F);for(let e=0;e<s;e++){m.setInt8(e,this.pdfiumModule.pdfium.getValue(u+e,"i8"))}this.memoryManager.free(i);this.memoryManager.free(u);this.logger.perf(Q,Z,`ReadAttachmentContent`,"End",n.id);return e.resolve(F)}setFormFieldValue(n,r,o,a){this.logger.debug(Q,Z,"SetFormFieldValue",n,o,a);this.logger.perf(Q,Z,`SetFormFieldValue`,"Begin",`${n.id}-${o.id}`);const i=this.cache.getContext(n.id);if(!i){this.logger.debug(Q,Z,"SetFormFieldValue","document is not opened");this.logger.perf(Q,Z,`SetFormFieldValue`,"End",`${n.id}-${o.id}`);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const s=this.pdfiumModule.PDFiumExt_OpenFormFillInfo();const u=this.pdfiumModule.PDFiumExt_InitFormFillEnvironment(i.docPtr,s);const F=i.acquirePage(r.index);this.pdfiumModule.FORM_OnAfterLoadPage(F.pagePtr,u);const m=this.getAnnotationByName(F.pagePtr,o.id);if(!m){F.release();this.logger.perf(Q,Z,"SetFormFieldValue","End",`${n.id}-${r.index}`);return e.reject({code:t.NotFound,message:"annotation not found"})}if(!this.pdfiumModule.FORM_SetFocusedAnnot(u,m)){this.logger.debug(Q,Z,"SetFormFieldValue","failed to set focused annotation");this.logger.perf(Q,Z,`SetFormFieldValue`,"End",`${n.id}-${o.id}`);this.pdfiumModule.FPDFPage_CloseAnnot(m);this.pdfiumModule.FORM_OnBeforeClosePage(F.pagePtr,u);F.release();this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(u);this.pdfiumModule.PDFiumExt_CloseFormFillInfo(s);return e.reject({code:t.CantFocusAnnot,message:"failed to set focused annotation"})}switch(a.kind){case"text":{if(!this.pdfiumModule.FORM_SelectAllText(u,F.pagePtr)){this.logger.debug(Q,Z,"SetFormFieldValue","failed to select all text");this.logger.perf(Q,Z,`SetFormFieldValue`,"End",`${n.id}-${o.id}`);this.pdfiumModule.FORM_ForceToKillFocus(u);this.pdfiumModule.FPDFPage_CloseAnnot(m);this.pdfiumModule.FORM_OnBeforeClosePage(F.pagePtr,u);F.release();this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(u);this.pdfiumModule.PDFiumExt_CloseFormFillInfo(s);return e.reject({code:t.CantSelectText,message:"failed to select all text"})}const r=2*(a.text.length+1);const i=this.memoryManager.malloc(r);this.pdfiumModule.pdfium.stringToUTF16(a.text,i,r);this.pdfiumModule.FORM_ReplaceSelection(u,F.pagePtr,i);this.memoryManager.free(i)}break;case"selection":{if(!this.pdfiumModule.FORM_SetIndexSelected(u,F.pagePtr,a.index,a.isSelected)){this.logger.debug(Q,Z,"SetFormFieldValue","failed to set index selected");this.logger.perf(Q,Z,`SetFormFieldValue`,"End",`${n.id}-${o.id}`);this.pdfiumModule.FORM_ForceToKillFocus(u);this.pdfiumModule.FPDFPage_CloseAnnot(m);this.pdfiumModule.FORM_OnBeforeClosePage(F.pagePtr,u);F.release();this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(u);this.pdfiumModule.PDFiumExt_CloseFormFillInfo(s);return e.reject({code:t.CantSelectOption,message:"failed to set index selected"})}}break;case"checked":{const r=13;if(!this.pdfiumModule.FORM_OnChar(u,F.pagePtr,r,0)){this.logger.debug(Q,Z,"SetFormFieldValue","failed to set field checked");this.logger.perf(Q,Z,`SetFormFieldValue`,"End",`${n.id}-${o.id}`);this.pdfiumModule.FORM_ForceToKillFocus(u);this.pdfiumModule.FPDFPage_CloseAnnot(m);this.pdfiumModule.FORM_OnBeforeClosePage(F.pagePtr,u);F.release();this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(u);this.pdfiumModule.PDFiumExt_CloseFormFillInfo(s);return e.reject({code:t.CantCheckField,message:"failed to set field checked"})}}break}this.pdfiumModule.FORM_ForceToKillFocus(u);this.pdfiumModule.FPDFPage_CloseAnnot(m);this.pdfiumModule.FORM_OnBeforeClosePage(F.pagePtr,u);F.release();this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(u);this.pdfiumModule.PDFiumExt_CloseFormFillInfo(s);return e.resolve(true)}flattenPage(n,r,o){const{flag:a=s.Display}=o??{};this.logger.debug(Q,Z,"flattenPage",n,r,a);this.logger.perf(Q,Z,`flattenPage`,"Begin",n.id);const i=this.cache.getContext(n.id);if(!i){this.logger.perf(Q,Z,`flattenPage`,"End",n.id);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const u=i.acquirePage(r.index);const F=this.pdfiumModule.FPDFPage_Flatten(u.pagePtr,a);u.release();this.logger.perf(Q,Z,`flattenPage`,"End",n.id);return e.resolve(F)}extractPages(n,r){this.logger.debug(Q,Z,"extractPages",n,r);this.logger.perf(Q,Z,`ExtractPages`,"Begin",n.id);const o=this.cache.getContext(n.id);if(!o){this.logger.perf(Q,Z,`ExtractPages`,"End",n.id);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const a=this.pdfiumModule.FPDF_CreateNewDocument();if(!a){this.logger.perf(Q,Z,`ExtractPages`,"End",n.id);return e.reject({code:t.CantCreateNewDoc,message:"can not create new document"})}const i=this.memoryManager.malloc(r.length*4);for(let e=0;e<r.length;e++){this.pdfiumModule.pdfium.setValue(i+e*4,r[e],"i32")}if(!this.pdfiumModule.FPDF_ImportPagesByIndex(a,o.docPtr,i,r.length,0)){this.pdfiumModule.FPDF_CloseDocument(a);this.logger.perf(Q,Z,`ExtractPages`,"End",n.id);return e.reject({code:t.CantImportPages,message:"can not import pages to new document"})}const s=this.saveDocument(a);this.pdfiumModule.FPDF_CloseDocument(a);this.logger.perf(Q,Z,`ExtractPages`,"End",n.id);return e.resolve(s)}extractText(n,r){this.logger.debug(Q,Z,"extractText",n,r);this.logger.perf(Q,Z,`ExtractText`,"Begin",n.id);const o=this.cache.getContext(n.id);if(!o){this.logger.perf(Q,Z,`ExtractText`,"End",n.id);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const a=[];for(let e=0;e<r.length;e++){const t=o.acquirePage(r[e]);const n=this.pdfiumModule.FPDFText_LoadPage(t.pagePtr);const i=this.pdfiumModule.FPDFText_CountChars(n);const s=this.memoryManager.malloc((i+1)*2);this.pdfiumModule.FPDFText_GetText(n,0,i,s);const u=this.pdfiumModule.pdfium.UTF16ToString(s);this.memoryManager.free(s);a.push(u);this.pdfiumModule.FPDFText_ClosePage(n);t.release()}const i=a.join("\n\n");this.logger.perf(Q,Z,`ExtractText`,"End",n.id);return e.resolve(i)}getTextSlices(n,r){this.logger.debug(Q,Z,"getTextSlices",n,r);this.logger.perf(Q,Z,"GetTextSlices","Begin",n.id);if(r.length===0){this.logger.perf(Q,Z,"GetTextSlices","End",n.id);return e.resolve([])}const o=this.cache.getContext(n.id);if(!o){this.logger.perf(Q,Z,"GetTextSlices","End",n.id);return e.reject({code:t.DocNotOpen,message:"document does not open"})}try{const t=new Array(r.length);const a=new Map;r.forEach(((e,t)=>{(a.get(e.pageIndex)??a.set(e.pageIndex,[]).get(e.pageIndex)).push({slice:e,pos:t})}));for(const[e,n]of a){const r=o.acquirePage(e);const a=r.getTextPage();for(const{slice:e,pos:r}of n){const n=this.memoryManager.malloc(2*(e.charCount+1));this.pdfiumModule.FPDFText_GetText(a,e.charIndex,e.charCount,n);t[r]=u(this.pdfiumModule.pdfium.UTF16ToString(n));this.memoryManager.free(n)}r.release()}this.logger.perf(Q,Z,"GetTextSlices","End",n.id);return e.resolve(t)}catch(r){this.logger.error(Q,Z,"getTextSlices error",r);this.logger.perf(Q,Z,"GetTextSlices","End",n.id);return e.reject({code:t.Unknown,message:String(r)})}}merge(n){this.logger.debug(Q,Z,"merge",n);const r=n.map((e=>e.id)).join(".");this.logger.perf(Q,Z,`Merge`,"Begin",r);const o=this.pdfiumModule.FPDF_CreateNewDocument();if(!o){this.logger.perf(Q,Z,`Merge`,"End",r);return e.reject({code:t.CantCreateNewDoc,message:"can not create new document"})}const a=[];for(const i of n.reverse()){const n=new Uint8Array(i.content);const s=n.length;const u=this.memoryManager.malloc(s);this.pdfiumModule.pdfium.HEAPU8.set(n,u);const F=this.pdfiumModule.FPDF_LoadMemDocument(u,s,"");if(!F){const t=this.pdfiumModule.FPDF_GetLastError();this.logger.error(Q,Z,`FPDF_LoadMemDocument failed with ${t}`);this.memoryManager.free(u);for(const e of a){this.pdfiumModule.FPDF_CloseDocument(e.docPtr);this.memoryManager.free(e.filePtr)}this.logger.perf(Q,Z,`Merge`,"End",r);return e.reject({code:t,message:`FPDF_LoadMemDocument failed`})}a.push({filePtr:u,docPtr:F});if(!this.pdfiumModule.FPDF_ImportPages(o,F,"",0)){this.pdfiumModule.FPDF_CloseDocument(o);for(const e of a){this.pdfiumModule.FPDF_CloseDocument(e.docPtr);this.memoryManager.free(e.filePtr)}this.logger.perf(Q,Z,`Merge`,"End",r);return e.reject({code:t.CantImportPages,message:"can not import pages to new document"})}}const i=this.saveDocument(o);this.pdfiumModule.FPDF_CloseDocument(o);for(const e of a){this.pdfiumModule.FPDF_CloseDocument(e.docPtr);this.memoryManager.free(e.filePtr)}const s={id:`${Math.random()}`,content:i};this.logger.perf(Q,Z,`Merge`,"End",r);return e.resolve(s)}mergePages(n){const r=n.map((e=>`${e.docId}:${e.pageIndices.join(",")}`)).join("|");this.logger.debug(Q,Z,"mergePages",n);this.logger.perf(Q,Z,`MergePages`,"Begin",r);const o=this.pdfiumModule.FPDF_CreateNewDocument();if(!o){this.logger.perf(Q,Z,`MergePages`,"End",r);return e.reject({code:t.CantCreateNewDoc,message:"Cannot create new document"})}try{for(const e of[...n].reverse()){const t=this.cache.getContext(e.docId);if(!t){this.logger.warn(Q,Z,`Document ${e.docId} is not open, skipping`);continue}const n=this.pdfiumModule.FPDF_GetPageCount(t.docPtr);const r=e.pageIndices.filter((e=>e>=0&&e<n));if(r.length===0){continue}const a=r.map((e=>e+1)).join(",");try{if(!this.pdfiumModule.FPDF_ImportPages(o,t.docPtr,a,0)){throw new Error(`Failed to import pages ${a} from document ${e.docId}`)}}finally{}}const t=this.saveDocument(o);const a={id:`${Math.random()}`,content:t};this.logger.perf(Q,Z,`MergePages`,"End",r);return e.resolve(a)}catch(n){this.logger.error(Q,Z,"mergePages failed",n);this.logger.perf(Q,Z,`MergePages`,"End",r);return e.reject({code:t.CantImportPages,message:n instanceof Error?n.message:"Failed to merge pages"})}finally{if(o){this.pdfiumModule.FPDF_CloseDocument(o)}}}saveAsCopy(n){this.logger.debug(Q,Z,"saveAsCopy",n);this.logger.perf(Q,Z,`SaveAsCopy`,"Begin",n.id);const r=this.cache.getContext(n.id);if(!r){this.logger.perf(Q,Z,`SaveAsCopy`,"End",n.id);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const o=this.saveDocument(r.docPtr);this.logger.perf(Q,Z,`SaveAsCopy`,"End",n.id);return e.resolve(o)}closeDocument(n){this.logger.debug(Q,Z,"closeDocument",n);this.logger.perf(Q,Z,`CloseDocument`,"Begin",n.id);const r=this.cache.getContext(n.id);if(!r){this.logger.perf(Q,Z,`CloseDocument`,"End",n.id);return e.reject({code:t.DocNotOpen,message:"document does not open"})}r.dispose();this.logger.perf(Q,Z,`CloseDocument`,"End",n.id);return e.resolve(true)}addTextContent(e,t,n,r){if(!this.setPageAnnoRect(e,t,n,r.rect)){return false}if(!this.setAnnotString(n,"Contents",r.contents??"")){return false}if(!this.setAnnotString(n,"T",r.author||"")){return false}if(r.modified&&!this.setAnnotationDate(n,"M",r.modified)){return false}if(r.created&&!this.setAnnotationDate(n,"CreationDate",r.created)){return false}if(r.inReplyToId&&!this.setInReplyToId(t,n,r.inReplyToId)){return false}if(!this.setAnnotationIcon(n,r.icon||F.Comment)){return false}if(!this.setAnnotationFlags(n,r.flags||["print","noZoom","noRotate"])){return false}if(r.state&&!this.setAnnotString(n,"State",r.state)){return false}if(r.stateModel&&!this.setAnnotString(n,"StateModel",r.stateModel)){return false}return true}addFreeTextContent(e,t,n,r){if(r.created&&!this.setAnnotationDate(n,"CreationDate",r.created)){return false}if(r.flags&&!this.setAnnotationFlags(n,r.flags)){return false}if(r.modified&&!this.setAnnotationDate(n,"M",r.modified)){return false}if(!this.setBorderStyle(n,m.SOLID,0)){return false}if(!this.setAnnotString(n,"Contents",r.contents??"")){return false}if(!this.setPageAnnoRect(e,t,n,r.rect)){return false}if(!this.setAnnotString(n,"T",r.author||"")){return false}if(!this.setAnnotationOpacity(n,r.opacity??1)){return false}if(!this.setAnnotationTextAlignment(n,r.textAlign)){return false}if(!this.setAnnotationVerticalAlignment(n,r.verticalAlign)){return false}if(!this.setAnnotationDefaultAppearance(n,r.fontFamily,r.fontSize,r.fontColor)){return false}if(r.intent&&!this.setAnnotIntent(n,r.intent)){return false}if(!r.backgroundColor||r.backgroundColor==="transparent"){if(!this.pdfiumModule.EPDFAnnot_ClearColor(n,l.Color)){return false}}else if(!this.setAnnotationColor(n,r.backgroundColor??"#FFFFFF",l.Color)){return false}return true}addInkStroke(e,t,n,r){if(r.created&&!this.setAnnotationDate(n,"CreationDate",r.created)){return false}if(r.flags&&!this.setAnnotationFlags(n,r.flags)){return false}if(r.modified&&!this.setAnnotationDate(n,"M",r.modified)){return false}if(!this.setAnnotString(n,"Contents",r.contents??"")){return false}if(!this.setBorderStyle(n,m.SOLID,r.strokeWidth)){return false}if(!this.setPageAnnoRect(e,t,n,r.rect)){return false}if(!this.setInkList(e,n,r.inkList)){return false}if(!this.setAnnotString(n,"T",r.author||"")){return false}if(!this.setAnnotationOpacity(n,r.opacity??1)){return false}if(!this.setAnnotationColor(n,r.color??"#FFFF00",l.Color)){return false}return true}addLineContent(e,t,n,r){var o,a;if(r.created&&!this.setAnnotationDate(n,"CreationDate",r.created)){return false}if(r.flags&&!this.setAnnotationFlags(n,r.flags)){return false}if(r.modified&&!this.setAnnotationDate(n,"M",r.modified)){return false}if(!this.setPageAnnoRect(e,t,n,r.rect)){return false}if(!this.setLinePoints(e,n,r.linePoints.start,r.linePoints.end)){return false}if(!this.setLineEndings(n,((o=r.lineEndings)==null?void 0:o.start)??d.None,((a=r.lineEndings)==null?void 0:a.end)??d.None)){return false}if(!this.setAnnotString(n,"Contents",r.contents??"")){return false}if(!this.setAnnotString(n,"T",r.author||"")){return false}if(!this.setBorderStyle(n,r.strokeStyle,r.strokeWidth)){return false}if(!this.setBorderDashPattern(n,r.strokeDashArray??[])){return false}if(r.intent&&!this.setAnnotIntent(n,r.intent)){return false}if(!r.color||r.color==="transparent"){if(!this.pdfiumModule.EPDFAnnot_ClearColor(n,l.InteriorColor)){return false}}else if(!this.setAnnotationColor(n,r.color??"#FFFF00",l.InteriorColor)){return false}if(!this.setAnnotationOpacity(n,r.opacity??1)){return false}if(!this.setAnnotationColor(n,r.strokeColor??"#FFFF00",l.Color)){return false}return true}addPolyContent(e,t,n,r){var o,a;if(r.created&&!this.setAnnotationDate(n,"CreationDate",r.created)){return false}if(r.modified&&!this.setAnnotationDate(n,"M",r.modified)){return false}if(r.flags&&!this.setAnnotationFlags(n,r.flags)){return false}if(!this.setPageAnnoRect(e,t,n,r.rect)){return false}if(r.type===i.POLYLINE&&!this.setLineEndings(n,((o=r.lineEndings)==null?void 0:o.start)??d.None,((a=r.lineEndings)==null?void 0:a.end)??d.None)){return false}if(!this.setPdfAnnoVertices(e,n,r.vertices)){return false}if(!this.setAnnotString(n,"Contents",r.contents??"")){return false}if(!this.setAnnotString(n,"T",r.author||"")){return false}if(!this.setBorderStyle(n,r.strokeStyle,r.strokeWidth)){return false}if(!this.setBorderDashPattern(n,r.strokeDashArray??[])){return false}if(r.intent&&!this.setAnnotIntent(n,r.intent)){return false}if(!r.color||r.color==="transparent"){if(!this.pdfiumModule.EPDFAnnot_ClearColor(n,l.InteriorColor)){return false}}else if(!this.setAnnotationColor(n,r.color??"#FFFF00",l.InteriorColor)){return false}if(!this.setAnnotationOpacity(n,r.opacity??1)){return false}if(!this.setAnnotationColor(n,r.strokeColor??"#FFFF00",l.Color)){return false}return true}addShapeContent(e,t,n,r){if(r.created&&!this.setAnnotationDate(n,"CreationDate",r.created)){return false}if(r.modified&&!this.setAnnotationDate(n,"M",r.modified)){return false}if(!this.setPageAnnoRect(e,t,n,r.rect)){return false}if(!this.setAnnotString(n,"Contents",r.contents??"")){return false}if(!this.setAnnotString(n,"T",r.author||"")){return false}if(!this.setBorderStyle(n,r.strokeStyle,r.strokeWidth)){return false}if(!this.setBorderDashPattern(n,r.strokeDashArray??[])){return false}if(!this.setAnnotationFlags(n,r.flags)){return false}if(!r.color||r.color==="transparent"){if(!this.pdfiumModule.EPDFAnnot_ClearColor(n,l.InteriorColor)){return false}}else if(!this.setAnnotationColor(n,r.color??"#FFFF00",l.InteriorColor)){return false}if(!this.setAnnotationOpacity(n,r.opacity??1)){return false}if(!this.setAnnotationColor(n,r.strokeColor??"#FFFF00",l.Color)){return false}return true}addTextMarkupContent(e,t,n,r){if(r.created&&!this.setAnnotationDate(n,"CreationDate",r.created)){return false}if(r.flags&&!this.setAnnotationFlags(n,r.flags)){return false}if(r.modified&&!this.setAnnotationDate(n,"M",r.modified)){return false}if(!this.setPageAnnoRect(e,t,n,r.rect)){return false}if(!this.syncQuadPointsAnno(e,n,r.segmentRects)){return false}if(!this.setAnnotString(n,"Contents",r.contents??"")){return false}if(!this.setAnnotString(n,"T",r.author||"")){return false}if(!this.setAnnotationOpacity(n,r.opacity??1)){return false}if(!this.setAnnotationColor(n,r.color??"#FFFF00",l.Color)){return false}return true}addStampContent(e,t,n,r,o,a){if(o.created&&!this.setAnnotationDate(r,"CreationDate",o.created)){return false}if(o.flags&&!this.setAnnotationFlags(r,o.flags)){return false}if(o.modified&&!this.setAnnotationDate(r,"M",o.modified)){return false}if(!this.setAnnotString(r,"Contents",o.contents??"")){return false}if(a){for(let e=this.pdfiumModule.FPDFAnnot_GetObjectCount(r)-1;e>=0;e--){this.pdfiumModule.FPDFAnnot_RemoveObject(r,e)}return this.addImageObject(e,t,n,r,o.rect.origin,a)}return true}addImageObject(e,t,n,r,o,a){const i=4;const s=a.width*a.height;const u=this.memoryManager.malloc(i*s);if(!u){return false}for(let e=0;e<s;e++){const t=a.data[e*i];const n=a.data[e*i+1];const r=a.data[e*i+2];const o=a.data[e*i+3];this.pdfiumModule.pdfium.setValue(u+e*i,r,"i8");this.pdfiumModule.pdfium.setValue(u+e*i+1,n,"i8");this.pdfiumModule.pdfium.setValue(u+e*i+2,t,"i8");this.pdfiumModule.pdfium.setValue(u+e*i+3,o,"i8")}const F=4;const m=this.pdfiumModule.FPDFBitmap_CreateEx(a.width,a.height,F,u,0);if(!m){this.memoryManager.free(u);return false}const l=this.pdfiumModule.FPDFPageObj_NewImageObj(e);if(!l){this.pdfiumModule.FPDFBitmap_Destroy(m);this.memoryManager.free(u);return false}if(!this.pdfiumModule.FPDFImageObj_SetBitmap(n,0,l,m)){this.pdfiumModule.FPDFBitmap_Destroy(m);this.pdfiumModule.FPDFPageObj_Destroy(l);this.memoryManager.free(u);return false}const d=this.memoryManager.malloc(6*4);this.pdfiumModule.pdfium.setValue(d,a.width,"float");this.pdfiumModule.pdfium.setValue(d+4,0,"float");this.pdfiumModule.pdfium.setValue(d+8,0,"float");this.pdfiumModule.pdfium.setValue(d+12,a.height,"float");this.pdfiumModule.pdfium.setValue(d+16,0,"float");this.pdfiumModule.pdfium.setValue(d+20,0,"float");if(!this.pdfiumModule.FPDFPageObj_SetMatrix(l,d)){this.memoryManager.free(d);this.pdfiumModule.FPDFBitmap_Destroy(m);this.pdfiumModule.FPDFPageObj_Destroy(l);this.memoryManager.free(u);return false}this.memoryManager.free(d);const c=this.convertDevicePointToPagePoint(t,{x:o.x,y:o.y+a.height});this.pdfiumModule.FPDFPageObj_Transform(l,1,0,0,1,c.x,c.y);if(!this.pdfiumModule.FPDFAnnot_AppendObject(r,l)){this.pdfiumModule.FPDFBitmap_Destroy(m);this.pdfiumModule.FPDFPageObj_Destroy(l);this.memoryManager.free(u);return false}this.pdfiumModule.FPDFBitmap_Destroy(m);this.memoryManager.free(u);return true}saveDocument(e){const t=this.pdfiumModule.PDFiumExt_OpenFileWriter();this.pdfiumModule.PDFiumExt_SaveAsCopy(e,t);const n=this.pdfiumModule.PDFiumExt_GetFileWriterSize(t);const r=this.memoryManager.malloc(n);this.pdfiumModule.PDFiumExt_GetFileWriterData(t,r,n);const o=new ArrayBuffer(n);const a=new DataView(o);for(let e=0;e<n;e++){a.setInt8(e,this.pdfiumModule.pdfium.getValue(r+e,"i8"))}this.memoryManager.free(r);this.pdfiumModule.PDFiumExt_CloseFileWriter(t);return o}readMetaText(e,t){const n=!!this.pdfiumModule.EPDF_HasMetaText(e,t);if(!n)return null;const r=this.pdfiumModule.FPDF_GetMetaText(e,t,0,0);if(r===2)return"";return L(this.pdfiumModule.pdfium,((n,r)=>this.pdfiumModule.FPDF_GetMetaText(e,t,n,r)),this.pdfiumModule.pdfium.UTF16ToString,r)}setMetaText(e,t,n){if(n==null||n.length===0){const n=this.pdfiumModule.EPDF_SetMetaText(e,t,0);return!!n}const r=2*(n.length+1);const o=this.memoryManager.malloc(r);try{this.pdfiumModule.pdfium.stringToUTF16(n,o,r);const a=this.pdfiumModule.EPDF_SetMetaText(e,t,o);return!!a}finally{this.memoryManager.free(o)}}readPdfBookmarks(e,t=0){let n=this.pdfiumModule.FPDFBookmark_GetFirstChild(e,t);const r=[];while(n){const t=this.readPdfBookmark(e,n);r.push(t);const o=this.pdfiumModule.FPDFBookmark_GetNextSibling(e,n);n=o}return r}readPdfBookmark(e,t){const n=L(this.pdfiumModule.pdfium,((e,n)=>this.pdfiumModule.FPDFBookmark_GetTitle(t,e,n)),this.pdfiumModule.pdfium.UTF16ToString);const r=this.readPdfBookmarks(e,t);const o=this.readPdfBookmarkTarget(e,(()=>this.pdfiumModule.FPDFBookmark_GetAction(t)),(()=>this.pdfiumModule.FPDFBookmark_GetDest(e,t)));return{title:n,target:o,children:r}}readPageTextRects(e,t,n,r){const o=this.pdfiumModule.FPDFText_CountRects(r,0,-1);const a=[];for(let t=0;t<o;t++){const o=this.memoryManager.malloc(8);const i=this.memoryManager.malloc(8);const s=this.memoryManager.malloc(8);const u=this.memoryManager.malloc(8);const F=this.pdfiumModule.FPDFText_GetRect(r,t,i,o,s,u);if(!F){this.memoryManager.free(i);this.memoryManager.free(o);this.memoryManager.free(s);this.memoryManager.free(u);continue}const m=this.pdfiumModule.pdfium.getValue(i,"double");const l=this.pdfiumModule.pdfium.getValue(o,"double");const d=this.pdfiumModule.pdfium.getValue(s,"double");const c=this.pdfiumModule.pdfium.getValue(u,"double");this.memoryManager.free(i);this.memoryManager.free(o);this.memoryManager.free(s);this.memoryManager.free(u);const _=this.memoryManager.malloc(4);const P=this.memoryManager.malloc(4);this.pdfiumModule.FPDF_PageToDevice(n,0,0,e.size.width,e.size.height,0,m,l,_,P);const g=this.pdfiumModule.pdfium.getValue(_,"i32");const h=this.pdfiumModule.pdfium.getValue(P,"i32");this.memoryManager.free(_);this.memoryManager.free(P);const f={origin:{x:g,y:h},size:{width:Math.ceil(Math.abs(d-m)),height:Math.ceil(Math.abs(l-c))}};const D=this.pdfiumModule.FPDFText_GetBoundedText(r,m,l,d,c,0,0);const b=(D+1)*2;const p=this.memoryManager.malloc(b);this.pdfiumModule.FPDFText_GetBoundedText(r,m,l,d,c,p,D);const A=this.pdfiumModule.pdfium.UTF16ToString(p);this.memoryManager.free(p);const y=this.pdfiumModule.FPDFText_GetCharIndexAtPos(r,m,l,2,2);let M="";let E=f.size.height;if(y>=0){E=this.pdfiumModule.FPDFText_GetFontSize(r,y);const e=this.pdfiumModule.FPDFText_GetFontInfo(r,y,0,0,0);const t=e+1;const n=this.memoryManager.malloc(t);const o=this.memoryManager.malloc(4);this.pdfiumModule.FPDFText_GetFontInfo(r,y,n,t,o);M=this.pdfiumModule.pdfium.UTF8ToString(n);this.memoryManager.free(n);this.memoryManager.free(o)}const G={content:A,rect:f,font:{family:M,size:E}};a.push(G)}return a}getPageGeometry(n,r){const o="getPageGeometry";this.logger.perf(Q,Z,o,"Begin",n.id);const a=this.cache.getContext(n.id);if(!a){this.logger.perf(Q,Z,o,"End",n.id);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const i=a.acquirePage(r.index);const s=i.getTextPage();const u=this.pdfiumModule.FPDFText_CountChars(s);const F=[];for(let e=0;e<u;e++){const t=this.readGlyphInfo(r,i.pagePtr,s,e);F.push(t)}const m=this.buildRunsFromGlyphs(F,s);i.release();this.logger.perf(Q,Z,o,"End",n.id);return e.resolve({runs:m})}buildRunsFromGlyphs(e,t){const n=[];let r=null;let o=null;let a=null;for(let i=0;i<e.length;i++){const s=e[i];const u=this.pdfiumModule.FPDFText_GetTextObject(t,i);if(u!==o){o=u;r={rect:{x:s.origin.x,y:s.origin.y,width:s.size.width,height:s.size.height},charStart:i,glyphs:[]};a={minX:s.origin.x,minY:s.origin.y,maxX:s.origin.x+s.size.width,maxY:s.origin.y+s.size.height};n.push(r)}r.glyphs.push({x:s.origin.x,y:s.origin.y,width:s.size.width,height:s.size.height,flags:s.isEmpty?2:s.isSpace?1:0});if(s.isEmpty){continue}const F=s.origin.x+s.size.width;const m=s.origin.y+s.size.height;a.minX=Math.min(a.minX,s.origin.x);a.minY=Math.min(a.minY,s.origin.y);a.maxX=Math.max(a.maxX,F);a.maxY=Math.max(a.maxY,m);r.rect.x=a.minX;r.rect.y=a.minY;r.rect.width=a.maxX-a.minX;r.rect.height=a.maxY-a.minY}return n}readGlyphInfo(e,t,n,r){const o=this.memoryManager.malloc(4);const a=this.memoryManager.malloc(4);const i=this.memoryManager.malloc(4);const s=this.memoryManager.malloc(4);const u=this.memoryManager.malloc(16);let F=0,m=0,l=0,d=0,c=false;if(this.pdfiumModule.FPDFText_GetLooseCharBox(n,r,u)){const _=this.pdfiumModule.pdfium.getValue(u,"float");const P=this.pdfiumModule.pdfium.getValue(u+4,"float");const g=this.pdfiumModule.pdfium.getValue(u+8,"float");const h=this.pdfiumModule.pdfium.getValue(u+12,"float");if(_===g||P===h){[u,o,a,i,s].forEach((e=>this.memoryManager.free(e)));return{origin:{x:0,y:0},size:{width:0,height:0},isEmpty:true}}this.pdfiumModule.FPDF_PageToDevice(t,0,0,e.size.width,e.size.height,0,_,P,o,a);this.pdfiumModule.FPDF_PageToDevice(t,0,0,e.size.width,e.size.height,0,g,h,i,s);const f=this.pdfiumModule.pdfium.getValue(o,"i32");const D=this.pdfiumModule.pdfium.getValue(a,"i32");const b=this.pdfiumModule.pdfium.getValue(i,"i32");const p=this.pdfiumModule.pdfium.getValue(s,"i32");F=Math.min(f,b);m=Math.min(D,p);l=Math.max(1,Math.abs(b-f));d=Math.max(1,Math.abs(p-D));const A=this.pdfiumModule.FPDFText_GetUnicode(n,r);c=A===32}[u,o,a,i,s].forEach((e=>this.memoryManager.free(e)));return{origin:{x:F,y:m},size:{width:l,height:d},...c&&{isSpace:c}}}getPageGlyphs(n,r){this.logger.debug(Q,Z,"getPageGlyphs",n,r);this.logger.perf(Q,Z,"getPageGlyphs","Begin",n.id);const o=this.cache.getContext(n.id);if(!o){this.logger.perf(Q,Z,"getPageGlyphs","End",n.id);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const a=o.acquirePage(r.index);const i=a.getTextPage();const s=this.pdfiumModule.FPDFText_CountChars(i);const u=new Array(s);for(let e=0;e<s;e++){const t=this.readGlyphInfo(r,a.pagePtr,i,e);if(t.isEmpty){continue}u[e]={...t}}a.release();this.logger.perf(Q,Z,"getPageGlyphs","End",n.id);return e.resolve(u)}readCharBox(e,t,n,r){const o=this.memoryManager.malloc(8);const a=this.memoryManager.malloc(8);const i=this.memoryManager.malloc(8);const s=this.memoryManager.malloc(8);let u=0;let F=0;let m=0;let l=0;if(this.pdfiumModule.FPDFText_GetCharBox(n,r,a,s,i,o)){const n=this.pdfiumModule.pdfium.getValue(o,"double");const r=this.pdfiumModule.pdfium.getValue(a,"double");const d=this.pdfiumModule.pdfium.getValue(i,"double");const c=this.pdfiumModule.pdfium.getValue(s,"double");const _=this.memoryManager.malloc(4);const P=this.memoryManager.malloc(4);this.pdfiumModule.FPDF_PageToDevice(t,0,0,e.size.width,e.size.height,0,r,n,_,P);u=this.pdfiumModule.pdfium.getValue(_,"i32");F=this.pdfiumModule.pdfium.getValue(P,"i32");this.memoryManager.free(_);this.memoryManager.free(P);m=Math.ceil(Math.abs(c-r));l=Math.ceil(Math.abs(n-d))}this.memoryManager.free(o);this.memoryManager.free(a);this.memoryManager.free(i);this.memoryManager.free(s);return{origin:{x:u,y:F},size:{width:m,height:l}}}readPageAnnotations(e,t){return e.borrowPage(t.index,(n=>{const r=this.pdfiumModule.FPDFPage_GetAnnotCount(n.pagePtr);const o=[];for(let a=0;a<r;a++){n.withAnnotation(a,(r=>{const a=this.readPageAnnotation(e.docPtr,t,r,n);if(a)o.push(a)}))}return o}))}readPageAnnotationsRaw(e,t){const n=this.pdfiumModule.EPDFPage_GetAnnotCountRaw(e.docPtr,t.index);if(n<=0)return[];const r=[];for(let o=0;o<n;++o){const n=this.pdfiumModule.EPDFPage_GetAnnotRaw(e.docPtr,t.index,o);if(!n)continue;try{const o=this.readPageAnnotation(e.docPtr,t,n);if(o)r.push(o)}finally{this.pdfiumModule.FPDFPage_CloseAnnot(n)}}return r}readPageAnnotation(e,t,n,r){let s=this.getAnnotString(n,"NM");if(!s||!o(s)){s=a();this.setAnnotString(n,"NM",s)}const u=this.pdfiumModule.FPDFAnnot_GetSubtype(n);let F;switch(u){case i.TEXT:{F=this.readPdfTextAnno(t,n,s)}break;case i.FREETEXT:{F=this.readPdfFreeTextAnno(t,n,s)}break;case i.LINK:{F=this.readPdfLinkAnno(t,e,n,s)}break;case i.WIDGET:if(r){return this.readPdfWidgetAnno(t,n,r.getFormHandle(),s)}case i.FILEATTACHMENT:{F=this.readPdfFileAttachmentAnno(t,n,s)}break;case i.INK:{F=this.readPdfInkAnno(t,n,s)}break;case i.POLYGON:{F=this.readPdfPolygonAnno(t,n,s)}break;case i.POLYLINE:{F=this.readPdfPolylineAnno(t,n,s)}break;case i.LINE:{F=this.readPdfLineAnno(t,n,s)}break;case i.HIGHLIGHT:F=this.readPdfHighlightAnno(t,n,s);break;case i.STAMP:{F=this.readPdfStampAnno(t,n,s)}break;case i.SQUARE:{F=this.readPdfSquareAnno(t,n,s)}break;case i.CIRCLE:{F=this.readPdfCircleAnno(t,n,s)}break;case i.UNDERLINE:{F=this.readPdfUnderlineAnno(t,n,s)}break;case i.SQUIGGLY:{F=this.readPdfSquigglyAnno(t,n,s)}break;case i.STRIKEOUT:{F=this.readPdfStrikeOutAnno(t,n,s)}break;case i.CARET:{F=this.readPdfCaretAnno(t,n,s)}break;default:{F=this.readPdfAnno(t,u,n,s)}break}return F}readAnnotationColor(e,t=l.Color){const n=this.memoryManager.malloc(4);const r=this.memoryManager.malloc(4);const o=this.memoryManager.malloc(4);const a=this.pdfiumModule.EPDFAnnot_GetColor(e,t,n,r,o);let i;if(a){i={red:this.pdfiumModule.pdfium.getValue(n,"i32")&255,green:this.pdfiumModule.pdfium.getValue(r,"i32")&255,blue:this.pdfiumModule.pdfium.getValue(o,"i32")&255}}this.memoryManager.free(n);this.memoryManager.free(r);this.memoryManager.free(o);return i}getAnnotationColor(e,t=l.Color){const n=this.readAnnotationColor(e,t);return n?c(n):void 0}setAnnotationColor(e,t,n=l.Color){const r=_(t);return this.pdfiumModule.EPDFAnnot_SetColor(e,n,r.red&255,r.green&255,r.blue&255)}getAnnotationOpacity(e){const t=this.memoryManager.malloc(4);const n=this.pdfiumModule.EPDFAnnot_GetOpacity(e,t);const r=n?this.pdfiumModule.pdfium.getValue(t,"i32"):255;this.memoryManager.free(t);return P(r)}setAnnotationOpacity(e,t){const n=w(t);return this.pdfiumModule.EPDFAnnot_SetOpacity(e,n&255)}getAnnotationTextAlignment(e){return this.pdfiumModule.EPDFAnnot_GetTextAlignment(e)}setAnnotationTextAlignment(e,t){return!!this.pdfiumModule.EPDFAnnot_SetTextAlignment(e,t)}getAnnotationVerticalAlignment(e){return this.pdfiumModule.EPDFAnnot_GetVerticalAlignment(e)}setAnnotationVerticalAlignment(e,t){return!!this.pdfiumModule.EPDFAnnot_SetVerticalAlignment(e,t)}getAnnotationDefaultAppearance(e){const t=this.memoryManager.malloc(4);const n=this.memoryManager.malloc(4);const r=this.memoryManager.malloc(4);const o=this.memoryManager.malloc(4);const a=this.memoryManager.malloc(4);const i=!!this.pdfiumModule.EPDFAnnot_GetDefaultAppearance(e,t,n,r,o,a);if(!i){[t,n,r,o,a].forEach((e=>this.memoryManager.free(e)));return}const s=this.pdfiumModule.pdfium;const u=s.getValue(t,"i32");const F=s.getValue(n,"float");const m=s.getValue(r,"i32")&255;const l=s.getValue(o,"i32")&255;const d=s.getValue(a,"i32")&255;[t,n,r,o,a].forEach((e=>this.memoryManager.free(e)));return{fontFamily:u,fontSize:F,fontColor:c({red:m,green:l,blue:d})}}setAnnotationDefaultAppearance(e,t,n,r){const{red:o,green:a,blue:i}=_(r);return!!this.pdfiumModule.EPDFAnnot_SetDefaultAppearance(e,t,n,o&255,a&255,i&255)}getBorderStyle(e){const t=this.memoryManager.malloc(4);let n=0;let r=m.UNKNOWN;let o=false;r=this.pdfiumModule.EPDFAnnot_GetBorderStyle(e,t);n=this.pdfiumModule.pdfium.getValue(t,"float");o=r!==m.UNKNOWN;this.memoryManager.free(t);return{ok:o,style:r,width:n}}setBorderStyle(e,t,n){return this.pdfiumModule.EPDFAnnot_SetBorderStyle(e,t,n)}getAnnotationIcon(e){return this.pdfiumModule.EPDFAnnot_GetIcon(e)}setAnnotationIcon(e,t){return this.pdfiumModule.EPDFAnnot_SetIcon(e,t)}getBorderEffect(e){const t=this.memoryManager.malloc(4);const n=!!this.pdfiumModule.EPDFAnnot_GetBorderEffect(e,t);const r=n?this.pdfiumModule.pdfium.getValue(t,"float"):0;this.memoryManager.free(t);return{ok:n,intensity:r}}getRectangleDifferences(e){const t=this.memoryManager.malloc(4);const n=this.memoryManager.malloc(4);const r=this.memoryManager.malloc(4);const o=this.memoryManager.malloc(4);const a=!!this.pdfiumModule.EPDFAnnot_GetRectangleDifferences(e,t,n,r,o);const i=this.pdfiumModule.pdfium;const s=i.getValue(t,"float");const u=i.getValue(n,"float");const F=i.getValue(r,"float");const m=i.getValue(o,"float");this.memoryManager.free(t);this.memoryManager.free(n);this.memoryManager.free(r);this.memoryManager.free(o);return{ok:a,left:s,top:u,right:F,bottom:m}}getAnnotationDate(e,t){const r=this.getAnnotString(e,t);return r?n(r):void 0}setAnnotationDate(e,t,n){const r=g(n);return this.setAnnotString(e,t,r)}getBorderDashPattern(e){const t=this.pdfiumModule.EPDFAnnot_GetBorderDashPatternCount(e);if(t===0){return{ok:false,pattern:[]}}const n=this.memoryManager.malloc(4*t);const r=!!this.pdfiumModule.EPDFAnnot_GetBorderDashPattern(e,n,t);const o=[];if(r){const e=this.pdfiumModule.pdfium;for(let r=0;r<t;r++){o.push(e.getValue(n+4*r,"float"))}}this.memoryManager.free(n);return{ok:r,pattern:o}}setBorderDashPattern(e,t){if(!t||t.length===0){return this.pdfiumModule.EPDFAnnot_SetBorderDashPattern(e,0,0)}const n=t.map((e=>Number.isFinite(e)&&e>0?e:0)).filter((e=>e>0));if(n.length===0){return this.pdfiumModule.EPDFAnnot_SetBorderDashPattern(e,0,0)}const r=4*n.length;const o=this.memoryManager.malloc(r);for(let e=0;e<n.length;e++){this.pdfiumModule.pdfium.setValue(o+4*e,n[e],"float")}const a=!!this.pdfiumModule.EPDFAnnot_SetBorderDashPattern(e,o,n.length);this.memoryManager.free(o);return a}getLineEndings(e){const t=this.memoryManager.malloc(4);const n=this.memoryManager.malloc(4);const r=!!this.pdfiumModule.EPDFAnnot_GetLineEndings(e,t,n);if(!r){this.memoryManager.free(t);this.memoryManager.free(n);return void 0}const o=this.pdfiumModule.pdfium.getValue(t,"i32");const a=this.pdfiumModule.pdfium.getValue(n,"i32");this.memoryManager.free(t);this.memoryManager.free(n);return{start:o,end:a}}setLineEndings(e,t,n){return!!this.pdfiumModule.EPDFAnnot_SetLineEndings(e,t,n)}getLinePoints(e,t){const n=this.memoryManager.malloc(8);const r=this.memoryManager.malloc(8);this.pdfiumModule.FPDFAnnot_GetLine(e,n,r);const o=this.pdfiumModule.pdfium.getValue(n,"float");const a=this.pdfiumModule.pdfium.getValue(n+4,"float");const i=this.convertPagePointToDevicePoint(t,{x:o,y:a});const s=this.pdfiumModule.pdfium.getValue(r,"float");const u=this.pdfiumModule.pdfium.getValue(r+4,"float");const F=this.convertPagePointToDevicePoint(t,{x:s,y:u});this.memoryManager.free(n);this.memoryManager.free(r);return{start:i,end:F}}setLinePoints(e,t,n,r){const o=this.memoryManager.malloc(16);const a=this.convertDevicePointToPagePoint(e,n);const i=this.convertDevicePointToPagePoint(e,r);this.pdfiumModule.pdfium.setValue(o+0,a.x,"float");this.pdfiumModule.pdfium.setValue(o+4,a.y,"float");this.pdfiumModule.pdfium.setValue(o+8,i.x,"float");this.pdfiumModule.pdfium.setValue(o+12,i.y,"float");const s=this.pdfiumModule.EPDFAnnot_SetLine(t,o,o+8);this.memoryManager.free(o);return s}getQuadPointsAnno(e,t){const n=this.pdfiumModule.FPDFAnnot_CountAttachmentPoints(t);if(n===0)return[];const r=8*4;const o=[];for(let a=0;a<n;a++){const n=this.memoryManager.malloc(r);const i=this.pdfiumModule.FPDFAnnot_GetAttachmentPoints(t,a,n);if(i){const t=[];const r=[];for(let e=0;e<4;e++){const o=n+e*8;t.push(this.pdfiumModule.pdfium.getValue(o,"float"));r.push(this.pdfiumModule.pdfium.getValue(o+4,"float"))}const a=this.convertPagePointToDevicePoint(e,{x:t[0],y:r[0]});const i=this.convertPagePointToDevicePoint(e,{x:t[1],y:r[1]});const s=this.convertPagePointToDevicePoint(e,{x:t[2],y:r[2]});const u=this.convertPagePointToDevicePoint(e,{x:t[3],y:r[3]});o.push({p1:a,p2:i,p3:s,p4:u})}this.memoryManager.free(n)}return o.map(h)}syncQuadPointsAnno(e,t,n){const r=8*4;const o=this.pdfiumModule.pdfium;const a=this.pdfiumModule.FPDFAnnot_CountAttachmentPoints(t);const i=this.memoryManager.malloc(r);const s=t=>{const n=f(t);const r=this.convertDevicePointToPagePoint(e,n.p1);const a=this.convertDevicePointToPagePoint(e,n.p2);const s=this.convertDevicePointToPagePoint(e,n.p3);const u=this.convertDevicePointToPagePoint(e,n.p4);o.setValue(i+0,r.x,"float");o.setValue(i+4,r.y,"float");o.setValue(i+8,a.x,"float");o.setValue(i+12,a.y,"float");o.setValue(i+16,u.x,"float");o.setValue(i+20,u.y,"float");o.setValue(i+24,s.x,"float");o.setValue(i+28,s.y,"float")};const u=Math.min(a,n.length);for(let e=0;e<u;e++){s(n[e]);if(!this.pdfiumModule.FPDFAnnot_SetAttachmentPoints(t,e,i)){this.memoryManager.free(i);return false}}for(let e=a;e<n.length;e++){s(n[e]);if(!this.pdfiumModule.FPDFAnnot_AppendAttachmentPoints(t,i)){this.memoryManager.free(i);return false}}this.memoryManager.free(i);return true}redactTextInRects(n,r,o,a){const{recurseForms:i=true,drawBlackBoxes:s=false}=a??{};this.logger.debug("PDFiumEngine","Engine","redactTextInQuads",n.id,r.index,o.length);const u="RedactTextInQuads";this.logger.perf("PDFiumEngine","Engine",u,"Begin",`${n.id}-${r.index}`);const F=this.cache.getContext(n.id);if(!F){this.logger.perf("PDFiumEngine","Engine",u,"End",`${n.id}-${r.index}`);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const m=(o??[]).filter((e=>{var t,n,r,o;return e&&Number.isFinite((t=e.origin)==null?void 0:t.x)&&Number.isFinite((n=e.origin)==null?void 0:n.y)&&Number.isFinite((r=e.size)==null?void 0:r.width)&&Number.isFinite((o=e.size)==null?void 0:o.height)&&e.size.width>0&&e.size.height>0}));if(m.length===0){this.logger.perf("PDFiumEngine","Engine",u,"End",`${n.id}-${r.index}`);return e.resolve(false)}const l=F.acquirePage(r.index);const{ptr:d,count:c}=this.allocFSQuadsBufferFromRects(r,m);let _=false;try{_=!!this.pdfiumModule.EPDFText_RedactInQuads(l.pagePtr,d,c,i?true:false,s?true:false)}finally{this.memoryManager.free(d)}if(_){_=!!this.pdfiumModule.FPDFPage_GenerateContent(l.pagePtr)}l.disposeImmediate();this.logger.perf("PDFiumEngine","Engine",u,"End",`${n.id}-${r.index}`);return e.resolve(!!_)}allocFSQuadsBufferFromRects(e,t){const n=32;const r=t.length;const o=this.memoryManager.malloc(n*r);const a=this.pdfiumModule.pdfium;for(let i=0;i<r;i++){const r=t[i];const s=f(r);const u=this.convertDevicePointToPagePoint(e,s.p1);const F=this.convertDevicePointToPagePoint(e,s.p2);const m=this.convertDevicePointToPagePoint(e,s.p3);const l=this.convertDevicePointToPagePoint(e,s.p4);const d=o+i*n;a.setValue(d+0,u.x,"float");a.setValue(d+4,u.y,"float");a.setValue(d+8,F.x,"float");a.setValue(d+12,F.y,"float");a.setValue(d+16,l.x,"float");a.setValue(d+20,l.y,"float");a.setValue(d+24,m.x,"float");a.setValue(d+28,m.y,"float")}return{ptr:o,count:r}}getInkList(e,t){const n=[];const r=this.pdfiumModule.FPDFAnnot_GetInkListCount(t);for(let o=0;o<r;o++){const r=[];const a=this.pdfiumModule.FPDFAnnot_GetInkListPath(t,o,0,0);if(a>0){const n=8;const i=this.memoryManager.malloc(a*n);this.pdfiumModule.FPDFAnnot_GetInkListPath(t,o,i,a);for(let t=0;t<a;t++){const n=this.pdfiumModule.pdfium.getValue(i+t*8,"float");const o=this.pdfiumModule.pdfium.getValue(i+t*8+4,"float");const{x:a,y:s}=this.convertPagePointToDevicePoint(e,{x:n,y:o});r.push({x:a,y:s})}this.memoryManager.free(i)}n.push({points:r})}return n}setInkList(e,t,n){for(const r of n){const n=r.points.length;const o=this.memoryManager.malloc(n*8);for(let t=0;t<n;t++){const n=r.points[t];const{x:a,y:i}=this.convertDevicePointToPagePoint(e,n);this.pdfiumModule.pdfium.setValue(o+t*8,a,"float");this.pdfiumModule.pdfium.setValue(o+t*8+4,i,"float")}if(this.pdfiumModule.FPDFAnnot_AddInkStroke(t,o,n)===-1){this.memoryManager.free(o);return false}this.memoryManager.free(o)}return true}readPdfTextAnno(e,t,n){const r=this.getAnnotCustom(t);const o=this.readPageAnnoRect(t);const a=this.convertPageRectToDeviceRect(e,o);const s=this.getAnnotString(t,"T");const u=this.getAnnotationDate(t,"M");const F=this.getAnnotationDate(t,"CreationDate");const m=this.getAnnotString(t,"Contents")||"";const l=this.getAnnotString(t,"State");const d=this.getAnnotString(t,"StateModel");const c=this.getAnnotationColor(t);const _=this.getAnnotationOpacity(t);const P=this.getInReplyToId(t);const g=this.getAnnotationFlags(t);const h=this.getAnnotationIcon(t);return{pageIndex:e.index,custom:r,id:n,type:i.TEXT,flags:g,contents:m,color:c??"#FFFF00",opacity:_,rect:a,inReplyToId:P,author:s,modified:u,created:F,state:l,stateModel:d,icon:h}}readPdfFreeTextAnno(e,t,n){const r=this.getAnnotCustom(t);const o=this.readPageAnnoRect(t);const a=this.convertPageRectToDeviceRect(e,o);const s=this.getAnnotString(t,"Contents")||"";const u=this.getAnnotString(t,"T");const F=this.getAnnotationDate(t,"M");const m=this.getAnnotationDate(t,"CreationDate");const l=this.getAnnotString(t,"DS");const d=this.getAnnotationDefaultAppearance(t);const c=this.getAnnotationColor(t);const _=this.getAnnotationTextAlignment(t);const P=this.getAnnotationVerticalAlignment(t);const g=this.getAnnotationOpacity(t);const h=this.getAnnotRichContent(t);const f=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:r,id:n,type:i.FREETEXT,fontFamily:(d==null?void 0:d.fontFamily)??D.Unknown,fontSize:(d==null?void 0:d.fontSize)??12,fontColor:(d==null?void 0:d.fontColor)??"#000000",verticalAlign:P,backgroundColor:c,flags:f,opacity:g,textAlign:_,defaultStyle:l,richContent:h,contents:s,author:u,modified:F,created:m,rect:a}}readPdfLinkAnno(e,t,n,r){const o=this.getAnnotCustom(n);const a=this.pdfiumModule.FPDFAnnot_GetLink(n);if(!a){return}const s=this.readPageAnnoRect(n);const u=this.convertPageRectToDeviceRect(e,s);const F=this.getAnnotString(n,"T");const m=this.getAnnotationDate(n,"M");const l=this.getAnnotationDate(n,"CreationDate");const d=this.getAnnotationFlags(n);const c=this.readPdfLinkAnnoTarget(t,(()=>this.pdfiumModule.FPDFLink_GetAction(a)),(()=>this.pdfiumModule.FPDFLink_GetDest(t,a)));return{pageIndex:e.index,custom:o,id:r,type:i.LINK,flags:d,target:c,rect:u,author:F,modified:m,created:l}}readPdfWidgetAnno(e,t,n,r){const o=this.getAnnotCustom(t);const a=this.readPageAnnoRect(t);const s=this.convertPageRectToDeviceRect(e,a);const u=this.getAnnotString(t,"T");const F=this.getAnnotationDate(t,"M");const m=this.getAnnotationDate(t,"CreationDate");const l=this.getAnnotationFlags(t);const d=this.readPdfWidgetAnnoField(n,t);return{pageIndex:e.index,custom:o,id:r,type:i.WIDGET,flags:l,rect:s,field:d,author:u,modified:F,created:m}}readPdfFileAttachmentAnno(e,t,n){const r=this.getAnnotCustom(t);const o=this.readPageAnnoRect(t);const a=this.convertPageRectToDeviceRect(e,o);const s=this.getAnnotString(t,"T");const u=this.getAnnotationDate(t,"M");const F=this.getAnnotationDate(t,"CreationDate");const m=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:r,id:n,type:i.FILEATTACHMENT,flags:m,rect:a,author:s,modified:u,created:F}}readPdfInkAnno(e,t,n){const r=this.getAnnotCustom(t);const o=this.readPageAnnoRect(t);const a=this.convertPageRectToDeviceRect(e,o);const s=this.getAnnotString(t,"T");const u=this.getAnnotationDate(t,"M");const F=this.getAnnotationDate(t,"CreationDate");const m=this.getAnnotationColor(t);const l=this.getAnnotationOpacity(t);const{width:d}=this.getBorderStyle(t);const c=this.getInkList(e,t);const _=this.pdfiumModule.EPDFAnnot_GetBlendMode(t);const P=this.getAnnotIntent(t);const g=this.getAnnotationFlags(t);const h=this.getAnnotString(t,"Contents")||"";return{pageIndex:e.index,custom:r,id:n,type:i.INK,...P&&{intent:P},contents:h,blendMode:_,flags:g,color:m??"#FF0000",opacity:l,strokeWidth:d===0?1:d,rect:a,inkList:c,author:s,modified:u,created:F}}readPdfPolygonAnno(e,t,n){const r=this.getAnnotCustom(t);const o=this.readPageAnnoRect(t);const a=this.convertPageRectToDeviceRect(e,o);const s=this.getAnnotString(t,"T");const u=this.getAnnotationDate(t,"M");const F=this.getAnnotationDate(t,"CreationDate");const d=this.readPdfAnnoVertices(e,t);const c=this.getAnnotString(t,"Contents")||"";const _=this.getAnnotationFlags(t);const P=this.getAnnotationColor(t);const g=this.getAnnotationColor(t,l.InteriorColor);const h=this.getAnnotationOpacity(t);let{style:f,width:D}=this.getBorderStyle(t);let b;if(f===m.DASHED){const{ok:e,pattern:n}=this.getBorderDashPattern(t);if(e){b=n}}if(d.length>1){const e=d[0];const t=d[d.length-1];if(e.x===t.x&&e.y===t.y){d.pop()}}return{pageIndex:e.index,custom:r,id:n,type:i.POLYGON,contents:c,flags:_,strokeColor:P??"#FF0000",color:g??"transparent",opacity:h,strokeWidth:D===0?1:D,strokeStyle:f,strokeDashArray:b,rect:a,vertices:d,author:s,modified:u,created:F}}readPdfPolylineAnno(e,t,n){const r=this.getAnnotCustom(t);const o=this.readPageAnnoRect(t);const a=this.convertPageRectToDeviceRect(e,o);const s=this.getAnnotString(t,"T");const u=this.getAnnotationDate(t,"M");const F=this.getAnnotationDate(t,"CreationDate");const d=this.readPdfAnnoVertices(e,t);const c=this.getAnnotString(t,"Contents")||"";const _=this.getAnnotationColor(t);const P=this.getAnnotationFlags(t);const g=this.getAnnotationColor(t,l.InteriorColor);const h=this.getAnnotationOpacity(t);let{style:f,width:D}=this.getBorderStyle(t);let b;if(f===m.DASHED){const{ok:e,pattern:n}=this.getBorderDashPattern(t);if(e){b=n}}const p=this.getLineEndings(t);return{pageIndex:e.index,custom:r,id:n,type:i.POLYLINE,contents:c,flags:P,strokeColor:_??"#FF0000",color:g??"transparent",opacity:h,strokeWidth:D===0?1:D,strokeStyle:f,strokeDashArray:b,lineEndings:p,rect:a,vertices:d,author:s,modified:u,created:F}}readPdfLineAnno(e,t,n){const r=this.getAnnotCustom(t);const o=this.readPageAnnoRect(t);const a=this.convertPageRectToDeviceRect(e,o);const s=this.getAnnotString(t,"T");const u=this.getAnnotationDate(t,"M");const F=this.getAnnotationDate(t,"CreationDate");const c=this.getLinePoints(t,e);const _=this.getLineEndings(t);const P=this.getAnnotString(t,"Contents")||"";const g=this.getAnnotationColor(t);const h=this.getAnnotationFlags(t);const f=this.getAnnotationColor(t,l.InteriorColor);const D=this.getAnnotationOpacity(t);let{style:b,width:p}=this.getBorderStyle(t);let A;if(b===m.DASHED){const{ok:e,pattern:n}=this.getBorderDashPattern(t);if(e){A=n}}return{pageIndex:e.index,custom:r,id:n,type:i.LINE,flags:h,rect:a,contents:P,strokeWidth:p===0?1:p,strokeStyle:b,strokeDashArray:A,strokeColor:g??"#FF0000",color:f??"transparent",opacity:D,linePoints:c||{start:{x:0,y:0},end:{x:0,y:0}},lineEndings:_||{start:d.None,end:d.None},author:s,modified:u,created:F}}readPdfHighlightAnno(e,t,n){const r=this.getAnnotCustom(t);const o=this.readPageAnnoRect(t);const a=this.convertPageRectToDeviceRect(e,o);const s=this.getQuadPointsAnno(e,t);const u=this.getAnnotationColor(t);const F=this.getAnnotationOpacity(t);const m=this.pdfiumModule.EPDFAnnot_GetBlendMode(t);const l=this.getAnnotString(t,"T");const d=this.getAnnotationDate(t,"M");const c=this.getAnnotationDate(t,"CreationDate");const _=this.getAnnotString(t,"Contents")||"";const P=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:r,id:n,blendMode:m,type:i.HIGHLIGHT,rect:a,flags:P,contents:_,segmentRects:s,color:u??"#FFFF00",opacity:F,author:l,modified:d,created:c}}readPdfUnderlineAnno(e,t,n){const r=this.getAnnotCustom(t);const o=this.readPageAnnoRect(t);const a=this.convertPageRectToDeviceRect(e,o);const s=this.getAnnotString(t,"T");const u=this.getAnnotationDate(t,"M");const F=this.getAnnotationDate(t,"CreationDate");const m=this.getQuadPointsAnno(e,t);const l=this.getAnnotString(t,"Contents")||"";const d=this.getAnnotationColor(t);const c=this.getAnnotationOpacity(t);const _=this.pdfiumModule.EPDFAnnot_GetBlendMode(t);const P=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:r,id:n,blendMode:_,type:i.UNDERLINE,rect:a,flags:P,contents:l,segmentRects:m,color:d??"#FF0000",opacity:c,author:s,modified:u,created:F}}readPdfStrikeOutAnno(e,t,n){const r=this.getAnnotCustom(t);const o=this.readPageAnnoRect(t);const a=this.convertPageRectToDeviceRect(e,o);const s=this.getAnnotString(t,"T");const u=this.getAnnotationDate(t,"M");const F=this.getAnnotationDate(t,"CreationDate");const m=this.getQuadPointsAnno(e,t);const l=this.getAnnotString(t,"Contents")||"";const d=this.getAnnotationColor(t);const c=this.getAnnotationOpacity(t);const _=this.pdfiumModule.EPDFAnnot_GetBlendMode(t);const P=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:r,id:n,blendMode:_,type:i.STRIKEOUT,flags:P,rect:a,contents:l,segmentRects:m,color:d??"#FF0000",opacity:c,author:s,modified:u,created:F}}readPdfSquigglyAnno(e,t,n){const r=this.getAnnotCustom(t);const o=this.readPageAnnoRect(t);const a=this.convertPageRectToDeviceRect(e,o);const s=this.getAnnotString(t,"T");const u=this.getAnnotationDate(t,"M");const F=this.getAnnotationDate(t,"CreationDate");const m=this.getQuadPointsAnno(e,t);const l=this.getAnnotString(t,"Contents")||"";const d=this.getAnnotationColor(t);const c=this.getAnnotationOpacity(t);const _=this.pdfiumModule.EPDFAnnot_GetBlendMode(t);const P=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:r,id:n,blendMode:_,type:i.SQUIGGLY,rect:a,flags:P,contents:l,segmentRects:m,color:d??"#FF0000",opacity:c,author:s,modified:u,created:F}}readPdfCaretAnno(e,t,n){const r=this.getAnnotCustom(t);const o=this.readPageAnnoRect(t);const a=this.convertPageRectToDeviceRect(e,o);const s=this.getAnnotString(t,"T");const u=this.getAnnotationDate(t,"M");const F=this.getAnnotationDate(t,"CreationDate");const m=this.getAnnotationFlags(t);return{pageIndex:e.index,custom:r,id:n,type:i.CARET,rect:a,flags:m,author:s,modified:u,created:F}}readPdfStampAnno(e,t,n){const r=this.getAnnotCustom(t);const o=this.readPageAnnoRect(t);const a=this.convertPageRectToDeviceRect(e,o);const s=this.getAnnotString(t,"T");const u=this.getAnnotationDate(t,"M");const F=this.getAnnotationDate(t,"CreationDate");const m=this.getAnnotationFlags(t);const l=this.getAnnotString(t,"Contents")||"";return{pageIndex:e.index,custom:r,id:n,type:i.STAMP,contents:l,rect:a,author:s,modified:u,created:F,flags:m}}readPdfPageObject(e){const t=this.pdfiumModule.FPDFPageObj_GetType(e);switch(t){case b.PATH:return this.readPathObject(e);case b.IMAGE:return this.readImageObject(e);case b.FORM:return this.readFormObject(e)}}readPathObject(e){const t=this.pdfiumModule.FPDFPath_CountSegments(e);const n=this.memoryManager.malloc(4);const r=this.memoryManager.malloc(4);const o=this.memoryManager.malloc(4);const a=this.memoryManager.malloc(4);this.pdfiumModule.FPDFPageObj_GetBounds(e,n,r,o,a);const i=this.pdfiumModule.pdfium.getValue(n,"float");const s=this.pdfiumModule.pdfium.getValue(r,"float");const u=this.pdfiumModule.pdfium.getValue(o,"float");const F=this.pdfiumModule.pdfium.getValue(a,"float");const m={left:i,bottom:s,right:u,top:F};this.memoryManager.free(n);this.memoryManager.free(r);this.memoryManager.free(o);this.memoryManager.free(a);const l=[];for(let n=0;n<t;n++){const t=this.readPdfSegment(e,n);l.push(t)}const d=this.readPdfPageObjectTransformMatrix(e);return{type:b.PATH,bounds:m,segments:l,matrix:d}}readPdfSegment(e,t){const n=this.pdfiumModule.FPDFPath_GetPathSegment(e,t);const r=this.pdfiumModule.FPDFPathSegment_GetType(n);const o=this.pdfiumModule.FPDFPathSegment_GetClose(n);const a=this.memoryManager.malloc(4);const i=this.memoryManager.malloc(4);this.pdfiumModule.FPDFPathSegment_GetPoint(n,a,i);const s=this.pdfiumModule.pdfium.getValue(a,"float");const u=this.pdfiumModule.pdfium.getValue(i,"float");this.memoryManager.free(a);this.memoryManager.free(i);return{type:r,point:{x:s,y:u},isClosed:o}}readImageObject(e){const t=this.pdfiumModule.FPDFImageObj_GetBitmap(e);const n=this.pdfiumModule.FPDFBitmap_GetBuffer(t);const r=this.pdfiumModule.FPDFBitmap_GetWidth(t);const o=this.pdfiumModule.FPDFBitmap_GetHeight(t);const a=this.pdfiumModule.FPDFBitmap_GetFormat(t);const i=r*o;const s=4;const u=new Uint8ClampedArray(i*s);for(let e=0;e<i;e++){switch(a){case 2:{const t=this.pdfiumModule.pdfium.getValue(n+e*3,"i8");const r=this.pdfiumModule.pdfium.getValue(n+e*3+1,"i8");const o=this.pdfiumModule.pdfium.getValue(n+e*3+2,"i8");u[e*s]=o;u[e*s+1]=r;u[e*s+2]=t;u[e*s+3]=100}break}}const F=new ImageData(u,r,o);const m=this.readPdfPageObjectTransformMatrix(e);return{type:b.IMAGE,imageData:F,matrix:m}}readFormObject(e){const t=this.pdfiumModule.FPDFFormObj_CountObjects(e);const n=[];for(let r=0;r<t;r++){const t=this.pdfiumModule.FPDFFormObj_GetObject(e,r);const o=this.readPdfPageObject(t);if(o){n.push(o)}}const r=this.readPdfPageObjectTransformMatrix(e);return{type:b.FORM,objects:n,matrix:r}}readPdfPageObjectTransformMatrix(e){const t=this.memoryManager.malloc(4*6);if(this.pdfiumModule.FPDFPageObj_GetMatrix(e,t)){const e=this.pdfiumModule.pdfium.getValue(t,"float");const n=this.pdfiumModule.pdfium.getValue(t+4,"float");const r=this.pdfiumModule.pdfium.getValue(t+8,"float");const o=this.pdfiumModule.pdfium.getValue(t+12,"float");const a=this.pdfiumModule.pdfium.getValue(t+16,"float");const i=this.pdfiumModule.pdfium.getValue(t+20,"float");this.memoryManager.free(t);return{a:e,b:n,c:r,d:o,e:a,f:i}}this.memoryManager.free(t);return{a:1,b:0,c:0,d:1,e:0,f:0}}readStampAnnotationContents(e){const t=[];const n=this.pdfiumModule.FPDFAnnot_GetObjectCount(e);for(let r=0;r<n;r++){const n=this.pdfiumModule.FPDFAnnot_GetObject(e,r);const o=this.readPdfPageObject(n);if(o){t.push(o)}}return t}getStrokeWidth(e){const t=this.memoryManager.malloc(4);const n=this.memoryManager.malloc(4);const r=this.memoryManager.malloc(4);const o=this.pdfiumModule.FPDFAnnot_GetBorder(e,t,n,r);const a=o?this.pdfiumModule.pdfium.getValue(r,"float"):1;this.memoryManager.free(t);this.memoryManager.free(n);this.memoryManager.free(r);return a}getAnnotationFlags(e){const t=this.pdfiumModule.FPDFAnnot_GetFlags(e);return p(t)}setAnnotationFlags(e,t){const n=A(t);return this.pdfiumModule.FPDFAnnot_SetFlags(e,n)}readPdfCircleAnno(e,t,n){const r=this.getAnnotCustom(t);const o=this.getAnnotationFlags(t);const a=this.readPageAnnoRect(t);const s=this.convertPageRectToDeviceRect(e,a);const u=this.getAnnotString(t,"T");const F=this.getAnnotationDate(t,"M");const d=this.getAnnotationDate(t,"CreationDate");const c=this.getAnnotString(t,"Contents")||"";const _=this.getAnnotationColor(t,l.InteriorColor);const P=this.getAnnotationColor(t);const g=this.getAnnotationOpacity(t);let{style:h,width:f}=this.getBorderStyle(t);let D;if(h===m.DASHED){const{ok:e,pattern:n}=this.getBorderDashPattern(t);if(e){D=n}}return{pageIndex:e.index,custom:r,id:n,type:i.CIRCLE,flags:o,color:_??"transparent",opacity:g,contents:c,strokeWidth:f,strokeColor:P??"#FF0000",strokeStyle:h,rect:s,author:u,modified:F,created:d,...D!==void 0&&{strokeDashArray:D}}}readPdfSquareAnno(e,t,n){const r=this.getAnnotCustom(t);const o=this.getAnnotationFlags(t);const a=this.readPageAnnoRect(t);const s=this.convertPageRectToDeviceRect(e,a);const u=this.getAnnotString(t,"T");const F=this.getAnnotationDate(t,"M");const d=this.getAnnotationDate(t,"CreationDate");const c=this.getAnnotString(t,"Contents")||"";const _=this.getAnnotationColor(t,l.InteriorColor);const P=this.getAnnotationColor(t);const g=this.getAnnotationOpacity(t);let{style:h,width:f}=this.getBorderStyle(t);let D;if(h===m.DASHED){const{ok:e,pattern:n}=this.getBorderDashPattern(t);if(e){D=n}}return{pageIndex:e.index,custom:r,id:n,type:i.SQUARE,flags:o,color:_??"transparent",opacity:g,contents:c,strokeColor:P??"#FF0000",strokeWidth:f,strokeStyle:h,rect:s,author:u,modified:F,created:d,...D!==void 0&&{strokeDashArray:D}}}readPdfAnno(e,t,n,r){const o=this.getAnnotCustom(n);const a=this.readPageAnnoRect(n);const i=this.convertPageRectToDeviceRect(e,a);const s=this.getAnnotString(n,"T");const u=this.getAnnotationDate(n,"M");const F=this.getAnnotationDate(n,"CreationDate");const m=this.getAnnotationFlags(n);return{pageIndex:e.index,custom:o,id:r,flags:m,type:t,rect:i,author:s,modified:u,created:F}}getInReplyToId(e){const t=this.pdfiumModule.FPDFAnnot_GetLinkedAnnot(e,"IRT");if(!t)return;return this.getAnnotString(t,"NM")}setInReplyToId(e,t,n){const r=this.getAnnotationByName(e,n);if(!r)return false;return this.pdfiumModule.EPDFAnnot_SetLinkedAnnot(t,"IRT",r)}getAnnotString(e,t){const n=this.pdfiumModule.FPDFAnnot_GetStringValue(e,t,0,0);if(n===0)return;const r=(n+1)*2;const o=this.memoryManager.malloc(r);this.pdfiumModule.FPDFAnnot_GetStringValue(e,t,o,r);const a=this.pdfiumModule.pdfium.UTF16ToString(o);this.memoryManager.free(o);return a||void 0}getAnnotCustom(e){const t=this.getAnnotString(e,"EPDFCustom");if(!t)return;try{return JSON.parse(t)}catch(e){console.warn("Failed to parse annotation custom data as JSON:",e);console.warn("Invalid JSON string:",t);return void 0}}setAnnotCustom(e,t){if(t===void 0||t===null){return this.setAnnotString(e,"EPDFCustom","")}try{const n=JSON.stringify(t);return this.setAnnotString(e,"EPDFCustom",n)}catch(e){console.warn("Failed to stringify annotation custom data as JSON:",e);console.warn("Invalid data object:",t);return false}}getAnnotIntent(e){const t=this.pdfiumModule.EPDFAnnot_GetIntent(e,0,0);if(t===0)return;const n=t+1;const r=n*2;const o=this.memoryManager.malloc(r);this.pdfiumModule.EPDFAnnot_GetIntent(e,o,r);const a=this.pdfiumModule.pdfium.UTF16ToString(o);this.memoryManager.free(o);return a&&a!=="undefined"?a:void 0}setAnnotIntent(e,t){return this.pdfiumModule.EPDFAnnot_SetIntent(e,t)}getAnnotRichContent(e){const t=this.pdfiumModule.EPDFAnnot_GetRichContent(e,0,0);if(t===0)return;const n=t+1;const r=n*2;const o=this.memoryManager.malloc(r);this.pdfiumModule.EPDFAnnot_GetRichContent(e,o,r);const a=this.pdfiumModule.pdfium.UTF16ToString(o);this.memoryManager.free(o);return a||void 0}getAnnotationByName(e,t){const n=2*(t.length+1);const r=this.memoryManager.malloc(n);this.pdfiumModule.pdfium.stringToUTF16(t,r,n);const o=this.pdfiumModule.EPDFPage_GetAnnotByName(e,r);this.memoryManager.free(r);return o}removeAnnotationByName(e,t){const n=2*(t.length+1);const r=this.memoryManager.malloc(n);this.pdfiumModule.pdfium.stringToUTF16(t,r,n);const o=this.pdfiumModule.EPDFPage_RemoveAnnotByName(e,r);this.memoryManager.free(r);return o}setAnnotString(e,t,n){const r=2*(n.length+1);const o=this.memoryManager.malloc(r);this.pdfiumModule.pdfium.stringToUTF16(n,o,r);const a=this.pdfiumModule.FPDFAnnot_SetStringValue(e,t,o);this.memoryManager.free(o);return a}readPdfAnnoVertices(e,t){const n=[];const r=this.pdfiumModule.FPDFAnnot_GetVertices(t,0,0);const o=8;const a=this.memoryManager.malloc(r*o);this.pdfiumModule.FPDFAnnot_GetVertices(t,a,r);for(let t=0;t<r;t++){const r=this.pdfiumModule.pdfium.getValue(a+t*o,"float");const i=this.pdfiumModule.pdfium.getValue(a+t*o+4,"float");const{x:s,y:u}=this.convertPagePointToDevicePoint(e,{x:r,y:i});const F=n[n.length-1];if(!F||F.x!==s||F.y!==u){n.push({x:s,y:u})}}this.memoryManager.free(a);return n}setPdfAnnoVertices(e,t,n){const r=this.pdfiumModule.pdfium;const o=8;const a=this.memoryManager.malloc(o*n.length);n.forEach(((t,n)=>{const i=this.convertDevicePointToPagePoint(e,t);r.setValue(a+n*o+0,i.x,"float");r.setValue(a+n*o+4,i.y,"float")}));const i=this.pdfiumModule.EPDFAnnot_SetVertices(t,a,n.length);this.memoryManager.free(a);return i}readPdfBookmarkTarget(e,t,n){const r=t();if(r){const t=this.readPdfAction(e,r);return{type:"action",action:t}}else{const t=n();if(t){const n=this.readPdfDestination(e,t);return{type:"destination",destination:n}}}}readPdfWidgetAnnoField(e,t){const n=this.pdfiumModule.FPDFAnnot_GetFormFieldFlags(e,t);const r=this.pdfiumModule.FPDFAnnot_GetFormFieldType(e,t);const o=L(this.pdfiumModule.pdfium,((n,r)=>this.pdfiumModule.FPDFAnnot_GetFormFieldName(e,t,n,r)),this.pdfiumModule.pdfium.UTF16ToString);const a=L(this.pdfiumModule.pdfium,((n,r)=>this.pdfiumModule.FPDFAnnot_GetFormFieldAlternateName(e,t,n,r)),this.pdfiumModule.pdfium.UTF16ToString);const i=L(this.pdfiumModule.pdfium,((n,r)=>this.pdfiumModule.FPDFAnnot_GetFormFieldValue(e,t,n,r)),this.pdfiumModule.pdfium.UTF16ToString);const s=[];if(r===y.COMBOBOX||r===y.LISTBOX){const n=this.pdfiumModule.FPDFAnnot_GetOptionCount(e,t);for(let r=0;r<n;r++){const n=L(this.pdfiumModule.pdfium,((n,o)=>this.pdfiumModule.FPDFAnnot_GetOptionLabel(e,t,r,n,o)),this.pdfiumModule.pdfium.UTF16ToString);const o=this.pdfiumModule.FPDFAnnot_IsOptionSelected(e,t,r);s.push({label:n,isSelected:o})}}let u=false;if(r===y.CHECKBOX||r===y.RADIOBUTTON){u=this.pdfiumModule.FPDFAnnot_IsChecked(e,t)}return{flag:n,type:r,name:o,alternateName:a,value:i,isChecked:u,options:s}}renderPageAnnotation(n,r,o,a){const{scaleFactor:i=1,rotation:s=M.Degree0,dpr:u=1,mode:F=E.Normal,imageType:m="image/webp",imageQuality:l}=a??{};this.logger.debug(Q,Z,"renderPageAnnotation",n,r,o,a);this.logger.perf(Q,Z,`RenderPageAnnotation`,"Begin",`${n.id}-${r.index}-${o.id}`);const d=new R;const c=this.cache.getContext(n.id);if(!c){this.logger.perf(Q,Z,`RenderPageAnnotation`,"End",`${n.id}-${r.index}-${o.id}`);return e.reject({code:t.DocNotOpen,message:"document does not open"})}const _=c.acquirePage(r.index);const P=this.getAnnotationByName(_.pagePtr,o.id);if(!P){this.logger.perf(Q,Z,`RenderPageAnnotation`,"End",`${n.id}-${r.index}-${o.id}`);_.release();return e.reject({code:t.NotFound,message:"annotation not found"})}const g=Math.max(.01,i*u);const h=G(S(r.size,o.rect,s,g));const f=Math.max(1,h.size.width);const D=Math.max(1,h.size.height);const b=f*4;const p=b*D;const A=this.memoryManager.malloc(p);const y=this.pdfiumModule.FPDFBitmap_CreateEx(f,D,4,A,b);this.pdfiumModule.FPDFBitmap_FillRect(y,0,0,f,D,0);const C=v(o.rect,s,f,D);const T=this.memoryManager.malloc(6*4);const O=new Float32Array(this.pdfiumModule.pdfium.HEAPF32.buffer,T,6);O.set([C.a,C.b,C.c,C.d,C.e,C.f]);const x=16;let w=false;try{w=!!this.pdfiumModule.EPDF_RenderAnnotBitmap(y,_.pagePtr,P,F,T,x)}finally{this.memoryManager.free(T);this.pdfiumModule.FPDFBitmap_Destroy(y);this.pdfiumModule.FPDFPage_CloseAnnot(P);_.release()}if(!w){this.memoryManager.free(A);this.logger.perf(Q,Z,`RenderPageAnnotation`,"End",`${n.id}-${r.index}-${o.id}`);return e.reject({code:t.Unknown,message:"EPDF_RenderAnnotBitmap failed"})}const I=()=>this.memoryManager.free(A);this.imageDataConverter((()=>{const e=new Uint8ClampedArray(this.pdfiumModule.pdfium.HEAPU8.subarray(A,A+p));return{width:f,height:D,data:e}}),m,l).then((e=>d.resolve(e))).catch((e=>{if(e instanceof ee){try{const e=this.encodeViaWasm({ptr:A,width:f,height:D,stride:b},{type:m,quality:l});d.resolve(e)}catch(e){d.reject({code:t.Unknown,message:String(e)})}}else{d.reject({code:t.Unknown,message:String(e)})}})).finally(I);return d}encodeViaWasm(e,t){const n=this.pdfiumModule.pdfium;const r=(e,t,r)=>{const o=n.HEAPU8.subarray(e,e+t);const a=new Uint8Array(o);this.memoryManager.free(e);return new Blob([a],{type:r})};const o=6;const a=this.memoryManager.malloc(4);try{switch(t.type){case"image/png":default:{const t=this.pdfiumModule.EPDF_PNG_EncodeRGBA(e.ptr,e.width,e.height,e.stride,o,a);const i=n.getValue(a,"i32");return r(H(i),t,"image/png")}}}finally{this.memoryManager.free(a)}}renderRectEncoded(n,r,o,a){const i=new R;const s=(a==null?void 0:a.imageType)??"image/webp";const u=a==null?void 0:a.imageQuality;const F=(a==null?void 0:a.rotation)??M.Degree0;const m=this.cache.getContext(n.id);if(!m){return e.reject({code:t.DocNotOpen,message:"document does not open"})}const l=Math.max(.01,(a==null?void 0:a.scaleFactor)??1);const d=Math.max(1,(a==null?void 0:a.dpr)??1);const c=l*d;const _=o.size.width;const P=o.size.height;const g=(F&1)===1;const h=Math.max(1,Math.round((g?P:_)*c));const f=Math.max(1,Math.round((g?_:P)*c));const D=h*4;const b=D*f;const p=this.memoryManager.malloc(b);const A=this.pdfiumModule.FPDFBitmap_CreateEx(h,f,4,p,D);this.pdfiumModule.FPDFBitmap_FillRect(A,0,0,h,f,4294967295);const y=v(o,F,h,f);const E=this.memoryManager.malloc(6*4);const G=new Float32Array(this.pdfiumModule.pdfium.HEAPF32.buffer,E,6);G.set([y.a,y.b,y.c,y.d,y.e,y.f]);const S=this.memoryManager.malloc(4*4);const C=new Float32Array(this.pdfiumModule.pdfium.HEAPF32.buffer,S,4);C.set([0,0,h,f]);let T=2|16;if((a==null?void 0:a.withAnnotations)??false)T|=1;const O=m.acquirePage(r.index);try{this.pdfiumModule.FPDF_RenderPageBitmapWithMatrix(A,O.pagePtr,E,S,T)}finally{O.release();this.memoryManager.free(E);this.memoryManager.free(S)}const x=()=>{this.pdfiumModule.FPDFBitmap_Destroy(A);this.memoryManager.free(p)};this.imageDataConverter((()=>{const e=new Uint8ClampedArray(this.pdfiumModule.pdfium.HEAPU8.subarray(p,p+b));return{width:h,height:f,data:e}}),s,u).then((e=>i.resolve(e))).catch((e=>{this.logger.error(Q,Z,"Error",e);if(e instanceof ee){this.logger.info(Q,Z,"Fallback to WASM encoding");try{const e=this.encodeViaWasm({ptr:p,width:h,height:f,stride:D},{type:s,quality:u});i.resolve(e)}catch(e){i.reject({code:t.Unknown,message:String(e)})}}else{i.reject({code:t.Unknown,message:String(e)})}})).finally(x);return i}readPdfLinkAnnoTarget(e,t,n){const r=n();if(r){const t=this.readPdfDestination(e,r);return{type:"destination",destination:t}}else{const n=t();if(n){const t=this.readPdfAction(e,n);return{type:"action",action:t}}}}readPdfAction(e,t){const n=this.pdfiumModule.FPDFAction_GetType(t);let r;switch(n){case C.Unsupported:r={type:C.Unsupported};break;case C.Goto:{const n=this.pdfiumModule.FPDFAction_GetDest(e,t);if(n){const t=this.readPdfDestination(e,n);r={type:C.Goto,destination:t}}else{r={type:C.Unsupported}}}break;case C.RemoteGoto:{r={type:C.Unsupported}}break;case C.URI:{const n=L(this.pdfiumModule.pdfium,((n,r)=>this.pdfiumModule.FPDFAction_GetURIPath(e,t,n,r)),this.pdfiumModule.pdfium.UTF8ToString);r={type:C.URI,uri:n}}break;case C.LaunchAppOrOpenFile:{const e=L(this.pdfiumModule.pdfium,((e,n)=>this.pdfiumModule.FPDFAction_GetFilePath(t,e,n)),this.pdfiumModule.pdfium.UTF8ToString);r={type:C.LaunchAppOrOpenFile,path:e}}break}return r}readPdfDestination(e,t){const n=this.pdfiumModule.FPDFDest_GetDestPageIndex(e,t);const r=4;const o=this.memoryManager.malloc(r);const a=this.memoryManager.malloc(r*4);const i=this.pdfiumModule.FPDFDest_GetView(t,o,a);const s=this.pdfiumModule.pdfium.getValue(o,"i32");const u=[];for(let e=0;e<s;e++){const t=a+e*4;u.push(this.pdfiumModule.pdfium.getValue(t,"float"))}this.memoryManager.free(o);this.memoryManager.free(a);if(i===T.XYZ){const e=this.memoryManager.malloc(1);const r=this.memoryManager.malloc(1);const o=this.memoryManager.malloc(1);const a=this.memoryManager.malloc(4);const s=this.memoryManager.malloc(4);const F=this.memoryManager.malloc(4);const m=this.pdfiumModule.FPDFDest_GetLocationInPage(t,e,r,o,a,s,F);if(m){const t=this.pdfiumModule.pdfium.getValue(e,"i8");const m=this.pdfiumModule.pdfium.getValue(r,"i8");const l=this.pdfiumModule.pdfium.getValue(o,"i8");const d=t?this.pdfiumModule.pdfium.getValue(a,"float"):0;const c=m?this.pdfiumModule.pdfium.getValue(s,"float"):0;const _=l?this.pdfiumModule.pdfium.getValue(F,"float"):0;this.memoryManager.free(e);this.memoryManager.free(r);this.memoryManager.free(o);this.memoryManager.free(a);this.memoryManager.free(s);this.memoryManager.free(F);return{pageIndex:n,zoom:{mode:i,params:{x:d,y:c,zoom:_}},view:u}}this.memoryManager.free(e);this.memoryManager.free(r);this.memoryManager.free(o);this.memoryManager.free(a);this.memoryManager.free(s);this.memoryManager.free(F);return{pageIndex:n,zoom:{mode:i,params:{x:0,y:0,zoom:0}},view:u}}return{pageIndex:n,zoom:{mode:i},view:u}}readPdfAttachment(e,t){const n=this.pdfiumModule.FPDFDoc_GetAttachment(e,t);const r=L(this.pdfiumModule.pdfium,((e,t)=>this.pdfiumModule.FPDFAttachment_GetName(n,e,t)),this.pdfiumModule.pdfium.UTF16ToString);const o=L(this.pdfiumModule.pdfium,((e,t)=>this.pdfiumModule.FPDFAttachment_GetStringValue(n,"CreationDate",e,t)),this.pdfiumModule.pdfium.UTF16ToString);const a=L(this.pdfiumModule.pdfium,((e,t)=>this.pdfiumModule.FPDFAttachment_GetStringValue(n,"Checksum",e,t)),this.pdfiumModule.pdfium.UTF16ToString);return{index:t,name:r,creationDate:o,checksum:a}}convertDevicePointToPagePoint(e,t){const n=t.x;const r=e.size.height-t.y;return{x:n,y:r}}convertPagePointToDevicePoint(e,t){const n=t.x;const r=e.size.height-t.y;return{x:n,y:r}}convertPageRectToDeviceRect(e,t){const{x:n,y:r}=this.convertPagePointToDevicePoint(e,{x:t.left,y:t.top});const o={origin:{x:n,y:r},size:{width:Math.abs(t.right-t.left),height:Math.abs(t.top-t.bottom)}};return o}readPageAnnoAppearanceStreams(e){return{normal:this.readPageAnnoAppearanceStream(e,E.Normal),rollover:this.readPageAnnoAppearanceStream(e,E.Rollover),down:this.readPageAnnoAppearanceStream(e,E.Down)}}readPageAnnoAppearanceStream(e,t=E.Normal){const n=this.pdfiumModule.FPDFAnnot_GetAP(e,t,0,0);const r=(n+1)*2;const o=this.memoryManager.malloc(r);this.pdfiumModule.FPDFAnnot_GetAP(e,t,o,r);const a=this.pdfiumModule.pdfium.UTF16ToString(o);this.memoryManager.free(o);return a}setPageAnnoRect(e,t,n,r){const o=this.memoryManager.malloc(8);const a=this.memoryManager.malloc(8);if(!this.pdfiumModule.FPDF_DeviceToPage(t,0,0,e.size.width,e.size.height,0,r.origin.x,r.origin.y,o,a)){this.memoryManager.free(o);this.memoryManager.free(a);return false}const i=this.pdfiumModule.pdfium.getValue(o,"double");const s=this.pdfiumModule.pdfium.getValue(a,"double");this.memoryManager.free(o);this.memoryManager.free(a);const u=this.memoryManager.malloc(4*4);this.pdfiumModule.pdfium.setValue(u,i,"float");this.pdfiumModule.pdfium.setValue(u+4,s,"float");this.pdfiumModule.pdfium.setValue(u+8,i+r.size.width,"float");this.pdfiumModule.pdfium.setValue(u+12,s-r.size.height,"float");if(!this.pdfiumModule.FPDFAnnot_SetRect(n,u)){this.memoryManager.free(u);return false}this.memoryManager.free(u);return true}readPageAnnoRect(e){const t=this.memoryManager.malloc(4*4);const n={left:0,top:0,right:0,bottom:0};if(this.pdfiumModule.FPDFAnnot_GetRect(e,t)){n.left=this.pdfiumModule.pdfium.getValue(t,"float");n.top=this.pdfiumModule.pdfium.getValue(t+4,"float");n.right=this.pdfiumModule.pdfium.getValue(t+8,"float");n.bottom=this.pdfiumModule.pdfium.getValue(t+12,"float")}this.memoryManager.free(t);return n}getHighlightRects(e,t,n,r,o){const a=this.pdfiumModule.FPDFText_CountRects(n,r,o);const i=[];for(let r=0;r<a;r++){const o=this.memoryManager.malloc(8);const a=this.memoryManager.malloc(8);const s=this.memoryManager.malloc(8);const u=this.memoryManager.malloc(8);const F=this.pdfiumModule.FPDFText_GetRect(n,r,a,o,s,u);if(!F){this.memoryManager.free(a);this.memoryManager.free(o);this.memoryManager.free(s);this.memoryManager.free(u);continue}const m=this.pdfiumModule.pdfium.getValue(a,"double");const l=this.pdfiumModule.pdfium.getValue(o,"double");const d=this.pdfiumModule.pdfium.getValue(s,"double");const c=this.pdfiumModule.pdfium.getValue(u,"double");this.memoryManager.free(a);this.memoryManager.free(o);this.memoryManager.free(s);this.memoryManager.free(u);const _=this.memoryManager.malloc(4);const P=this.memoryManager.malloc(4);this.pdfiumModule.FPDF_PageToDevice(t,0,0,e.size.width,e.size.height,0,m,l,_,P);const g=this.pdfiumModule.pdfium.getValue(_,"i32");const h=this.pdfiumModule.pdfium.getValue(P,"i32");this.memoryManager.free(_);this.memoryManager.free(P);const f=Math.ceil(Math.abs(d-m));const D=Math.ceil(Math.abs(l-c));i.push({origin:{x:g,y:h},size:{width:f,height:D}})}return i}searchAllPages(n,r,o){var a;this.logger.debug(Q,Z,"searchAllPages",n,r,o);this.logger.perf(Q,Z,"SearchAllPages","Begin",n.id);const i=this.cache.getContext(n.id);if(!i){this.logger.perf(Q,Z,"SearchAllPages","End",n.id);return e.resolve({results:[],total:0})}const s=2*(r.length+1);const u=this.memoryManager.malloc(s);this.pdfiumModule.pdfium.stringToUTF16(r,u,s);const F=((a=o==null?void 0:o.flags)==null?void 0:a.reduce(((e,t)=>e|t),O.None))??O.None;const m=e.create();let l=false;m.wait((()=>{}),(e=>{if(e.type==="abort")l=true}));const d=100;const c=[];const _=e=>{if(l)return;const r=Math.min(e+d,n.pageCount);try{for(let t=e;t<r&&!l;t++){const e=this.searchAllInPage(i,n.pages[t],u,F);c.push(...e);m.progress({page:t,results:e})}}catch(e){if(!l){this.memoryManager.free(u);this.logger.perf(Q,Z,"SearchAllPages","End",n.id);m.reject({code:t.Unknown,message:`Error searching document: ${e}`})}return}if(l)return;if(r>=n.pageCount){this.memoryManager.free(u);this.logger.perf(Q,Z,"SearchAllPages","End",n.id);m.resolve({results:c,total:c.length});return}setTimeout((()=>_(r)),0)};setTimeout((()=>_(0)),0);m.wait((()=>{}),(e=>{if(e.type==="abort"){try{this.memoryManager.free(u)}catch{}}}));return m}buildContext(e,t,n,r=30){const o=/[\s\u00A0.,;:!?()\[\]{}<>/\\\-"'`"”\u2013\u2014]/;const a=t=>{while(t>0&&!o.test(e[t-1]))t--;return t};const i=t=>{while(t<e.length&&!o.test(e[t]))t++;return t};let s=t;while(s>0&&o.test(e[s-1]))s--;let u=0;while(s>0&&u<r){s--;if(!o.test(e[s]))u++}s=a(s);let F=t+n;while(F<e.length&&o.test(e[F]))F++;u=0;while(F<e.length&&u<r){if(!o.test(e[F]))u++;F++}F=i(F);const m=e.slice(s,t).replace(/\s+/g," ").trimStart();const l=e.slice(t,t+n);const d=e.slice(t+n,F).replace(/\s+/g," ").trimEnd();return{before:this.tidy(m),match:this.tidy(l),after:this.tidy(d),truncatedLeft:s>0,truncatedRight:F<e.length}}tidy(e){return e.replace(/-\uFFFE\s*/g,"").replace(/[\uFFFE\u00AD\u200B\u2060\uFEFF]/g,"").replace(/\s+/g," ")}searchAllInPage(e,t,n,r){return e.borrowPage(t.index,(e=>{const o=e.getTextPage();const a=this.pdfiumModule.FPDFText_CountChars(o);const i=this.memoryManager.malloc(2*(a+1));this.pdfiumModule.FPDFText_GetText(o,0,a,i);const s=this.pdfiumModule.pdfium.UTF16ToString(i);this.memoryManager.free(i);const u=[];const F=this.pdfiumModule.FPDFText_FindStart(o,n,r,0);while(this.pdfiumModule.FPDFText_FindNext(F)){const n=this.pdfiumModule.FPDFText_GetSchResultIndex(F);const r=this.pdfiumModule.FPDFText_GetSchCount(F);const a=this.getHighlightRects(t,e.pagePtr,o,n,r);const i=this.buildContext(s,n,r);u.push({pageIndex:t.index,charIndex:n,charCount:r,rects:a,context:i})}this.pdfiumModule.FPDFText_FindClose(F);return u}))}preparePrintDocument(n,r){const{includeAnnotations:o=true,pageRange:a=null}=r??{};this.logger.debug(Q,Z,"preparePrintDocument",n,r);this.logger.perf(Q,Z,`PreparePrintDocument`,"Begin",n.id);const i=this.cache.getContext(n.id);if(!i){this.logger.perf(Q,Z,`PreparePrintDocument`,"End",n.id);return e.reject({code:t.DocNotOpen,message:"Document is not open"})}const s=this.pdfiumModule.FPDF_CreateNewDocument();if(!s){this.logger.perf(Q,Z,`PreparePrintDocument`,"End",n.id);return e.reject({code:t.CantCreateNewDoc,message:"Cannot create print document"})}try{const r=this.sanitizePageRange(a,n.pageCount);if(!this.pdfiumModule.FPDF_ImportPages(s,i.docPtr,r??"",0)){this.pdfiumModule.FPDF_CloseDocument(s);this.logger.error(Q,Z,"Failed to import pages for printing");this.logger.perf(Q,Z,`PreparePrintDocument`,"End",n.id);return e.reject({code:t.CantImportPages,message:"Failed to import pages for printing"})}if(!o){const r=this.removeAnnotationsFromPrintDocument(s);if(!r.success){this.pdfiumModule.FPDF_CloseDocument(s);this.logger.error(Q,Z,`Failed to remove annotations: ${r.error}`);this.logger.perf(Q,Z,`PreparePrintDocument`,"End",n.id);return e.reject({code:t.Unknown,message:`Failed to prepare print document: ${r.error}`})}this.logger.debug(Q,Z,`Removed ${r.annotationsRemoved} annotations from ${r.pagesProcessed} pages`)}const u=this.saveDocument(s);this.pdfiumModule.FPDF_CloseDocument(s);this.logger.perf(Q,Z,`PreparePrintDocument`,"End",n.id);return e.resolve(u)}catch(r){if(s){this.pdfiumModule.FPDF_CloseDocument(s)}this.logger.error(Q,Z,"preparePrintDocument failed",r);this.logger.perf(Q,Z,`PreparePrintDocument`,"End",n.id);return e.reject({code:t.Unknown,message:r instanceof Error?r.message:"Failed to prepare print document"})}}removeAnnotationsFromPrintDocument(e){let t=0;let n=0;try{const r=this.pdfiumModule.FPDF_GetPageCount(e);for(let o=0;o<r;o++){const r=this.pdfiumModule.EPDFPage_GetAnnotCountRaw(e,o);if(r<=0){n++;continue}let a=0;for(let n=r-1;n>=0;n--){const r=this.pdfiumModule.EPDFPage_RemoveAnnotRaw(e,o,n);if(r){a++;t++}else{this.logger.warn(Q,Z,`Failed to remove annotation ${n} from page ${o}`)}}if(a>0){const t=this.pdfiumModule.FPDF_LoadPage(e,o);if(t){this.pdfiumModule.FPDFPage_GenerateContent(t);this.pdfiumModule.FPDF_ClosePage(t)}}n++}return{success:true,annotationsRemoved:t,pagesProcessed:n}}catch(e){return{success:false,annotationsRemoved:t,pagesProcessed:n,error:e instanceof Error?e.message:"Unknown error during annotation removal"}}}sanitizePageRange(e,t){if(!e||e.trim()===""){return null}try{const n=[];const r=e.split(",");for(const e of r){const r=e.trim();if(r.includes("-")){const[e,o]=r.split("-").map((e=>e.trim()));const a=parseInt(e,10);const i=parseInt(o,10);if(isNaN(a)||isNaN(i)){this.logger.warn(Q,Z,`Invalid range: ${r}`);continue}const s=Math.max(1,Math.min(a,t));const u=Math.max(1,Math.min(i,t));for(let e=s;e<=u;e++){if(!n.includes(e)){n.push(e)}}}else{const e=parseInt(r,10);if(isNaN(e)){this.logger.warn(Q,Z,`Invalid page number: ${r}`);continue}const o=Math.max(1,Math.min(e,t));if(!n.includes(o)){n.push(o)}}}if(n.length===0){this.logger.warn(Q,Z,"No valid pages in range, using all pages");return null}n.sort(((e,t)=>e-t));const o=[];let a=n[0];let i=n[0];for(let e=1;e<n.length;e++){if(n[e]===i+1){i=n[e]}else{if(a===i){o.push(a.toString())}else if(i-a===1){o.push(a.toString());o.push(i.toString())}else{o.push(`${a}-${i}`)}a=n[e];i=n[e]}}if(a===i){o.push(a.toString())}else if(i-a===1){o.push(a.toString());o.push(i.toString())}else{o.push(`${a}-${i}`)}const s=o.join(",");this.logger.debug(Q,Z,`Sanitized page range: "${e}" -> "${s}"`);return s}catch(e){this.logger.error(Q,Z,`Error sanitizing page range: ${e}`);return null}}}async function re(e,t){const n=await fetch(e);const r=await n.arrayBuffer();const o=await B({wasmBinary:r});return new ne(o,{logger:t})}export{re as createPdfiumEngine};
